webpackHotUpdate(1,{

/***/ 2674:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* WEBPACK VAR INJECTION */(function(global) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Visor; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__reducers_serializer__ = __webpack_require__(301);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react_dom__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_react_bootstrap__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__components_canvas_VisorCanvas__ = __webpack_require__(1084);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__components_canvas_VisorContainedCanvas__ = __webpack_require__(1088);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__components_navigation_VisorSideNav__ = __webpack_require__(2675);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__components_navigation_VisorPlayer__ = __webpack_require__(2678);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__common_utils__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__components_score_GradeComponent__ = __webpack_require__(2684);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__locales_i18n__ = __webpack_require__(1061);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_typeface_ubuntu__ = __webpack_require__(2688);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_typeface_ubuntu___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_11_typeface_ubuntu__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_typeface_source_sans_pro__ = __webpack_require__(2705);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_typeface_source_sans_pro___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_12_typeface_source_sans_pro__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__trendmicro_react_toggle_switch_dist_react_toggle_switch_css__ = __webpack_require__(585);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__trendmicro_react_toggle_switch_dist_react_toggle_switch_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_13__trendmicro_react_toggle_switch_dist_react_toggle_switch_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__sass_style_scss__ = __webpack_require__(1157);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__sass_style_scss___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_14__sass_style_scss__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__core_visor_visorEntrypoint__ = __webpack_require__(2730);\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nif (global && !global._babelPolyfill) {\n  __webpack_require__(2734);\n}\n\n__webpack_require__(2053).polyfill();\n/**\n * Visor app main component\n */\n\n\nvar Visor =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Visor, _Component);\n\n  function Visor(props) {\n    var _this;\n\n    _classCallCheck(this, Visor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Visor).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"setHoverClass\", function () {\n      _this.setState({\n        mouseOnPlayer: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteHoverClass\", function () {\n      _this.setState({\n        mouseOnPlayer: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_onMouseMove\", function () {\n      if (!_this.state.mouseMoving) {\n        _this.setState({\n          mouseMoving: true\n        });\n      } else {\n        if (_this.timer) {\n          clearTimeout(_this.timer);\n        }\n\n        _this.timer = setTimeout(function () {\n          _this.setState({\n            mouseMoving: false\n          });\n        }, 2500);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onMarkClicked\", function (id, value, stateElement) {\n      var richElementsState = _this.state.richElementState;\n\n      var marks = _this.getAllMarks();\n\n      var triggered_event = {\n        id: id,\n        value: value,\n        stateElement: stateElement\n      };\n\n      var triggered_marks = _this.getTriggeredMarks(marks, triggered_event); // clearMark | If actual Triggered Mark have passed e.detail.value and actual value is different or actual element doesn't need to clear the value\n\n\n      triggered_marks = _this.clearTriggeredValues(triggered_event, triggered_marks); // Just try to trigger if mark exists\n\n      if (_this.containsMarkValue(marks, triggered_event.value)) {\n        // And is triggereable (not pending)\n        var isTriggerable = _this.isTriggereableMark(triggered_event, triggered_marks);\n\n        if (isTriggerable) {\n          triggered_marks = _this.putMarksOnHold(triggered_marks, triggered_event); // If mark is storable (if make any sense to store to render something different like a video) do it, else don't\n\n          if (triggered_event.stateElement) {\n            if (_this.isNotInStateElement(triggered_event, _this.state.richElementState)) {\n              var new_mark = {};\n              new_mark[triggered_event.id] = triggered_event.value;\n\n              _this.setState({\n                triggeredMarks: triggered_marks,\n                richElementState: Object.assign({}, richElementsState, new_mark)\n              });\n            }\n          } else {\n            triggered_marks.forEach(function (mark, index) {\n              if (mark.id === isTriggerable.id) {\n                triggered_marks[index] = isTriggerable;\n              }\n            });\n\n            _this.setState({\n              triggeredMarks: triggered_marks\n            });\n          }\n        }\n      } else if (triggered_event.stateElement) {\n        var backupElementStates = _this.state.backupElementStates;\n        var _new_mark = {};\n        _new_mark[triggered_event.id] = triggered_event.value;\n\n        _this.setState({\n          backupElementStates: Object.assign({}, backupElementStates, _new_mark)\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"removeLastView\", function () {\n      var newViews = _this.state.currentView.slice(0, -1);\n\n      if (newViews.length > 0) {\n        var lastView = newViews[newViews.length - 1];\n\n        if (lastView.indexOf(\"cv-\") === -1) {\n          _this.setState({\n            containedViewSelected: 0\n          });\n        }\n      }\n\n      _this.setState({\n        currentView: newViews,\n        triggeredMarks: _this.unTriggerLastMark(_this.state.triggeredMarks),\n        richElementState: _this.getActualBoxesStates(_this.state.backupElementStates, _this.state.richElementState)\n      });\n    });\n\n    var initialView = _this.getCurrentView(Ediphy.State.navItemSelected, Ediphy.State.containedViewSelected);\n\n    if (!Ediphy.State.preview) {\n      var remainingViews = Ediphy.State.navItemsIds.filter(function (n) {\n        var nav = Ediphy.State.navItemsById[n];\n        var returnIt = Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"J\" /* isSection */])(nav.id) ? Ediphy.Config.sections_have_content : true;\n        returnIt = returnIt && !nav.hidden;\n        return returnIt ? nav.id : null;\n      });\n\n      if (remainingViews.length > 0) {\n        initialView = remainingViews[0];\n      }\n    }\n\n    _this.timer = false;\n    _this.state = {\n      currentView: [initialView],\n\n      /* This is the actual view rendering*/\n      triggeredMarks: [],\n      showpop: false,\n      richElementState: {},\n      backupElementStates: {},\n      toggledSidebar: false,\n      // Ediphy.State.globalConfig.visorNav.sidebar ? Ediphy.State.globalConfig.visorNav.sidebar : (Ediphy.State.globalConfig.visorNav.sidebar === undefined),\n      fromScorm: Ediphy.State.fromScorm,\n      scoreInfo: {\n        userName: \"Anonymous\",\n        totalScore: 0,\n        totalWeight: 0,\n        completionProgress: 0\n      },\n      mouseMoving: false,\n      mouseOnPlayer: false,\n      backwards: false\n    };\n\n    if (!Ediphy.State[\"export\"]) {\n      window[\"export\"] = function () {\n        var format = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'HTML';\n\n        switch (format) {\n          case 'SCORM12':\n            _this.exportToScorm(false, function () {\n              return true;\n            }, false);\n\n            return true;\n\n          case 'SCORM2004':\n            _this.exportToScorm(true, function () {\n              return true;\n            }, false);\n\n            return true;\n\n          case 'HTML':\n            _this.exportToScorm('HTML', function () {\n              return true;\n            }, false);\n\n            return true;\n\n          default:\n            return false;\n        }\n      };\n    }\n\n    fetch(Ediphy.Config.theme_css_url) // Webpack output CSS\n    .then(function (res) {\n      if (!res.ok) {\n        throw new Error('Error');\n      }\n\n      return res.text();\n    }).then(function (data) {\n      window.theme_css = data;\n    })[\"catch\"](function () {\n      return '';\n    });\n    return _this;\n  }\n\n  _createClass(Visor, [{\n    key: \"UNSAFE_componentWillUpdate\",\n    value: function UNSAFE_componentWillUpdate(nextProps, nextState) {\n      var _this2 = this;\n\n      // reset marks when navigating between main sections\n      if (this.state.currentView.length !== nextState.currentView.length && Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"P\" /* isView */])(nextState.currentView[nextState.currentView.length - 1])) {\n        this.setState({\n          triggeredMarks: []\n        });\n      }\n\n      if (this.state.currentView.length > 1 && this.state.currentView.filter(function (i) {\n        return i.indexOf(\"pa-\") !== -1;\n      }).length > 1) {\n        this.setState({\n          currentView: [this.state.currentView[this.state.currentView.length - 1]]\n        });\n      } // Mark triggering mechanism\n\n\n      if (nextState.triggeredMarks.length !== 0 && this.returnTriggereableMark(nextState.triggeredMarks)) {\n        var newMark = this.returnTriggereableMark(nextState.triggeredMarks);\n        nextState.triggeredMarks.forEach(function (mark) {\n          if (newMark.id === mark.id) {\n            mark.currentState = 'TRIGGERED';\n            mark.viewOrigin = _this2.state.currentView[_this2.state.currentView.length - 1];\n          }\n\n          return mark;\n        }); // New or existing mark\n\n        if (newMark.connectMode === 'new' || newMark.connectMode === \"existing\") {\n          var array_trigger_mark = this.santinizeViewsArray(nextState.triggeredMarks, nextState.currentView.concat([newMark.connection]));\n          var newcv = array_trigger_mark.length > 0 && array_trigger_mark[array_trigger_mark.length - 1] && Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(array_trigger_mark[array_trigger_mark.length - 1]) ? array_trigger_mark[array_trigger_mark.length - 1] : 0;\n          this.setState({\n            containedViewSelected: newcv,\n            currentView: array_trigger_mark,\n            triggeredMarks: nextState.triggeredMarks\n          }); // External target\n        } else if (newMark.connectMode === \"external\") {\n          var win = window.open(newMark.connection, '_blank');\n          win.focus();\n          var shiftExternal = nextState.triggeredMarks;\n          shiftExternal.shift();\n          this.setState({\n            triggeredMarks: shiftExternal\n          });\n        } else if (newMark.connectMode === \"popup\") {\n          var shiftPop = nextState.triggeredMarks;\n          shiftPop.shift();\n          var markpop = document.getElementById('mark-' + newMark.id);\n\n          if (markpop) {\n            markpop.click();\n          }\n\n          this.setState({\n            showpop: !this.state.showpop,\n            triggeredMarks: shiftPop\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      /*\n      * Add Key bindings to app\n      * */\n      if (Ediphy.State.globalConfig.visorNav.keyBindings) {\n        // First get window focus so arrows work right away\n        window.focus();\n\n        window.onkeyup = function (e) {\n          var key = e.keyCode ? e.keyCode : e.which;\n          var navItemsIds = Ediphy.State.navItemsIds;\n          var navItems = Ediphy.State.navItemsById;\n\n          if (!Ediphy.Config.sections_have_content) {\n            navItemsIds = navItemsIds.filter(function (element) {\n              return element.indexOf(\"se\") === -1;\n            });\n          }\n\n          navItemsIds = navItemsIds.filter(function (nav) {\n            return !navItems[nav].hidden;\n          });\n          var navItemSelected = this.state.currentView.reduce(function (element) {\n            if (Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"I\" /* isPage */])(element)) {\n              return element;\n            }\n\n            return null;\n          });\n          var index = navItemsIds.indexOf(navItemSelected);\n          var maxIndex = navItemsIds.length;\n          var focusElement = document.activeElement.tagName.toLowerCase();\n\n          if (focusElement !== 'input' && focusElement !== 'textarea') {\n            if (key === 37 || key === 33) {\n              this.changeCurrentView(navItemsIds[Math.max(index - 1, 0)], true);\n            } else if (key === 39 || key === 34) {\n              this.changeCurrentView(navItemsIds[Math.min(index + 1, maxIndex - 1)]);\n            }\n          }\n        }.bind(this);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (window.State) {\n        Ediphy.State = Object(__WEBPACK_IMPORTED_MODULE_0__reducers_serializer__[\"c\" /* serialize */])({\n          \"present\": _objectSpread({}, window.State)\n        }).present;\n      }\n\n      var _Ediphy$State = Ediphy.State,\n          navItemsIds = _Ediphy$State.navItemsIds,\n          globalConfig = _Ediphy$State.globalConfig,\n          styleConfig = _Ediphy$State.styleConfig,\n          containedViewsById = _Ediphy$State.containedViewsById,\n          boxesById = _Ediphy$State.boxesById,\n          marksById = _Ediphy$State.marksById,\n          navItemsById = _Ediphy$State.navItemsById,\n          viewToolbarsById = _Ediphy$State.viewToolbarsById,\n          pluginToolbarsById = _Ediphy$State.pluginToolbarsById;\n      var ediphy_document_id = Ediphy.State.id;\n      var ediphy_platform = Ediphy.State.platform;\n      var exercises = {};\n      Object.keys(Ediphy.State.exercises).map(function (exercise) {\n        if (containedViewsById[exercise] || navItemsById[exercise] && !navItemsById[exercise].hidden) {\n          exercises[exercise] = Ediphy.State.exercises[exercise];\n        }\n      });\n      var title = globalConfig.title;\n      var ratio = globalConfig.canvasRatio;\n      var visorNav = globalConfig.visorNav;\n      var wrapperClasses = this.state.toggledSidebar ? \"visorwrapper toggled\" : \"visorwrapper\";\n      var toggleIcon = this.state.toggledSidebar ? \"keyboard_arrow_left\" : \"keyboard_arrow_right\";\n      var toggleColor = this.state.toggledSidebar ? \"toggleColor\" : \"\";\n      var isCV = Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(this.state.currentView);\n      var isSlide = isCV && containedViewsById[this.getLastCurrentViewElement()] === \"slide\" || !isCV && navItemsById[this.getLastCurrentViewElement()] === \"slide\" ? \"pcw_slide\" : \"pcw_doc\";\n      var vishPlayer = globalConfig.visorNav && globalConfig.visorNav.fixedPlayer !== undefined ? globalConfig.visorNav.fixedPlayer : true;\n      var currentView = this.getLastCurrentViewElement();\n      var canvasProps = {\n        boxes: boxesById,\n        changeCurrentView: function changeCurrentView(element) {\n          _this3.changeCurrentView(element);\n        },\n        canvasRatio: ratio,\n        containedViews: containedViewsById,\n        currentView: currentView,\n        fromScorm: this.state.fromScorm,\n        navItems: navItemsById,\n        navItemsIds: navItemsIds,\n        removeLastView: this.removeLastView,\n        richElementsState: this.state.richElementState,\n        title: title,\n        marks: marksById,\n        viewToolbars: viewToolbarsById,\n        pluginToolbars: pluginToolbarsById,\n        onMarkClicked: this.onMarkClicked,\n        triggeredMarks: this.state.triggeredMarks,\n        viewsArray: this.state.currentView,\n        exportModalOpen: false,\n        ediphy_document_id: ediphy_document_id,\n        ediphy_platform: ediphy_platform,\n        exercises: exercises,\n        styleConfig: styleConfig || {}\n      };\n      var navItemComponents = Object.keys(navItemsById).filter(function (nav) {\n        return Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"I\" /* isPage */])(nav);\n      }).map(function (nav, i) {\n        return __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_4__components_canvas_VisorCanvas__[\"a\" /* default */], _extends({\n          key: i\n        }, canvasProps, {\n          selectedView: currentView,\n          backwards: _this3.state.backwards,\n          currentView: nav,\n          show: nav === currentView,\n          z: i + 10,\n          showCanvas: nav.indexOf(\"cv-\") === -1\n        }));\n      });\n      var cvComponents = Object.keys(containedViewsById).map(function (nav, i) {\n        return __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5__components_canvas_VisorContainedCanvas__[\"a\" /* default */], _extends({\n          key: i\n        }, canvasProps, {\n          currentView: nav,\n          show: nav === currentView,\n          z: i + navItemComponents.length,\n          showCanvas: nav.indexOf(\"cv-\") !== -1\n        }));\n      });\n      var content = [].concat(_toConsumableArray(navItemComponents), [cvComponents]);\n      var empty = __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        className: \"emptyPresentation\"\n      }, __WEBPACK_IMPORTED_MODULE_10__locales_i18n__[\"a\" /* default */].t(\"EmptyPresentation\"));\n      var visorNavButtonClass = 'hoverPlayerSelector';\n      visorNavButtonClass = this.state.mouseMoving ? visorNavButtonClass + ' appearButton' : visorNavButtonClass + ' fadeButton';\n      visorNavButtonClass = this.state.mouseOnPlayer ? visorNavButtonClass + ' hoverPlayerOn' : visorNavButtonClass;\n      return __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        id: \"app\",\n        ref: 'app',\n        className: wrapperClasses,\n        onMouseMove: this._onMouseMove\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_6__components_navigation_VisorSideNav__[\"a\" /* default */], {\n        changeCurrentView: function changeCurrentView(page) {\n          _this3.changeCurrentView(page);\n        },\n        courseTitle: title,\n        show: visorNav.sidebar,\n        showScore: !globalConfig.hideGlobalScore,\n        currentViews: this.state.currentView,\n        navItemsById: navItemsById,\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        }),\n        viewToolbars: viewToolbarsById,\n        scoreInfo: this.state.scoreInfo,\n        exercises: exercises,\n        toggled: this.state.toggledSidebar\n      }), __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        id: \"page-content-wrapper\",\n        className: isSlide + \" page-content-wrapper\",\n        style: {\n          height: '100%'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"l\" /* Grid */], {\n        fluid: true,\n        id: \"visorAppContent\",\n        style: {\n          height: '100%'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"y\" /* Row */], {\n        style: {\n          height: vishPlayer ? 'calc(100% - 38px)' : '100%'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"e\" /* Col */], {\n        lg: 12,\n        style: {\n          height: '100%',\n          paddingLeft: '0px',\n          paddingRight: '0px'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_9__components_score_GradeComponent__[\"a\" /* default */], {\n        fadePlayerClass: visorNavButtonClass,\n        setHover: this.setHoverClass,\n        deleteHover: this.deleteHoverClass,\n        updateScore: function updateScore(scoreInfo) {\n          _this3.setState({\n            scoreInfo: scoreInfo\n          });\n        },\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        }),\n        containedViews: containedViewsById,\n        currentView: currentView,\n        navItemsById: navItemsById,\n        globalConfig: globalConfig,\n        styleConfig: styleConfig,\n        exercises: exercises,\n        pluginToolbars: pluginToolbarsById,\n        fromScorm: this.state.fromScorm,\n        changeCurrentView: function changeCurrentView(el) {\n          _this3.changeCurrentView(el);\n        }\n      }, currentView ? content : empty), !vishPlayer ? __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7__components_navigation_VisorPlayer__[\"a\" /* default */], {\n        fadePlayerClass: visorNavButtonClass,\n        setHover: this.setHoverClass,\n        deleteHover: this.deleteHoverClass,\n        show: visorNav.player,\n        changeCurrentView: function changeCurrentView(page, backwards) {\n          _this3.changeCurrentView(page, backwards);\n        },\n        currentViews: this.state.currentView,\n        navItemsById: navItemsById,\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        })\n      }) : null, visorNav.sidebar ? __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        className: \"visorNavButtonDiv\",\n        onMouseEnter: function onMouseEnter() {\n          return _this3.setHoverClass();\n        },\n        onMouseLeave: function onMouseLeave() {\n          return _this3.deleteHoverClass();\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"c\" /* Button */], {\n        id: \"visorNavButton\",\n        className: toggleColor + visorNavButtonClass,\n        bsStyle: \"primary\",\n        onClick: function onClick() {\n          _this3.setState({\n            toggledSidebar: !_this3.state.toggledSidebar\n          });\n\n          document.activeElement.blur();\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"i\", {\n        className: \"material-icons\"\n      }, toggleIcon))) : null)), __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"y\" /* Row */], {\n        style: {\n          height: '38px',\n          display: vishPlayer ? 'block' : 'none'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"e\" /* Col */], {\n        lg: 12,\n        style: {\n          height: '100%',\n          paddingLeft: '0px',\n          paddingRight: '0px'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7__components_navigation_VisorPlayer__[\"a\" /* default */], {\n        fadePlayerClass: \"appearButton\",\n        setHover: this.setHoverClass,\n        deleteHover: this.deleteHoverClass,\n        show: visorNav.player,\n        changeCurrentView: function changeCurrentView(page, backwards) {\n          _this3.changeCurrentView(page, backwards);\n        },\n        currentViews: this.state.currentView,\n        navItemsById: navItemsById,\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        })\n      }))))));\n    }\n    /**\n     * Export to HTML or PDF\n     * @param format\n     * @param callback\n     * @param options\n     */\n\n  }, {\n    key: \"export\",\n    value: function _export(format, callback) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (format === \"PDF\") {\n        printToPDF(Ediphy.State, callback, options);\n      } else {\n        Ediphy.Visor.exportsHTML(Ediphy.State, callback, options);\n      }\n    }\n  }, {\n    key: \"exportToScorm\",\n    value: function exportToScorm(is2004, callback) {\n      var selfContained = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      Ediphy.Visor.exportScorm(Ediphy.State, is2004, callback, selfContained);\n    }\n    /**\n     * Get actualView REFACTOR: change name\n     * @returns {String} currentView\n     */\n\n  }, {\n    key: \"getLastCurrentViewElement\",\n    value: function getLastCurrentViewElement() {\n      return this.state.currentView[this.state.currentView.length - 1];\n    }\n    /**\n     * Navigation main method\n     * @param {string} element - current Element to go\n     */\n\n  }, {\n    key: \"changeCurrentView\",\n    value: function changeCurrentView(element) {\n      var backwards = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(element)) {\n        this.setState({\n          currentView: [this.getCurrentView(this.state.navItemSelected, this.state.containedViewSelected), element],\n          backwards: backwards\n        });\n      } else {\n        this.setState({\n          currentView: [element],\n          backwards: backwards\n        });\n\n        if (this.state.currentView.length > 1) {\n          this.setState({\n            triggeredMarks: this.unTriggerLastMark(this.state.triggeredMarks),\n            richElementState: this.getActualBoxesStates(this.state.backupElementStates, this.state.richElementState),\n            backwards: backwards\n          });\n        }\n      }\n    }\n    /**\n     * This is used to get initial view and make sure is either containedView or NavItem\n     * @param NIselected\n     * @param CVselected\n     */\n\n  }, {\n    key: \"getCurrentView\",\n    value: function getCurrentView(NIselected, CVselected) {\n      var navItemSelected = 0;\n\n      if (Ediphy.State.navItemsById[NIselected] && !Ediphy.State.navItemsById[NIselected].hidden) {\n        navItemSelected = NIselected;\n      }\n\n      return CVselected === 0 ? navItemSelected : CVselected;\n    }\n    /* Marks functions*/\n\n    /**\n     * Make sure if mark value exists\n     * @return {boolean} -  whether the mark exists or not in the array\n     * @param marks\n     * @param mark_value\n     */\n\n  }, {\n    key: \"containsMarkValue\",\n    value: function containsMarkValue(marks, mark_value) {\n      var exists = false;\n      marks.forEach(function (mark_element) {\n        if (mark_element.value === mark_value) {\n          exists = true;\n        }\n      });\n      return exists;\n    }\n  }, {\n    key: \"returnTriggereableMark\",\n\n    /**\n     * Returns if any is there any triggerable mark\n     * @param triggeredMarks\n     * @returns Object Marks that are triggered\n     */\n    value: function returnTriggereableMark(triggeredMarks) {\n      var isAnyTriggereableMark = false;\n      var canBeTriggered = true;\n\n      if (Array.isArray(triggeredMarks)) {\n        triggeredMarks.forEach(function (mark) {\n          if (mark.currentState === 'TRIGGERED') {\n            canBeTriggered = false;\n          }\n\n          if (canBeTriggered && mark.currentState === 'PENDING' && !isAnyTriggereableMark) {\n            isAnyTriggereableMark = mark;\n          }\n        });\n      }\n\n      return isAnyTriggereableMark;\n    }\n    /**\n     * Whether if the mark is triggereable or not\n     * @param mark\n     * @param triggerable_marks\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"isTriggereableMark\",\n    value: function isTriggereableMark(mark, triggerable_marks) {\n      var isAnyTriggereableMark = false;\n      triggerable_marks.forEach(function (triggereable_mark) {\n        if (triggereable_mark.currentState === 'PENDING' && triggereable_mark.value === mark.value && triggereable_mark.origin === mark.id) {\n          if (!isAnyTriggereableMark) {\n            isAnyTriggereableMark = triggereable_mark;\n          }\n        }\n\n        if (!mark.stateElement && triggereable_mark.value === mark.value && triggereable_mark.origin === mark.id) {\n          if (!isAnyTriggereableMark) {\n            isAnyTriggereableMark = triggereable_mark;\n            isAnyTriggereableMark.currentState = \"PENDING\";\n          }\n        }\n      });\n      return isAnyTriggereableMark;\n    }\n    /**\n     * Change state of last mark triggered to done, this is used to go back\n     * @param state\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"unTriggerLastMark\",\n    value: function unTriggerLastMark(state) {\n      var new_array = state;\n      new_array.forEach(function (mark) {\n        if (mark.currentState === 'TRIGGERED') {\n          mark.currentState = 'DONE';\n        }\n      });\n      return new_array;\n    }\n    /**\n     * Cleans Views Array\n     * @param triggeredMarks\n     * @param arrayViews\n     * @returns {*}\n     */\n\n  }, {\n    key: \"santinizeViewsArray\",\n    value: function santinizeViewsArray(triggeredMarks, arrayViews) {\n      var final_array = arrayViews;\n      triggeredMarks.forEach(function (mark) {\n        if (mark.currentState === \"DONE\" && final_array.indexOf(mark.connection) !== -1) {\n          final_array.splice(final_array.indexOf(mark.connection), 1);\n        }\n      });\n      final_array = final_array.reverse().filter(function (v, i, a) {\n        return a.indexOf(v) === i || v.indexOf(\"pa-\") === -1;\n      }).reverse();\n      return final_array;\n    }\n    /**\n     * Cleans used 'DONE' values in triggeredMarks array\n     * @param triggered_event\n     * @param triggeredMarks\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"clearTriggeredValues\",\n    value: function clearTriggeredValues(triggered_event, triggeredMarks) {\n      var clean_array = [];\n\n      if (triggeredMarks.length > 0) {\n        if (!triggered_event.stateElement) {\n          triggeredMarks.forEach(function (element) {\n            if (element.currentState !== 'DONE' || triggered_event.id !== element.origin) {\n              clean_array.push(element);\n            }\n          });\n        } else {\n          triggeredMarks.forEach(function (element) {\n            if (element.currentState !== \"DONE\" || element.value === triggered_event.value || element.origin !== triggered_event.id) {\n              clean_array.push(element);\n            }\n          });\n        }\n      }\n\n      return clean_array;\n    }\n    /**\n     * Provisional Method TODO: Verify if needed\n     * @param triggered_event\n     * @param richStateselement\n     */\n    // clearStateElements(triggered_event, richStateselement) {\n    //     if(richStateselement[triggered_event.id] !== undefined && parseFloat(triggered_event.value) > parseFloat(richStateselement[triggered_event.id]) + 1) {\n    //         let newElementState = JSON.parse(JSON.stringify(richStateselement));\n    //         newElementState[triggered_event.id] = undefined;\n    //         return newElementState;\n    //     }\n    //\n    //     return richStateselement;\n    // }\n\n    /**\n     * Get all marks triggered in the same event\n     * @param marks\n     * @param triggered_event\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getTriggeredMarks\",\n    value: function getTriggeredMarks(marks, triggered_event) {\n      var _this4 = this;\n\n      var state_marks = [];\n      var previously_triggered_marks = this.state.triggeredMarks;\n\n      if (previously_triggered_marks.length === 0) {\n        marks.forEach(function (mark_element) {\n          if (mark_element.value === triggered_event.value && mark_element.origin === triggered_event.id) {\n            state_marks.push({\n              currentState: \"PENDING\",\n              viewOrigin: _this4.state.currentView[_this4.state.currentView.length - 1],\n              id: mark_element.id,\n              value: mark_element.value,\n              connection: mark_element.connection,\n              origin: mark_element.origin,\n              connectMode: mark_element.connectMode\n            });\n          }\n        });\n      } else {\n        // return only triggered MARKS\n        state_marks = state_marks.concat(previously_triggered_marks);\n        marks.forEach(function (triggered_mark) {\n          var is_different = true;\n\n          for (var n in state_marks) {\n            if (state_marks[n].value === triggered_mark.value && state_marks[n].origin === triggered_event.id) {\n              is_different = false;\n            }\n          }\n\n          if (is_different && triggered_event.value === triggered_mark.value && triggered_event.id === triggered_mark.origin) {\n            state_marks.push({\n              currentState: \"PENDING\",\n              viewOrigin: _this4.state.currentView[_this4.state.currentView.length - 1],\n              id: triggered_mark.id,\n              value: triggered_mark.value,\n              connection: triggered_mark.connection,\n              origin: triggered_mark.origin,\n              connectMode: triggered_mark.connectMode\n            });\n          }\n        });\n      }\n\n      return state_marks;\n    }\n    /**\n     * Get all Mark of currentView\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getAllMarks\",\n    value: function getAllMarks() {\n      var currentView = this.state.currentView[this.state.currentView.length - 1];\n      var boxes = this.getAllRichDescendantBoxes(currentView);\n      var marks = [];\n      Object.keys(Ediphy.State.marksById).forEach(function (mark) {\n        boxes.includes(Ediphy.State.marksById[mark].origin);\n        marks.push(Ediphy.State.marksById[mark]);\n      });\n      return marks;\n    }\n  }, {\n    key: \"putMarksOnHold\",\n    value: function putMarksOnHold(triggered_marks) {\n      var anyTriggeredMarks = false;\n      var anyPendingMarks = false;\n      triggered_marks.forEach(function (t_mark) {\n        if (t_mark.currentState === \"PENDING\") {\n          anyPendingMarks = true;\n        }\n\n        if (t_mark.currentState === \"TRIGGERED\") {\n          anyTriggeredMarks = true;\n        }\n      });\n      var origin_marks = [];\n      var markUntriggered = false;\n\n      if (anyTriggeredMarks && anyPendingMarks) {\n        triggered_marks.forEach(function (t_mark) {\n          if (t_mark.viewOrigin !== undefined && t_mark.currentState === 'HOLD') {\n            origin_marks.push(t_mark.viewOrigin);\n          }\n\n          if (t_mark.currentState === 'TRIGGERED' && t_mark.viewOrigin !== undefined && origin_marks.indexOf(t_mark.viewOrigin) === -1) {\n            origin_marks.push(t_mark.viewOrigin);\n          }\n        });\n        triggered_marks.forEach(function (t_mark) {\n          if (t_mark.currentState === 'PENDING' && t_mark.viewOrigin !== undefined && origin_marks.indexOf(t_mark.viewOrigin) === -1) {\n            markUntriggered = true;\n          }\n        });\n\n        if (markUntriggered) {\n          var newMarksArray = [];\n          triggered_marks.forEach(function (t_mark) {\n            if (t_mark.currentState === 'TRIGGERED') {\n              t_mark.currentState = 'HOLD';\n            }\n\n            newMarksArray.push(t_mark);\n          });\n          return newMarksArray;\n        }\n\n        return triggered_marks;\n      }\n\n      return triggered_marks;\n    }\n    /**\n     * @param navItemID\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getAllRichDescendantBoxes\",\n    value: function getAllRichDescendantBoxes(navItemID) {\n      var view = Ediphy.State.navItemsById[navItemID];\n\n      if (Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(navItemID)) {\n        view = Ediphy.State.containedViewsById[navItemID];\n      }\n\n      var boxes = view.boxes;\n      var newBoxes = [];\n      var richBoxes = [];\n      Object.keys(Ediphy.State.boxesById).map(function (box) {\n        if (boxes.indexOf(box) !== -1) {\n          newBoxes.push(box);\n\n          if (Object.keys(Ediphy.State.boxesById[box].children).length !== 0) {\n            Object.keys(Ediphy.State.boxesById[box].sortableContainers).map(function (second_box) {\n              newBoxes = newBoxes.concat(Ediphy.State.boxesById[box].sortableContainers[second_box].children);\n            });\n          }\n        }\n      });\n      newBoxes.forEach(function (_final) {\n        if (Ediphy.State.pluginToolbarsById[_final] && Ediphy.State.pluginToolbarsById[_final].pluginId && Ediphy.State.pluginToolbarsById[_final].pluginId !== \"sortable_container\" && Ediphy.Visor.Plugins[Ediphy.State.pluginToolbarsById[_final].pluginId].getConfig().isRich) {\n          richBoxes.push(_final);\n        }\n      });\n      return richBoxes;\n    }\n    /**\n     * Get the current state for selected box\n     * @param backup\n     * @param current\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getActualBoxesStates\",\n    value: function getActualBoxesStates(backup, current) {\n      var nextState = backup;\n      nextState[this.state.triggeredMarks[0].origin] = current[this.state.triggeredMarks[0].origin];\n      return nextState;\n    }\n    /**\n     * Detects if element is not already in state Element so its already triggered\n     * @param triggered_event\n     * @param richElementsState\n     *\n     */\n\n  }, {\n    key: \"isNotInStateElement\",\n    value: function isNotInStateElement(triggered_event, richElementsState) {\n      if (richElementsState[triggered_event.id] === triggered_event.value) {\n        // return false\n        return true;\n      }\n\n      return true;\n    }\n    /**\n     * Remove last view from queue of views\n     */\n\n  }]);\n\n  return Visor;\n}(__WEBPACK_IMPORTED_MODULE_1_react__[\"Component\"]);\n\n\n__WEBPACK_IMPORTED_MODULE_2_react_dom___default.a.render(__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(Visor, null), document.getElementById('root'));\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(13)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY3NC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL192aXNvci9jb250YWluZXJzL1Zpc29yQXBwLmpzeD9iNTliIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNlcmlhbGl6ZSB9IGZyb20gJy4uLy4uL3JlZHVjZXJzL3NlcmlhbGl6ZXInO1xuaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHsgQnV0dG9uLCBDb2wsIEdyaWQsIFJvdyB9IGZyb20gJ3JlYWN0LWJvb3RzdHJhcCc7XG5pbXBvcnQgVmlzb3JDYW52YXMgZnJvbSAnLi4vY29tcG9uZW50cy9jYW52YXMvVmlzb3JDYW52YXMnO1xuaW1wb3J0IFZpc29yQ29udGFpbmVkQ2FudmFzIGZyb20gJy4uL2NvbXBvbmVudHMvY2FudmFzL1Zpc29yQ29udGFpbmVkQ2FudmFzJztcbmltcG9ydCBWaXNvclNpZGVOYXYgZnJvbSAnLi4vY29tcG9uZW50cy9uYXZpZ2F0aW9uL1Zpc29yU2lkZU5hdic7XG5pbXBvcnQgVmlzb3JQbGF5ZXIgZnJvbSAnLi8uLi9jb21wb25lbnRzL25hdmlnYXRpb24vVmlzb3JQbGF5ZXInO1xuXG5pbXBvcnQgeyBpc0NvbnRhaW5lZFZpZXcsIGlzUGFnZSwgaXNTZWN0aW9uLCBpc1ZpZXcgfSBmcm9tICcuLi8uLi9jb21tb24vdXRpbHMnO1xuaW1wb3J0IFNjb3JtQ29tcG9uZW50IGZyb20gJy4uL2NvbXBvbmVudHMvc2NvcmUvR3JhZGVDb21wb25lbnQnO1xuaW1wb3J0IGkxOG4gZnJvbSAnLi4vLi4vbG9jYWxlcy9pMThuJztcbmltcG9ydCAndHlwZWZhY2UtdWJ1bnR1JztcbmltcG9ydCAndHlwZWZhY2Utc291cmNlLXNhbnMtcHJvJztcbmltcG9ydCAnQHRyZW5kbWljcm8vcmVhY3QtdG9nZ2xlLXN3aXRjaC9kaXN0L3JlYWN0LXRvZ2dsZS1zd2l0Y2guY3NzJztcbmltcG9ydCAnLi8uLi8uLi9zYXNzL3N0eWxlLnNjc3MnO1xuaW1wb3J0ICcuLi8uLi9jb3JlL3Zpc29yL3Zpc29yRW50cnlwb2ludCc7XG5cbmlmIChnbG9iYWwgJiYgIWdsb2JhbC5fYmFiZWxQb2x5ZmlsbCkge1xuICAgIHJlcXVpcmUoJ2JhYmVsLXBvbHlmaWxsJyk7XG59XG5cbnJlcXVpcmUoJ2VzNi1wcm9taXNlJykucG9seWZpbGwoKTtcblxuLyoqXG4gKiBWaXNvciBhcHAgbWFpbiBjb21wb25lbnRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlzb3IgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICBsZXQgaW5pdGlhbFZpZXcgPSB0aGlzLmdldEN1cnJlbnRWaWV3KEVkaXBoeS5TdGF0ZS5uYXZJdGVtU2VsZWN0ZWQsIEVkaXBoeS5TdGF0ZS5jb250YWluZWRWaWV3U2VsZWN0ZWQpO1xuICAgICAgICBpZiAoIUVkaXBoeS5TdGF0ZS5wcmV2aWV3KSB7XG4gICAgICAgICAgICBsZXQgcmVtYWluaW5nVmlld3MgPSBFZGlwaHkuU3RhdGUubmF2SXRlbXNJZHMuZmlsdGVyKG49PntcbiAgICAgICAgICAgICAgICBsZXQgbmF2ID0gRWRpcGh5LlN0YXRlLm5hdkl0ZW1zQnlJZFtuXTtcbiAgICAgICAgICAgICAgICBsZXQgcmV0dXJuSXQgPSBpc1NlY3Rpb24obmF2LmlkKSA/IEVkaXBoeS5Db25maWcuc2VjdGlvbnNfaGF2ZV9jb250ZW50IDogdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm5JdCA9IHJldHVybkl0ICYmICFuYXYuaGlkZGVuO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXR1cm5JdCA/IG5hdi5pZCA6IG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZW1haW5pbmdWaWV3cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbFZpZXcgPSByZW1haW5pbmdWaWV3c1swXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudGltZXIgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgY3VycmVudFZpZXc6IFtpbml0aWFsVmlld10sIC8qIFRoaXMgaXMgdGhlIGFjdHVhbCB2aWV3IHJlbmRlcmluZyovXG4gICAgICAgICAgICB0cmlnZ2VyZWRNYXJrczogW10sXG4gICAgICAgICAgICBzaG93cG9wOiBmYWxzZSxcbiAgICAgICAgICAgIHJpY2hFbGVtZW50U3RhdGU6IHt9LFxuICAgICAgICAgICAgYmFja3VwRWxlbWVudFN0YXRlczoge30sXG4gICAgICAgICAgICB0b2dnbGVkU2lkZWJhcjogZmFsc2UsIC8vIEVkaXBoeS5TdGF0ZS5nbG9iYWxDb25maWcudmlzb3JOYXYuc2lkZWJhciA/IEVkaXBoeS5TdGF0ZS5nbG9iYWxDb25maWcudmlzb3JOYXYuc2lkZWJhciA6IChFZGlwaHkuU3RhdGUuZ2xvYmFsQ29uZmlnLnZpc29yTmF2LnNpZGViYXIgPT09IHVuZGVmaW5lZCksXG4gICAgICAgICAgICBmcm9tU2Nvcm06IEVkaXBoeS5TdGF0ZS5mcm9tU2Nvcm0sXG4gICAgICAgICAgICBzY29yZUluZm86IHsgdXNlck5hbWU6IFwiQW5vbnltb3VzXCIsIHRvdGFsU2NvcmU6IDAsIHRvdGFsV2VpZ2h0OiAwLCBjb21wbGV0aW9uUHJvZ3Jlc3M6IDAgfSxcbiAgICAgICAgICAgIG1vdXNlTW92aW5nOiBmYWxzZSxcbiAgICAgICAgICAgIG1vdXNlT25QbGF5ZXI6IGZhbHNlLFxuICAgICAgICAgICAgYmFja3dhcmRzOiBmYWxzZSxcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoIUVkaXBoeS5TdGF0ZS5leHBvcnQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5leHBvcnQgPSAoZm9ybWF0ID0gJ0hUTUwnKSA9PiB7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGZvcm1hdCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1NDT1JNMTInOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydFRvU2Nvcm0oZmFsc2UsICgpPT57cmV0dXJuIHRydWU7fSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjYXNlICdTQ09STTIwMDQnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydFRvU2Nvcm0odHJ1ZSwgKCk9PntyZXR1cm4gdHJ1ZTt9LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0hUTUwnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydFRvU2Nvcm0oJ0hUTUwnLCAoKT0+e3JldHVybiB0cnVlO30sIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZmV0Y2goRWRpcGh5LkNvbmZpZy50aGVtZV9jc3NfdXJsKSAvLyBXZWJwYWNrIG91dHB1dCBDU1NcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgaWYoIXJlcy5vaykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Vycm9yJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXMudGV4dCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgIHdpbmRvdy50aGVtZV9jc3MgPSBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoKT0+ICcnKTtcbiAgICB9XG5cbiAgICBzZXRIb3ZlckNsYXNzID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgbW91c2VPblBsYXllcjogdHJ1ZSB9KTtcbiAgICB9O1xuXG4gICAgZGVsZXRlSG92ZXJDbGFzcyA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1vdXNlT25QbGF5ZXI6IGZhbHNlIH0pO1xuICAgIH07XG5cbiAgICBfb25Nb3VzZU1vdmUgPSAoKSA9PiB7XG4gICAgICAgIGlmKCF0aGlzLnN0YXRlLm1vdXNlTW92aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgbW91c2VNb3Zpbmc6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZih0aGlzLnRpbWVyKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBtb3VzZU1vdmluZzogZmFsc2UgfSk7XG4gICAgICAgICAgICB9LCAyNTAwKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZShuZXh0UHJvcHMsIG5leHRTdGF0ZSkge1xuICAgICAgICAvLyByZXNldCBtYXJrcyB3aGVuIG5hdmlnYXRpbmcgYmV0d2VlbiBtYWluIHNlY3Rpb25zXG4gICAgICAgIGlmKHRoaXMuc3RhdGUuY3VycmVudFZpZXcubGVuZ3RoICE9PSBuZXh0U3RhdGUuY3VycmVudFZpZXcubGVuZ3RoICYmIGlzVmlldyhuZXh0U3RhdGUuY3VycmVudFZpZXdbbmV4dFN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCAtIDFdKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRyaWdnZXJlZE1hcmtzOiBbXSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCA+IDEgJiYgdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5maWx0ZXIoKGkpID0+IGkuaW5kZXhPZihcInBhLVwiKSAhPT0gLTEpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50VmlldzogW3RoaXMuc3RhdGUuY3VycmVudFZpZXdbdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5sZW5ndGggLSAxXV0gfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNYXJrIHRyaWdnZXJpbmcgbWVjaGFuaXNtXG4gICAgICAgIGlmKG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcy5sZW5ndGggIT09IDAgJiYgdGhpcy5yZXR1cm5UcmlnZ2VyZWFibGVNYXJrKG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcykpIHtcbiAgICAgICAgICAgIGxldCBuZXdNYXJrID0gdGhpcy5yZXR1cm5UcmlnZ2VyZWFibGVNYXJrKG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcyk7XG5cbiAgICAgICAgICAgIG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcy5mb3JFYWNoKG1hcms9PntcbiAgICAgICAgICAgICAgICBpZihuZXdNYXJrLmlkID09PSBtYXJrLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmsuY3VycmVudFN0YXRlID0gJ1RSSUdHRVJFRCc7XG4gICAgICAgICAgICAgICAgICAgIG1hcmsudmlld09yaWdpbiA9IHRoaXMuc3RhdGUuY3VycmVudFZpZXdbdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcms7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTmV3IG9yIGV4aXN0aW5nIG1hcmtcbiAgICAgICAgICAgIGlmKG5ld01hcmsuY29ubmVjdE1vZGUgPT09ICduZXcnIHx8IG5ld01hcmsuY29ubmVjdE1vZGUgPT09IFwiZXhpc3RpbmdcIikge1xuXG4gICAgICAgICAgICAgICAgbGV0IGFycmF5X3RyaWdnZXJfbWFyayA9IHRoaXMuc2FudGluaXplVmlld3NBcnJheShuZXh0U3RhdGUudHJpZ2dlcmVkTWFya3MsIG5leHRTdGF0ZS5jdXJyZW50Vmlldy5jb25jYXQoW25ld01hcmsuY29ubmVjdGlvbl0pKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Y3YgPSBhcnJheV90cmlnZ2VyX21hcmsubGVuZ3RoID4gMCAmJiBhcnJheV90cmlnZ2VyX21hcmtbYXJyYXlfdHJpZ2dlcl9tYXJrLmxlbmd0aCAtIDFdICYmIGlzQ29udGFpbmVkVmlldyhhcnJheV90cmlnZ2VyX21hcmtbYXJyYXlfdHJpZ2dlcl9tYXJrLmxlbmd0aCAtIDFdKSA/IGFycmF5X3RyaWdnZXJfbWFya1thcnJheV90cmlnZ2VyX21hcmsubGVuZ3RoIC0gMV0gOiAwO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lZFZpZXdTZWxlY3RlZDogbmV3Y3YsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWaWV3OiBhcnJheV90cmlnZ2VyX21hcmssXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZE1hcmtzOiBuZXh0U3RhdGUudHJpZ2dlcmVkTWFya3MsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEV4dGVybmFsIHRhcmdldFxuICAgICAgICAgICAgfSBlbHNlIGlmKG5ld01hcmsuY29ubmVjdE1vZGUgPT09IFwiZXh0ZXJuYWxcIikge1xuICAgICAgICAgICAgICAgIGxldCB3aW4gPSB3aW5kb3cub3BlbihuZXdNYXJrLmNvbm5lY3Rpb24sICdfYmxhbmsnKTtcbiAgICAgICAgICAgICAgICB3aW4uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICBsZXQgc2hpZnRFeHRlcm5hbCA9IG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcztcbiAgICAgICAgICAgICAgICBzaGlmdEV4dGVybmFsLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZE1hcmtzOiBzaGlmdEV4dGVybmFsLFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYobmV3TWFyay5jb25uZWN0TW9kZSA9PT0gXCJwb3B1cFwiKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNoaWZ0UG9wID0gbmV4dFN0YXRlLnRyaWdnZXJlZE1hcmtzO1xuICAgICAgICAgICAgICAgIHNoaWZ0UG9wLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgbGV0IG1hcmtwb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFyay0nICsgbmV3TWFyay5pZCk7XG4gICAgICAgICAgICAgICAgaWYgKG1hcmtwb3ApIHsgbWFya3BvcC5jbGljaygpO31cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgc2hvd3BvcDogIXRoaXMuc3RhdGUuc2hvd3BvcCxcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkTWFya3M6IHNoaWZ0UG9wLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIC8qXG4gICAgICAgICogQWRkIEtleSBiaW5kaW5ncyB0byBhcHBcbiAgICAgICAgKiAqL1xuICAgICAgICBpZihFZGlwaHkuU3RhdGUuZ2xvYmFsQ29uZmlnLnZpc29yTmF2LmtleUJpbmRpbmdzKSB7XG4gICAgICAgICAgICAvLyBGaXJzdCBnZXQgd2luZG93IGZvY3VzIHNvIGFycm93cyB3b3JrIHJpZ2h0IGF3YXlcbiAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpO1xuICAgICAgICAgICAgd2luZG93Lm9ua2V5dXAgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgbGV0IGtleSA9IGUua2V5Q29kZSA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICAgICAgICAgICAgbGV0IG5hdkl0ZW1zSWRzID0gRWRpcGh5LlN0YXRlLm5hdkl0ZW1zSWRzO1xuICAgICAgICAgICAgICAgIGxldCBuYXZJdGVtcyA9IEVkaXBoeS5TdGF0ZS5uYXZJdGVtc0J5SWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIUVkaXBoeS5Db25maWcuc2VjdGlvbnNfaGF2ZV9jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIG5hdkl0ZW1zSWRzID0gbmF2SXRlbXNJZHMuZmlsdGVyKChlbGVtZW50KT0+KGVsZW1lbnQuaW5kZXhPZihcInNlXCIpID09PSAtMSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuYXZJdGVtc0lkcyA9IG5hdkl0ZW1zSWRzLmZpbHRlcihuYXY9PiB7cmV0dXJuICFuYXZJdGVtc1tuYXZdLmhpZGRlbjt9KTtcbiAgICAgICAgICAgICAgICBsZXQgbmF2SXRlbVNlbGVjdGVkID0gdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5yZWR1Y2UoZWxlbWVudD0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzUGFnZShlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBuYXZJdGVtc0lkcy5pbmRleE9mKG5hdkl0ZW1TZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgbGV0IG1heEluZGV4ID0gbmF2SXRlbXNJZHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGxldCBmb2N1c0VsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNFbGVtZW50ICE9PSAnaW5wdXQnICYmIGZvY3VzRWxlbWVudCAhPT0gJ3RleHRhcmVhJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAzNyB8fCBrZXkgPT09IDMzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUN1cnJlbnRWaWV3KG5hdkl0ZW1zSWRzW01hdGgubWF4KGluZGV4IC0gMSwgMCldLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGtleSA9PT0gMzkgfHwga2V5ID09PSAzNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VDdXJyZW50VmlldyhuYXZJdGVtc0lkc1tNYXRoLm1pbihpbmRleCArIDEsIG1heEluZGV4IC0gMSldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGlmICh3aW5kb3cuU3RhdGUpIHtcbiAgICAgICAgICAgIEVkaXBoeS5TdGF0ZSA9IHNlcmlhbGl6ZSh7IFwicHJlc2VudFwiOiB7IC4uLndpbmRvdy5TdGF0ZSB9IH0pLnByZXNlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHsgbmF2SXRlbXNJZHMsIGdsb2JhbENvbmZpZywgc3R5bGVDb25maWcsIGNvbnRhaW5lZFZpZXdzQnlJZCwgYm94ZXNCeUlkLCBtYXJrc0J5SWQsIG5hdkl0ZW1zQnlJZCwgdmlld1Rvb2xiYXJzQnlJZCwgcGx1Z2luVG9vbGJhcnNCeUlkIH0gPSBFZGlwaHkuU3RhdGU7XG4gICAgICAgIGxldCBlZGlwaHlfZG9jdW1lbnRfaWQgPSBFZGlwaHkuU3RhdGUuaWQ7XG4gICAgICAgIGxldCBlZGlwaHlfcGxhdGZvcm0gPSBFZGlwaHkuU3RhdGUucGxhdGZvcm07XG4gICAgICAgIGxldCBleGVyY2lzZXMgPSB7fTtcbiAgICAgICAgT2JqZWN0LmtleXMoRWRpcGh5LlN0YXRlLmV4ZXJjaXNlcykubWFwKGV4ZXJjaXNlPT57XG4gICAgICAgICAgICBpZiAoY29udGFpbmVkVmlld3NCeUlkW2V4ZXJjaXNlXSB8fCAobmF2SXRlbXNCeUlkW2V4ZXJjaXNlXSAmJiAhbmF2SXRlbXNCeUlkW2V4ZXJjaXNlXS5oaWRkZW4pKSB7XG4gICAgICAgICAgICAgICAgZXhlcmNpc2VzW2V4ZXJjaXNlXSA9IEVkaXBoeS5TdGF0ZS5leGVyY2lzZXNbZXhlcmNpc2VdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbGV0IHRpdGxlID0gZ2xvYmFsQ29uZmlnLnRpdGxlO1xuICAgICAgICBsZXQgcmF0aW8gPSBnbG9iYWxDb25maWcuY2FudmFzUmF0aW87XG4gICAgICAgIGxldCB2aXNvck5hdiA9IGdsb2JhbENvbmZpZy52aXNvck5hdjtcbiAgICAgICAgbGV0IHdyYXBwZXJDbGFzc2VzID0gdGhpcy5zdGF0ZS50b2dnbGVkU2lkZWJhciA/IFwidmlzb3J3cmFwcGVyIHRvZ2dsZWRcIiA6IFwidmlzb3J3cmFwcGVyXCI7XG4gICAgICAgIGxldCB0b2dnbGVJY29uID0gdGhpcy5zdGF0ZS50b2dnbGVkU2lkZWJhciA/IFwia2V5Ym9hcmRfYXJyb3dfbGVmdFwiIDogXCJrZXlib2FyZF9hcnJvd19yaWdodFwiO1xuICAgICAgICBsZXQgdG9nZ2xlQ29sb3IgPSB0aGlzLnN0YXRlLnRvZ2dsZWRTaWRlYmFyID8gXCJ0b2dnbGVDb2xvclwiIDogXCJcIjtcbiAgICAgICAgbGV0IGlzQ1YgPSBpc0NvbnRhaW5lZFZpZXcodGhpcy5zdGF0ZS5jdXJyZW50Vmlldyk7XG4gICAgICAgIGxldCBpc1NsaWRlID0gaXNDViAmJiBjb250YWluZWRWaWV3c0J5SWRbdGhpcy5nZXRMYXN0Q3VycmVudFZpZXdFbGVtZW50KCldID09PSBcInNsaWRlXCIgfHxcbiAgICAgICAgIWlzQ1YgJiYgbmF2SXRlbXNCeUlkW3RoaXMuZ2V0TGFzdEN1cnJlbnRWaWV3RWxlbWVudCgpXSA9PT0gXCJzbGlkZVwiID9cbiAgICAgICAgICAgIFwicGN3X3NsaWRlXCIgOiBcInBjd19kb2NcIjtcblxuICAgICAgICBsZXQgdmlzaFBsYXllciA9IChnbG9iYWxDb25maWcudmlzb3JOYXYgJiYgZ2xvYmFsQ29uZmlnLnZpc29yTmF2LmZpeGVkUGxheWVyICE9PSB1bmRlZmluZWQpID8gZ2xvYmFsQ29uZmlnLnZpc29yTmF2LmZpeGVkUGxheWVyIDogdHJ1ZTtcbiAgICAgICAgbGV0IGN1cnJlbnRWaWV3ID0gdGhpcy5nZXRMYXN0Q3VycmVudFZpZXdFbGVtZW50KCk7XG4gICAgICAgIGxldCBjYW52YXNQcm9wcyA9IHtcbiAgICAgICAgICAgIGJveGVzOiBib3hlc0J5SWQsXG4gICAgICAgICAgICBjaGFuZ2VDdXJyZW50VmlldzogKGVsZW1lbnQpID0+IHt0aGlzLmNoYW5nZUN1cnJlbnRWaWV3KGVsZW1lbnQpO30sXG4gICAgICAgICAgICBjYW52YXNSYXRpbzogcmF0aW8sXG4gICAgICAgICAgICBjb250YWluZWRWaWV3czogY29udGFpbmVkVmlld3NCeUlkLFxuICAgICAgICAgICAgY3VycmVudFZpZXc6IGN1cnJlbnRWaWV3LFxuICAgICAgICAgICAgZnJvbVNjb3JtOiB0aGlzLnN0YXRlLmZyb21TY29ybSxcbiAgICAgICAgICAgIG5hdkl0ZW1zOiBuYXZJdGVtc0J5SWQsXG4gICAgICAgICAgICBuYXZJdGVtc0lkcyxcbiAgICAgICAgICAgIHJlbW92ZUxhc3RWaWV3OiB0aGlzLnJlbW92ZUxhc3RWaWV3LFxuICAgICAgICAgICAgcmljaEVsZW1lbnRzU3RhdGU6IHRoaXMuc3RhdGUucmljaEVsZW1lbnRTdGF0ZSxcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgbWFya3M6IG1hcmtzQnlJZCxcbiAgICAgICAgICAgIHZpZXdUb29sYmFyczogdmlld1Rvb2xiYXJzQnlJZCxcbiAgICAgICAgICAgIHBsdWdpblRvb2xiYXJzOiBwbHVnaW5Ub29sYmFyc0J5SWQsXG4gICAgICAgICAgICBvbk1hcmtDbGlja2VkOiB0aGlzLm9uTWFya0NsaWNrZWQsXG4gICAgICAgICAgICB0cmlnZ2VyZWRNYXJrczogdGhpcy5zdGF0ZS50cmlnZ2VyZWRNYXJrcyxcbiAgICAgICAgICAgIHZpZXdzQXJyYXk6IHRoaXMuc3RhdGUuY3VycmVudFZpZXcsXG4gICAgICAgICAgICBleHBvcnRNb2RhbE9wZW46IGZhbHNlLFxuICAgICAgICAgICAgZWRpcGh5X2RvY3VtZW50X2lkLFxuICAgICAgICAgICAgZWRpcGh5X3BsYXRmb3JtLFxuICAgICAgICAgICAgZXhlcmNpc2VzLFxuICAgICAgICAgICAgc3R5bGVDb25maWc6IHN0eWxlQ29uZmlnIHx8IHt9LFxuICAgICAgICB9O1xuXG4gICAgICAgIGxldCBuYXZJdGVtQ29tcG9uZW50cyA9IE9iamVjdC5rZXlzKG5hdkl0ZW1zQnlJZCkuZmlsdGVyKG5hdj0+aXNQYWdlKG5hdikpLm1hcCgobmF2LCBpKT0+e1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8Vmlzb3JDYW52YXMga2V5PXtpfSB7Li4uY2FudmFzUHJvcHN9IHNlbGVjdGVkVmlldz17Y3VycmVudFZpZXd9IGJhY2t3YXJkcyA9IHt0aGlzLnN0YXRlLmJhY2t3YXJkc30gY3VycmVudFZpZXc9e25hdn0gc2hvdz17bmF2ID09PSBjdXJyZW50Vmlld30gej17IGkgKyAxMH0gc2hvd0NhbnZhcz17bmF2LmluZGV4T2YoXCJjdi1cIikgPT09IC0xfSAvPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBjdkNvbXBvbmVudHMgPSBPYmplY3Qua2V5cyhjb250YWluZWRWaWV3c0J5SWQpLm1hcCgobmF2LCBpKT0+e1xuICAgICAgICAgICAgcmV0dXJuIDxWaXNvckNvbnRhaW5lZENhbnZhcyBrZXk9e2l9IHsuLi5jYW52YXNQcm9wc30gY3VycmVudFZpZXc9e25hdn0gc2hvdz17bmF2ID09PSBjdXJyZW50Vmlld30gej17IGkgKyBuYXZJdGVtQ29tcG9uZW50cy5sZW5ndGggfSBzaG93Q2FudmFzPXtuYXYuaW5kZXhPZihcImN2LVwiKSAhPT0gLTF9IC8+O1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY29udGVudCA9IFsuLi5uYXZJdGVtQ29tcG9uZW50cywgY3ZDb21wb25lbnRzXTtcbiAgICAgICAgbGV0IGVtcHR5ID0gPGRpdiBjbGFzc05hbWU9XCJlbXB0eVByZXNlbnRhdGlvblwiPntpMThuLnQoXCJFbXB0eVByZXNlbnRhdGlvblwiKX08L2Rpdj47XG4gICAgICAgIGxldCB2aXNvck5hdkJ1dHRvbkNsYXNzID0gJ2hvdmVyUGxheWVyU2VsZWN0b3InO1xuICAgICAgICB2aXNvck5hdkJ1dHRvbkNsYXNzID0gdGhpcy5zdGF0ZS5tb3VzZU1vdmluZyA/IHZpc29yTmF2QnV0dG9uQ2xhc3MgKyAnIGFwcGVhckJ1dHRvbicgOiB2aXNvck5hdkJ1dHRvbkNsYXNzICsgJyBmYWRlQnV0dG9uJztcbiAgICAgICAgdmlzb3JOYXZCdXR0b25DbGFzcyA9IHRoaXMuc3RhdGUubW91c2VPblBsYXllciA/IHZpc29yTmF2QnV0dG9uQ2xhc3MgKyAnIGhvdmVyUGxheWVyT24nIDogdmlzb3JOYXZCdXR0b25DbGFzcztcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgaWQ9XCJhcHBcIiByZWY9eydhcHAnfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17d3JhcHBlckNsYXNzZXN9XG4gICAgICAgICAgICAgICAgb25Nb3VzZU1vdmU9e3RoaXMuX29uTW91c2VNb3ZlfT5cbiAgICAgICAgICAgICAgICA8Vmlzb3JTaWRlTmF2XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUN1cnJlbnRWaWV3PXsocGFnZSk9PiB7dGhpcy5jaGFuZ2VDdXJyZW50VmlldyhwYWdlKTt9fVxuICAgICAgICAgICAgICAgICAgICBjb3Vyc2VUaXRsZT17dGl0bGV9XG4gICAgICAgICAgICAgICAgICAgIHNob3c9e3Zpc29yTmF2LnNpZGViYXJ9XG4gICAgICAgICAgICAgICAgICAgIHNob3dTY29yZT17IWdsb2JhbENvbmZpZy5oaWRlR2xvYmFsU2NvcmV9XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWaWV3cz17dGhpcy5zdGF0ZS5jdXJyZW50Vmlld31cbiAgICAgICAgICAgICAgICAgICAgbmF2SXRlbXNCeUlkPXtuYXZJdGVtc0J5SWR9XG4gICAgICAgICAgICAgICAgICAgIG5hdkl0ZW1zSWRzPXtuYXZJdGVtc0lkcy5maWx0ZXIobmF2PT4ge3JldHVybiAhbmF2SXRlbXNCeUlkW25hdl0uaGlkZGVuO30pfVxuICAgICAgICAgICAgICAgICAgICB2aWV3VG9vbGJhcnM9e3ZpZXdUb29sYmFyc0J5SWR9XG4gICAgICAgICAgICAgICAgICAgIHNjb3JlSW5mbz17dGhpcy5zdGF0ZS5zY29yZUluZm99XG4gICAgICAgICAgICAgICAgICAgIGV4ZXJjaXNlcz17ZXhlcmNpc2VzfVxuICAgICAgICAgICAgICAgICAgICB0b2dnbGVkPXt0aGlzLnN0YXRlLnRvZ2dsZWRTaWRlYmFyfS8+XG4gICAgICAgICAgICAgICAgPGRpdiBpZD1cInBhZ2UtY29udGVudC13cmFwcGVyXCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtpc1NsaWRlICsgXCIgcGFnZS1jb250ZW50LXdyYXBwZXJcIn1cbiAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgaGVpZ2h0OiAnMTAwJScgfX0+XG4gICAgICAgICAgICAgICAgICAgIDxHcmlkIGZsdWlkIGlkPVwidmlzb3JBcHBDb250ZW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGhlaWdodDogJzEwMCUnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFJvdyBzdHlsZT17eyBoZWlnaHQ6IHZpc2hQbGF5ZXIgPyAnY2FsYygxMDAlIC0gMzhweCknIDogJzEwMCUnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDb2wgbGc9ezEyfSBzdHlsZT17eyBoZWlnaHQ6ICcxMDAlJywgcGFkZGluZ0xlZnQ6ICcwcHgnLCBwYWRkaW5nUmlnaHQ6ICcwcHgnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2Nvcm1Db21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhZGVQbGF5ZXJDbGFzcz17dmlzb3JOYXZCdXR0b25DbGFzc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEhvdmVyPXt0aGlzLnNldEhvdmVyQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVIb3ZlciA9IHt0aGlzLmRlbGV0ZUhvdmVyQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTY29yZT17KHNjb3JlSW5mbyk9Pnt0aGlzLnNldFN0YXRlKHsgc2NvcmVJbmZvIH0pO319XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXZJdGVtc0lkcz17bmF2SXRlbXNJZHMuZmlsdGVyKG5hdj0+IHtyZXR1cm4gIW5hdkl0ZW1zQnlJZFtuYXZdLmhpZGRlbjt9KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lZFZpZXdzPXtjb250YWluZWRWaWV3c0J5SWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Vmlldz17Y3VycmVudFZpZXd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXZJdGVtc0J5SWQ9e25hdkl0ZW1zQnlJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbENvbmZpZz17Z2xvYmFsQ29uZmlnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVDb25maWc9e3N0eWxlQ29uZmlnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhlcmNpc2VzPXtleGVyY2lzZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5Ub29sYmFycz17cGx1Z2luVG9vbGJhcnNCeUlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbVNjb3JtPXt0aGlzLnN0YXRlLmZyb21TY29ybX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUN1cnJlbnRWaWV3PXsoZWwpPT57dGhpcy5jaGFuZ2VDdXJyZW50VmlldyhlbCk7fX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y3VycmVudFZpZXcgPyBjb250ZW50IDogZW1wdHl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvU2Nvcm1Db21wb25lbnQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgIXZpc2hQbGF5ZXIgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Vmlzb3JQbGF5ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWRlUGxheWVyQ2xhc3M9e3Zpc29yTmF2QnV0dG9uQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0SG92ZXI9e3RoaXMuc2V0SG92ZXJDbGFzc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVIb3ZlciA9IHt0aGlzLmRlbGV0ZUhvdmVyQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdz17dmlzb3JOYXYucGxheWVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUN1cnJlbnRWaWV3PXsocGFnZSwgYmFja3dhcmRzKT0+IHt0aGlzLmNoYW5nZUN1cnJlbnRWaWV3KHBhZ2UsIGJhY2t3YXJkcyk7fX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Vmlld3M9e3RoaXMuc3RhdGUuY3VycmVudFZpZXd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF2SXRlbXNCeUlkPXtuYXZJdGVtc0J5SWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF2SXRlbXNJZHM9e25hdkl0ZW1zSWRzLmZpbHRlcihuYXY9PiB7cmV0dXJuICFuYXZJdGVtc0J5SWRbbmF2XS5oaWRkZW47fSl9Lz4pIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3Zpc29yTmF2LnNpZGViYXIgPyAoPGRpdiBjbGFzc05hbWU9e1widmlzb3JOYXZCdXR0b25EaXZcIn0gb25Nb3VzZUVudGVyPXsoKT0+IHRoaXMuc2V0SG92ZXJDbGFzcygpfSBvbk1vdXNlTGVhdmU9eygpPT50aGlzLmRlbGV0ZUhvdmVyQ2xhc3MoKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIGlkPVwidmlzb3JOYXZCdXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17dG9nZ2xlQ29sb3IgKyB2aXNvck5hdkJ1dHRvbkNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzU3R5bGU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0b2dnbGVkU2lkZWJhcjogIXRoaXMuc3RhdGUudG9nZ2xlZFNpZGViYXIgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cIm1hdGVyaWFsLWljb25zXCI+e3RvZ2dsZUljb259PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+PC9kaXY+KSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxSb3cgc3R5bGU9e3sgaGVpZ2h0OiAnMzhweCcsIGRpc3BsYXk6IHZpc2hQbGF5ZXIgPyAnYmxvY2snIDogJ25vbmUnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxDb2wgbGc9ezEyfSBzdHlsZT17eyBoZWlnaHQ6ICcxMDAlJywgcGFkZGluZ0xlZnQ6ICcwcHgnLCBwYWRkaW5nUmlnaHQ6ICcwcHgnIH19PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Vmlzb3JQbGF5ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhZGVQbGF5ZXJDbGFzcz17XCJhcHBlYXJCdXR0b25cIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEhvdmVyPXt0aGlzLnNldEhvdmVyQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVIb3ZlciA9IHt0aGlzLmRlbGV0ZUhvdmVyQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93PXt2aXNvck5hdi5wbGF5ZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDdXJyZW50Vmlldz17KHBhZ2UsIGJhY2t3YXJkcyk9PiB7dGhpcy5jaGFuZ2VDdXJyZW50VmlldyhwYWdlLCBiYWNrd2FyZHMpO319XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Vmlld3M9e3RoaXMuc3RhdGUuY3VycmVudFZpZXd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXZJdGVtc0J5SWQ9e25hdkl0ZW1zQnlJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdkl0ZW1zSWRzPXtuYXZJdGVtc0lkcy5maWx0ZXIobmF2PT4ge3JldHVybiAhbmF2SXRlbXNCeUlkW25hdl0uaGlkZGVuO30pfS8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Db2w+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1Jvdz5cbiAgICAgICAgICAgICAgICAgICAgPC9HcmlkPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+KTtcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4cG9ydCB0byBIVE1MIG9yIFBERlxuICAgICAqIEBwYXJhbSBmb3JtYXRcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIGV4cG9ydChmb3JtYXQsIGNhbGxiYWNrLCBvcHRpb25zID0gZmFsc2UpIHtcbiAgICAgICAgaWYoZm9ybWF0ID09PSBcIlBERlwiKSB7XG4gICAgICAgICAgICBwcmludFRvUERGKEVkaXBoeS5TdGF0ZSwgY2FsbGJhY2ssIG9wdGlvbnMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgRWRpcGh5LlZpc29yLmV4cG9ydHNIVE1MKEVkaXBoeS5TdGF0ZSwgY2FsbGJhY2ssIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZXhwb3J0VG9TY29ybShpczIwMDQsIGNhbGxiYWNrLCBzZWxmQ29udGFpbmVkID0gZmFsc2UpIHtcbiAgICAgICAgRWRpcGh5LlZpc29yLmV4cG9ydFNjb3JtKEVkaXBoeS5TdGF0ZSwgaXMyMDA0LCBjYWxsYmFjaywgc2VsZkNvbnRhaW5lZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFjdHVhbFZpZXcgUkVGQUNUT1I6IGNoYW5nZSBuYW1lXG4gICAgICogQHJldHVybnMge1N0cmluZ30gY3VycmVudFZpZXdcbiAgICAgKi9cbiAgICBnZXRMYXN0Q3VycmVudFZpZXdFbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZS5jdXJyZW50Vmlld1t0aGlzLnN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCAtIDFdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE5hdmlnYXRpb24gbWFpbiBtZXRob2RcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZWxlbWVudCAtIGN1cnJlbnQgRWxlbWVudCB0byBnb1xuICAgICAqL1xuICAgIGNoYW5nZUN1cnJlbnRWaWV3KGVsZW1lbnQsIGJhY2t3YXJkcyA9IGZhbHNlKSB7XG4gICAgICAgIGlmIChpc0NvbnRhaW5lZFZpZXcoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50VmlldzogW3RoaXMuZ2V0Q3VycmVudFZpZXcodGhpcy5zdGF0ZS5uYXZJdGVtU2VsZWN0ZWQsIHRoaXMuc3RhdGUuY29udGFpbmVkVmlld1NlbGVjdGVkKSwgZWxlbWVudF0sIGJhY2t3YXJkczogYmFja3dhcmRzIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGN1cnJlbnRWaWV3OiBbZWxlbWVudF0sIGJhY2t3YXJkczogYmFja3dhcmRzIH0pO1xuICAgICAgICAgICAgaWYodGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRyaWdnZXJlZE1hcmtzOiB0aGlzLnVuVHJpZ2dlckxhc3RNYXJrKHRoaXMuc3RhdGUudHJpZ2dlcmVkTWFya3MpLFxuICAgICAgICAgICAgICAgICAgICByaWNoRWxlbWVudFN0YXRlOiB0aGlzLmdldEFjdHVhbEJveGVzU3RhdGVzKHRoaXMuc3RhdGUuYmFja3VwRWxlbWVudFN0YXRlcywgdGhpcy5zdGF0ZS5yaWNoRWxlbWVudFN0YXRlKSwgYmFja3dhcmRzOiBiYWNrd2FyZHMgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgaXMgdXNlZCB0byBnZXQgaW5pdGlhbCB2aWV3IGFuZCBtYWtlIHN1cmUgaXMgZWl0aGVyIGNvbnRhaW5lZFZpZXcgb3IgTmF2SXRlbVxuICAgICAqIEBwYXJhbSBOSXNlbGVjdGVkXG4gICAgICogQHBhcmFtIENWc2VsZWN0ZWRcbiAgICAgKi9cbiAgICBnZXRDdXJyZW50VmlldyhOSXNlbGVjdGVkLCBDVnNlbGVjdGVkKSB7XG4gICAgICAgIGxldCBuYXZJdGVtU2VsZWN0ZWQgPSAwO1xuICAgICAgICBpZiAoRWRpcGh5LlN0YXRlLm5hdkl0ZW1zQnlJZFtOSXNlbGVjdGVkXSAmJiAhRWRpcGh5LlN0YXRlLm5hdkl0ZW1zQnlJZFtOSXNlbGVjdGVkXS5oaWRkZW4pIHtcbiAgICAgICAgICAgIG5hdkl0ZW1TZWxlY3RlZCA9IE5Jc2VsZWN0ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChDVnNlbGVjdGVkID09PSAwKSA/IG5hdkl0ZW1TZWxlY3RlZCA6IENWc2VsZWN0ZWQ7XG4gICAgfVxuXG4gICAgLyogTWFya3MgZnVuY3Rpb25zKi9cblxuICAgIC8qKlxuICAgICAqIE1ha2Ugc3VyZSBpZiBtYXJrIHZhbHVlIGV4aXN0c1xuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IC0gIHdoZXRoZXIgdGhlIG1hcmsgZXhpc3RzIG9yIG5vdCBpbiB0aGUgYXJyYXlcbiAgICAgKiBAcGFyYW0gbWFya3NcbiAgICAgKiBAcGFyYW0gbWFya192YWx1ZVxuICAgICAqL1xuICAgIGNvbnRhaW5zTWFya1ZhbHVlKG1hcmtzLCBtYXJrX3ZhbHVlKSB7XG4gICAgICAgIGxldCBleGlzdHMgPSBmYWxzZTtcbiAgICAgICAgbWFya3MuZm9yRWFjaChtYXJrX2VsZW1lbnQ9PntcbiAgICAgICAgICAgIGlmKG1hcmtfZWxlbWVudC52YWx1ZSA9PT0gbWFya192YWx1ZSkge1xuICAgICAgICAgICAgICAgIGV4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZXhpc3RzO1xuICAgIH1cblxuICAgIG9uTWFya0NsaWNrZWQgPSAoaWQsIHZhbHVlLCBzdGF0ZUVsZW1lbnQpID0+IHtcbiAgICAgICAgbGV0IHJpY2hFbGVtZW50c1N0YXRlID0gdGhpcy5zdGF0ZS5yaWNoRWxlbWVudFN0YXRlO1xuICAgICAgICBsZXQgbWFya3MgPSB0aGlzLmdldEFsbE1hcmtzKCk7XG4gICAgICAgIGxldCB0cmlnZ2VyZWRfZXZlbnQgPSB7IGlkLCB2YWx1ZSwgc3RhdGVFbGVtZW50IH07XG4gICAgICAgIGxldCB0cmlnZ2VyZWRfbWFya3MgPSB0aGlzLmdldFRyaWdnZXJlZE1hcmtzKG1hcmtzLCB0cmlnZ2VyZWRfZXZlbnQpO1xuICAgICAgICAvLyBjbGVhck1hcmsgfCBJZiBhY3R1YWwgVHJpZ2dlcmVkIE1hcmsgaGF2ZSBwYXNzZWQgZS5kZXRhaWwudmFsdWUgYW5kIGFjdHVhbCB2YWx1ZSBpcyBkaWZmZXJlbnQgb3IgYWN0dWFsIGVsZW1lbnQgZG9lc24ndCBuZWVkIHRvIGNsZWFyIHRoZSB2YWx1ZVxuICAgICAgICB0cmlnZ2VyZWRfbWFya3MgPSB0aGlzLmNsZWFyVHJpZ2dlcmVkVmFsdWVzKHRyaWdnZXJlZF9ldmVudCwgdHJpZ2dlcmVkX21hcmtzKTtcblxuICAgICAgICAvLyBKdXN0IHRyeSB0byB0cmlnZ2VyIGlmIG1hcmsgZXhpc3RzXG4gICAgICAgIGlmKHRoaXMuY29udGFpbnNNYXJrVmFsdWUobWFya3MsIHRyaWdnZXJlZF9ldmVudC52YWx1ZSkpIHtcbiAgICAgICAgLy8gQW5kIGlzIHRyaWdnZXJlYWJsZSAobm90IHBlbmRpbmcpXG4gICAgICAgICAgICBsZXQgaXNUcmlnZ2VyYWJsZSA9IHRoaXMuaXNUcmlnZ2VyZWFibGVNYXJrKHRyaWdnZXJlZF9ldmVudCwgdHJpZ2dlcmVkX21hcmtzKTtcbiAgICAgICAgICAgIGlmKGlzVHJpZ2dlcmFibGUpIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyZWRfbWFya3MgPSB0aGlzLnB1dE1hcmtzT25Ib2xkKHRyaWdnZXJlZF9tYXJrcywgdHJpZ2dlcmVkX2V2ZW50KTtcbiAgICAgICAgICAgICAgICAvLyBJZiBtYXJrIGlzIHN0b3JhYmxlIChpZiBtYWtlIGFueSBzZW5zZSB0byBzdG9yZSB0byByZW5kZXIgc29tZXRoaW5nIGRpZmZlcmVudCBsaWtlIGEgdmlkZW8pIGRvIGl0LCBlbHNlIGRvbid0XG4gICAgICAgICAgICAgICAgaWYodHJpZ2dlcmVkX2V2ZW50LnN0YXRlRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmlzTm90SW5TdGF0ZUVsZW1lbnQodHJpZ2dlcmVkX2V2ZW50LCB0aGlzLnN0YXRlLnJpY2hFbGVtZW50U3RhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3X21hcmsgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19tYXJrW3RyaWdnZXJlZF9ldmVudC5pZF0gPSB0cmlnZ2VyZWRfZXZlbnQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyZWRNYXJrczogdHJpZ2dlcmVkX21hcmtzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpY2hFbGVtZW50U3RhdGU6IE9iamVjdC5hc3NpZ24oe30sIHJpY2hFbGVtZW50c1N0YXRlLCBuZXdfbWFyayksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyZWRfbWFya3MuZm9yRWFjaCgobWFyaywgaW5kZXgpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihtYXJrLmlkID09PSBpc1RyaWdnZXJhYmxlLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkX21hcmtzW2luZGV4XSA9IGlzVHJpZ2dlcmFibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgdHJpZ2dlcmVkTWFya3M6IHRyaWdnZXJlZF9tYXJrcyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZih0cmlnZ2VyZWRfZXZlbnQuc3RhdGVFbGVtZW50KSB7XG4gICAgICAgICAgICBsZXQgYmFja3VwRWxlbWVudFN0YXRlcyA9IHRoaXMuc3RhdGUuYmFja3VwRWxlbWVudFN0YXRlcztcbiAgICAgICAgICAgIGxldCBuZXdfbWFyayA9IHt9O1xuICAgICAgICAgICAgbmV3X21hcmtbdHJpZ2dlcmVkX2V2ZW50LmlkXSA9IHRyaWdnZXJlZF9ldmVudC52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGJhY2t1cEVsZW1lbnRTdGF0ZXM6IE9iamVjdC5hc3NpZ24oe30sIGJhY2t1cEVsZW1lbnRTdGF0ZXMsIG5ld19tYXJrKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgaWYgYW55IGlzIHRoZXJlIGFueSB0cmlnZ2VyYWJsZSBtYXJrXG4gICAgICogQHBhcmFtIHRyaWdnZXJlZE1hcmtzXG4gICAgICogQHJldHVybnMgT2JqZWN0IE1hcmtzIHRoYXQgYXJlIHRyaWdnZXJlZFxuICAgICAqL1xuICAgIHJldHVyblRyaWdnZXJlYWJsZU1hcmsodHJpZ2dlcmVkTWFya3MpIHtcbiAgICAgICAgbGV0IGlzQW55VHJpZ2dlcmVhYmxlTWFyayA9IGZhbHNlO1xuICAgICAgICBsZXQgY2FuQmVUcmlnZ2VyZWQgPSB0cnVlO1xuICAgICAgICBpZihBcnJheS5pc0FycmF5KHRyaWdnZXJlZE1hcmtzKSkge1xuICAgICAgICAgICAgdHJpZ2dlcmVkTWFya3MuZm9yRWFjaChtYXJrPT57XG4gICAgICAgICAgICAgICAgaWYgKG1hcmsuY3VycmVudFN0YXRlID09PSAnVFJJR0dFUkVEJykge1xuICAgICAgICAgICAgICAgICAgICBjYW5CZVRyaWdnZXJlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZihjYW5CZVRyaWdnZXJlZCAmJiBtYXJrLmN1cnJlbnRTdGF0ZSA9PT0gJ1BFTkRJTkcnICYmICFpc0FueVRyaWdnZXJlYWJsZU1hcmspIHtcbiAgICAgICAgICAgICAgICAgICAgaXNBbnlUcmlnZ2VyZWFibGVNYXJrID0gbWFyaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNBbnlUcmlnZ2VyZWFibGVNYXJrO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgaWYgdGhlIG1hcmsgaXMgdHJpZ2dlcmVhYmxlIG9yIG5vdFxuICAgICAqIEBwYXJhbSBtYXJrXG4gICAgICogQHBhcmFtIHRyaWdnZXJhYmxlX21hcmtzXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICovXG4gICAgaXNUcmlnZ2VyZWFibGVNYXJrKG1hcmssIHRyaWdnZXJhYmxlX21hcmtzKSB7XG4gICAgICAgIGxldCBpc0FueVRyaWdnZXJlYWJsZU1hcmsgPSBmYWxzZTtcbiAgICAgICAgdHJpZ2dlcmFibGVfbWFya3MuZm9yRWFjaCh0cmlnZ2VyZWFibGVfbWFyaz0+IHtcbiAgICAgICAgICAgIGlmICh0cmlnZ2VyZWFibGVfbWFyay5jdXJyZW50U3RhdGUgPT09ICdQRU5ESU5HJyAmJiB0cmlnZ2VyZWFibGVfbWFyay52YWx1ZSA9PT0gbWFyay52YWx1ZSAmJiB0cmlnZ2VyZWFibGVfbWFyay5vcmlnaW4gPT09IG1hcmsuaWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQW55VHJpZ2dlcmVhYmxlTWFyaykge1xuICAgICAgICAgICAgICAgICAgICBpc0FueVRyaWdnZXJlYWJsZU1hcmsgPSB0cmlnZ2VyZWFibGVfbWFyaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghbWFyay5zdGF0ZUVsZW1lbnQgJiYgdHJpZ2dlcmVhYmxlX21hcmsudmFsdWUgPT09IG1hcmsudmFsdWUgJiYgdHJpZ2dlcmVhYmxlX21hcmsub3JpZ2luID09PSBtYXJrLmlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0FueVRyaWdnZXJlYWJsZU1hcmspIHtcbiAgICAgICAgICAgICAgICAgICAgaXNBbnlUcmlnZ2VyZWFibGVNYXJrID0gdHJpZ2dlcmVhYmxlX21hcms7XG4gICAgICAgICAgICAgICAgICAgIGlzQW55VHJpZ2dlcmVhYmxlTWFyay5jdXJyZW50U3RhdGUgPSBcIlBFTkRJTkdcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaXNBbnlUcmlnZ2VyZWFibGVNYXJrO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZSBzdGF0ZSBvZiBsYXN0IG1hcmsgdHJpZ2dlcmVkIHRvIGRvbmUsIHRoaXMgaXMgdXNlZCB0byBnbyBiYWNrXG4gICAgICogQHBhcmFtIHN0YXRlXG4gICAgICogQHJldHVybnMge0FycmF5fVxuICAgICAqL1xuICAgIHVuVHJpZ2dlckxhc3RNYXJrKHN0YXRlKSB7XG4gICAgICAgIGxldCBuZXdfYXJyYXkgPSBzdGF0ZTtcbiAgICAgICAgbmV3X2FycmF5LmZvckVhY2gobWFyaz0+e1xuICAgICAgICAgICAgaWYobWFyay5jdXJyZW50U3RhdGUgPT09ICdUUklHR0VSRUQnKSB7XG4gICAgICAgICAgICAgICAgbWFyay5jdXJyZW50U3RhdGUgPSAnRE9ORSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbmV3X2FycmF5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFucyBWaWV3cyBBcnJheVxuICAgICAqIEBwYXJhbSB0cmlnZ2VyZWRNYXJrc1xuICAgICAqIEBwYXJhbSBhcnJheVZpZXdzXG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgc2FudGluaXplVmlld3NBcnJheSh0cmlnZ2VyZWRNYXJrcywgYXJyYXlWaWV3cykge1xuICAgICAgICBsZXQgZmluYWxfYXJyYXkgPSBhcnJheVZpZXdzO1xuXG4gICAgICAgIHRyaWdnZXJlZE1hcmtzLmZvckVhY2gobWFyaz0+e1xuICAgICAgICAgICAgaWYobWFyay5jdXJyZW50U3RhdGUgPT09IFwiRE9ORVwiICYmIGZpbmFsX2FycmF5LmluZGV4T2YobWFyay5jb25uZWN0aW9uKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBmaW5hbF9hcnJheS5zcGxpY2UoZmluYWxfYXJyYXkuaW5kZXhPZihtYXJrLmNvbm5lY3Rpb24pLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZmluYWxfYXJyYXkgPSBmaW5hbF9hcnJheS5yZXZlcnNlKCkuZmlsdGVyKCh2LCBpLCBhKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYS5pbmRleE9mKHYpID09PSBpIHx8IHYuaW5kZXhPZihcInBhLVwiKSA9PT0gLTE7XG4gICAgICAgIH0pLnJldmVyc2UoKTtcblxuICAgICAgICByZXR1cm4gZmluYWxfYXJyYXk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW5zIHVzZWQgJ0RPTkUnIHZhbHVlcyBpbiB0cmlnZ2VyZWRNYXJrcyBhcnJheVxuICAgICAqIEBwYXJhbSB0cmlnZ2VyZWRfZXZlbnRcbiAgICAgKiBAcGFyYW0gdHJpZ2dlcmVkTWFya3NcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICovXG4gICAgY2xlYXJUcmlnZ2VyZWRWYWx1ZXModHJpZ2dlcmVkX2V2ZW50LCB0cmlnZ2VyZWRNYXJrcykge1xuICAgICAgICBsZXQgY2xlYW5fYXJyYXkgPSBbXTtcblxuICAgICAgICBpZih0cmlnZ2VyZWRNYXJrcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZighdHJpZ2dlcmVkX2V2ZW50LnN0YXRlRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRyaWdnZXJlZE1hcmtzLmZvckVhY2goZWxlbWVudD0+e1xuICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LmN1cnJlbnRTdGF0ZSAhPT0gJ0RPTkUnIHx8IHRyaWdnZXJlZF9ldmVudC5pZCAhPT0gZWxlbWVudC5vcmlnaW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuX2FycmF5LnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyZWRNYXJrcy5mb3JFYWNoKGVsZW1lbnQgPT57XG4gICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQuY3VycmVudFN0YXRlICE9PSBcIkRPTkVcIiB8fCBlbGVtZW50LnZhbHVlID09PSB0cmlnZ2VyZWRfZXZlbnQudmFsdWUgfHwgZWxlbWVudC5vcmlnaW4gIT09IHRyaWdnZXJlZF9ldmVudC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYW5fYXJyYXkucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjbGVhbl9hcnJheTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm92aXNpb25hbCBNZXRob2QgVE9ETzogVmVyaWZ5IGlmIG5lZWRlZFxuICAgICAqIEBwYXJhbSB0cmlnZ2VyZWRfZXZlbnRcbiAgICAgKiBAcGFyYW0gcmljaFN0YXRlc2VsZW1lbnRcbiAgICAgKi9cbiAgICAvLyBjbGVhclN0YXRlRWxlbWVudHModHJpZ2dlcmVkX2V2ZW50LCByaWNoU3RhdGVzZWxlbWVudCkge1xuICAgIC8vICAgICBpZihyaWNoU3RhdGVzZWxlbWVudFt0cmlnZ2VyZWRfZXZlbnQuaWRdICE9PSB1bmRlZmluZWQgJiYgcGFyc2VGbG9hdCh0cmlnZ2VyZWRfZXZlbnQudmFsdWUpID4gcGFyc2VGbG9hdChyaWNoU3RhdGVzZWxlbWVudFt0cmlnZ2VyZWRfZXZlbnQuaWRdKSArIDEpIHtcbiAgICAvLyAgICAgICAgIGxldCBuZXdFbGVtZW50U3RhdGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJpY2hTdGF0ZXNlbGVtZW50KSk7XG4gICAgLy8gICAgICAgICBuZXdFbGVtZW50U3RhdGVbdHJpZ2dlcmVkX2V2ZW50LmlkXSA9IHVuZGVmaW5lZDtcbiAgICAvLyAgICAgICAgIHJldHVybiBuZXdFbGVtZW50U3RhdGU7XG4gICAgLy8gICAgIH1cbiAgICAvL1xuICAgIC8vICAgICByZXR1cm4gcmljaFN0YXRlc2VsZW1lbnQ7XG4gICAgLy8gfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBtYXJrcyB0cmlnZ2VyZWQgaW4gdGhlIHNhbWUgZXZlbnRcbiAgICAgKiBAcGFyYW0gbWFya3NcbiAgICAgKiBAcGFyYW0gdHJpZ2dlcmVkX2V2ZW50XG4gICAgICogQHJldHVybnMge0FycmF5fVxuICAgICAqL1xuICAgIGdldFRyaWdnZXJlZE1hcmtzKG1hcmtzLCB0cmlnZ2VyZWRfZXZlbnQpIHtcbiAgICAgICAgbGV0IHN0YXRlX21hcmtzID0gW107XG4gICAgICAgIGxldCBwcmV2aW91c2x5X3RyaWdnZXJlZF9tYXJrcyA9IHRoaXMuc3RhdGUudHJpZ2dlcmVkTWFya3M7XG4gICAgICAgIGlmKHByZXZpb3VzbHlfdHJpZ2dlcmVkX21hcmtzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbWFya3MuZm9yRWFjaChtYXJrX2VsZW1lbnQ9PntcbiAgICAgICAgICAgICAgICBpZihtYXJrX2VsZW1lbnQudmFsdWUgPT09IHRyaWdnZXJlZF9ldmVudC52YWx1ZSAmJiBtYXJrX2VsZW1lbnQub3JpZ2luID09PSB0cmlnZ2VyZWRfZXZlbnQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVfbWFya3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGU6IFwiUEVORElOR1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld09yaWdpbjogdGhpcy5zdGF0ZS5jdXJyZW50Vmlld1t0aGlzLnN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCAtIDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IG1hcmtfZWxlbWVudC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtYXJrX2VsZW1lbnQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uOiBtYXJrX2VsZW1lbnQuY29ubmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogbWFya19lbGVtZW50Lm9yaWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RNb2RlOiBtYXJrX2VsZW1lbnQuY29ubmVjdE1vZGUsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIC8vIHJldHVybiBvbmx5IHRyaWdnZXJlZCBNQVJLU1xuICAgICAgICAgICAgc3RhdGVfbWFya3MgPSBzdGF0ZV9tYXJrcy5jb25jYXQocHJldmlvdXNseV90cmlnZ2VyZWRfbWFya3MpO1xuXG4gICAgICAgICAgICBtYXJrcy5mb3JFYWNoKHRyaWdnZXJlZF9tYXJrPT57XG4gICAgICAgICAgICAgICAgbGV0IGlzX2RpZmZlcmVudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9yKGxldCBuIGluIHN0YXRlX21hcmtzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHN0YXRlX21hcmtzW25dLnZhbHVlID09PSB0cmlnZ2VyZWRfbWFyay52YWx1ZSAmJiBzdGF0ZV9tYXJrc1tuXS5vcmlnaW4gPT09IHRyaWdnZXJlZF9ldmVudC5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfZGlmZmVyZW50ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZihpc19kaWZmZXJlbnQgJiYgdHJpZ2dlcmVkX2V2ZW50LnZhbHVlID09PSB0cmlnZ2VyZWRfbWFyay52YWx1ZSAmJiB0cmlnZ2VyZWRfZXZlbnQuaWQgPT09IHRyaWdnZXJlZF9tYXJrLm9yaWdpbikge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZV9tYXJrcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZTogXCJQRU5ESU5HXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3T3JpZ2luOiB0aGlzLnN0YXRlLmN1cnJlbnRWaWV3W3RoaXMuc3RhdGUuY3VycmVudFZpZXcubGVuZ3RoIC0gMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogdHJpZ2dlcmVkX21hcmsuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdHJpZ2dlcmVkX21hcmsudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uOiB0cmlnZ2VyZWRfbWFyay5jb25uZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiB0cmlnZ2VyZWRfbWFyay5vcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0TW9kZTogdHJpZ2dlcmVkX21hcmsuY29ubmVjdE1vZGUsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RhdGVfbWFya3M7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBNYXJrIG9mIGN1cnJlbnRWaWV3XG4gICAgICogQHJldHVybnMge0FycmF5fVxuICAgICAqL1xuICAgIGdldEFsbE1hcmtzKCkge1xuICAgICAgICBsZXQgY3VycmVudFZpZXcgPSB0aGlzLnN0YXRlLmN1cnJlbnRWaWV3W3RoaXMuc3RhdGUuY3VycmVudFZpZXcubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgbGV0IGJveGVzID0gdGhpcy5nZXRBbGxSaWNoRGVzY2VuZGFudEJveGVzKGN1cnJlbnRWaWV3KTtcbiAgICAgICAgbGV0IG1hcmtzID0gW107XG4gICAgICAgIE9iamVjdC5rZXlzKEVkaXBoeS5TdGF0ZS5tYXJrc0J5SWQpLmZvckVhY2gobWFyaz0+e1xuICAgICAgICAgICAgYm94ZXMuaW5jbHVkZXMoRWRpcGh5LlN0YXRlLm1hcmtzQnlJZFttYXJrXS5vcmlnaW4pO1xuICAgICAgICAgICAgbWFya3MucHVzaChFZGlwaHkuU3RhdGUubWFya3NCeUlkW21hcmtdKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBtYXJrcztcbiAgICB9XG5cbiAgICBwdXRNYXJrc09uSG9sZCh0cmlnZ2VyZWRfbWFya3MpIHtcbiAgICAgICAgbGV0IGFueVRyaWdnZXJlZE1hcmtzID0gZmFsc2U7XG4gICAgICAgIGxldCBhbnlQZW5kaW5nTWFya3MgPSBmYWxzZTtcblxuICAgICAgICB0cmlnZ2VyZWRfbWFya3MuZm9yRWFjaCh0X21hcms9PntcbiAgICAgICAgICAgIGlmKHRfbWFyay5jdXJyZW50U3RhdGUgPT09IFwiUEVORElOR1wiKSB7XG4gICAgICAgICAgICAgICAgYW55UGVuZGluZ01hcmtzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHRfbWFyay5jdXJyZW50U3RhdGUgPT09IFwiVFJJR0dFUkVEXCIpIHtcbiAgICAgICAgICAgICAgICBhbnlUcmlnZ2VyZWRNYXJrcyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBvcmlnaW5fbWFya3MgPSBbXTtcbiAgICAgICAgbGV0IG1hcmtVbnRyaWdnZXJlZCA9IGZhbHNlO1xuICAgICAgICBpZihhbnlUcmlnZ2VyZWRNYXJrcyAmJiBhbnlQZW5kaW5nTWFya3MpIHtcbiAgICAgICAgICAgIHRyaWdnZXJlZF9tYXJrcy5mb3JFYWNoKHRfbWFyayA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRfbWFyay52aWV3T3JpZ2luICE9PSB1bmRlZmluZWQgJiYgdF9tYXJrLmN1cnJlbnRTdGF0ZSA9PT0gJ0hPTEQnKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbl9tYXJrcy5wdXNoKHRfbWFyay52aWV3T3JpZ2luKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodF9tYXJrLmN1cnJlbnRTdGF0ZSA9PT0gJ1RSSUdHRVJFRCcgJiYgdF9tYXJrLnZpZXdPcmlnaW4gIT09IHVuZGVmaW5lZCAmJiBvcmlnaW5fbWFya3MuaW5kZXhPZih0X21hcmsudmlld09yaWdpbikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbl9tYXJrcy5wdXNoKHRfbWFyay52aWV3T3JpZ2luKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdHJpZ2dlcmVkX21hcmtzLmZvckVhY2godF9tYXJrPT57XG4gICAgICAgICAgICAgICAgaWYgKHRfbWFyay5jdXJyZW50U3RhdGUgPT09ICdQRU5ESU5HJyAmJiB0X21hcmsudmlld09yaWdpbiAhPT0gdW5kZWZpbmVkICYmIG9yaWdpbl9tYXJrcy5pbmRleE9mKHRfbWFyay52aWV3T3JpZ2luKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya1VudHJpZ2dlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYobWFya1VudHJpZ2dlcmVkKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5ld01hcmtzQXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyZWRfbWFya3MuZm9yRWFjaCh0X21hcms9PntcbiAgICAgICAgICAgICAgICAgICAgaWYodF9tYXJrLmN1cnJlbnRTdGF0ZSA9PT0gJ1RSSUdHRVJFRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRfbWFyay5jdXJyZW50U3RhdGUgPSAnSE9MRCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV3TWFya3NBcnJheS5wdXNoKHRfbWFyayk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld01hcmtzQXJyYXk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJpZ2dlcmVkX21hcmtzO1xuXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJpZ2dlcmVkX21hcmtzO1xuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIG5hdkl0ZW1JRFxuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKi9cbiAgICBnZXRBbGxSaWNoRGVzY2VuZGFudEJveGVzKG5hdkl0ZW1JRCkge1xuICAgICAgICBsZXQgdmlldyA9IEVkaXBoeS5TdGF0ZS5uYXZJdGVtc0J5SWRbbmF2SXRlbUlEXTtcbiAgICAgICAgaWYgKGlzQ29udGFpbmVkVmlldyhuYXZJdGVtSUQpKSB7XG4gICAgICAgICAgICB2aWV3ID0gRWRpcGh5LlN0YXRlLmNvbnRhaW5lZFZpZXdzQnlJZFtuYXZJdGVtSURdO1xuICAgICAgICB9XG4gICAgICAgIGxldCBib3hlcyA9IHZpZXcuYm94ZXM7XG4gICAgICAgIGxldCBuZXdCb3hlcyA9IFtdO1xuXG4gICAgICAgIGxldCByaWNoQm94ZXMgPSBbXTtcbiAgICAgICAgT2JqZWN0LmtleXMoRWRpcGh5LlN0YXRlLmJveGVzQnlJZCkubWFwKGJveD0+e1xuXG4gICAgICAgICAgICBpZihib3hlcy5pbmRleE9mKGJveCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgbmV3Qm94ZXMucHVzaChib3gpO1xuXG4gICAgICAgICAgICAgICAgaWYoT2JqZWN0LmtleXMoRWRpcGh5LlN0YXRlLmJveGVzQnlJZFtib3hdLmNoaWxkcmVuKS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoRWRpcGh5LlN0YXRlLmJveGVzQnlJZFtib3hdLnNvcnRhYmxlQ29udGFpbmVycykubWFwKHNlY29uZF9ib3g9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0JveGVzID0gbmV3Qm94ZXMuY29uY2F0KEVkaXBoeS5TdGF0ZS5ib3hlc0J5SWRbYm94XS5zb3J0YWJsZUNvbnRhaW5lcnNbc2Vjb25kX2JveF0uY2hpbGRyZW4pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ld0JveGVzLmZvckVhY2goZmluYWw9PntcbiAgICAgICAgICAgIGlmIChFZGlwaHkuU3RhdGUucGx1Z2luVG9vbGJhcnNCeUlkW2ZpbmFsXVxuICAgICAgICAgICAgICAgICYmIEVkaXBoeS5TdGF0ZS5wbHVnaW5Ub29sYmFyc0J5SWRbZmluYWxdLnBsdWdpbklkXG4gICAgICAgICAgICAgICAgJiYgRWRpcGh5LlN0YXRlLnBsdWdpblRvb2xiYXJzQnlJZFtmaW5hbF0ucGx1Z2luSWQgIT09IFwic29ydGFibGVfY29udGFpbmVyXCJcbiAgICAgICAgICAgICAgICAmJiBFZGlwaHkuVmlzb3IuUGx1Z2luc1tFZGlwaHkuU3RhdGUucGx1Z2luVG9vbGJhcnNCeUlkW2ZpbmFsXS5wbHVnaW5JZF0uZ2V0Q29uZmlnKCkuaXNSaWNoKSB7XG4gICAgICAgICAgICAgICAgcmljaEJveGVzLnB1c2goZmluYWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJpY2hCb3hlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgc3RhdGUgZm9yIHNlbGVjdGVkIGJveFxuICAgICAqIEBwYXJhbSBiYWNrdXBcbiAgICAgKiBAcGFyYW0gY3VycmVudFxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGdldEFjdHVhbEJveGVzU3RhdGVzKGJhY2t1cCwgY3VycmVudCkge1xuICAgICAgICBsZXQgbmV4dFN0YXRlID0gYmFja3VwO1xuICAgICAgICBuZXh0U3RhdGVbdGhpcy5zdGF0ZS50cmlnZ2VyZWRNYXJrc1swXS5vcmlnaW5dID0gY3VycmVudFt0aGlzLnN0YXRlLnRyaWdnZXJlZE1hcmtzWzBdLm9yaWdpbl07XG4gICAgICAgIHJldHVybiBuZXh0U3RhdGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGV0ZWN0cyBpZiBlbGVtZW50IGlzIG5vdCBhbHJlYWR5IGluIHN0YXRlIEVsZW1lbnQgc28gaXRzIGFscmVhZHkgdHJpZ2dlcmVkXG4gICAgICogQHBhcmFtIHRyaWdnZXJlZF9ldmVudFxuICAgICAqIEBwYXJhbSByaWNoRWxlbWVudHNTdGF0ZVxuICAgICAqXG4gICAgICovXG4gICAgaXNOb3RJblN0YXRlRWxlbWVudCh0cmlnZ2VyZWRfZXZlbnQsIHJpY2hFbGVtZW50c1N0YXRlKSB7XG4gICAgICAgIGlmKHJpY2hFbGVtZW50c1N0YXRlW3RyaWdnZXJlZF9ldmVudC5pZF0gPT09IHRyaWdnZXJlZF9ldmVudC52YWx1ZSkge1xuICAgICAgICAgICAgLy8gcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgbGFzdCB2aWV3IGZyb20gcXVldWUgb2Ygdmlld3NcbiAgICAgKi9cbiAgICByZW1vdmVMYXN0VmlldyA9ICgpID0+IHtcbiAgICAgICAgbGV0IG5ld1ZpZXdzID0gdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5zbGljZSgwLCAtMSk7XG4gICAgICAgIGlmIChuZXdWaWV3cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgbGFzdFZpZXcgPSBuZXdWaWV3c1tuZXdWaWV3cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGlmIChsYXN0Vmlldy5pbmRleE9mKFwiY3YtXCIpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb250YWluZWRWaWV3U2VsZWN0ZWQ6IDAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBjdXJyZW50VmlldzogbmV3Vmlld3MsXG4gICAgICAgICAgICB0cmlnZ2VyZWRNYXJrczogdGhpcy51blRyaWdnZXJMYXN0TWFyayh0aGlzLnN0YXRlLnRyaWdnZXJlZE1hcmtzKSxcbiAgICAgICAgICAgIHJpY2hFbGVtZW50U3RhdGU6IHRoaXMuZ2V0QWN0dWFsQm94ZXNTdGF0ZXModGhpcy5zdGF0ZS5iYWNrdXBFbGVtZW50U3RhdGVzLCB0aGlzLnN0YXRlLnJpY2hFbGVtZW50U3RhdGUpLFxuICAgICAgICB9KTtcbiAgICB9XG5cbn1cblxuUmVhY3RET00ucmVuZGVyKCg8Vmlzb3IgLz4pLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL192aXNvci9jb250YWluZXJzL1Zpc29yQXBwLmpzeCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7O0FBR0E7Ozs7O0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFGQTtBQStEQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBakVBO0FBbUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFyRUE7QUF1RUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5GQTtBQWlaQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQTFiQTtBQW12QkE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUE3dkJBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBQ0E7QUFhQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBM0RBO0FBNERBO0FBQ0E7OztBQXVCQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QkE7QUF5QkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQVlBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFEQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQWRBO0FBbUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQVJBO0FBU0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBTkE7QUFPQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBUkE7QUFlQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBREE7QUFFQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQTZDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7O0FBaHZCQTtBQUNBO0FBREE7QUFvd0JBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2674\n");

/***/ })

})