webpackHotUpdate(1,{

/***/ 2674:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* WEBPACK VAR INJECTION */(function(global) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Visor; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__reducers_serializer__ = __webpack_require__(301);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react_dom__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_react_bootstrap__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__components_canvas_VisorCanvas__ = __webpack_require__(1084);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__components_canvas_VisorContainedCanvas__ = __webpack_require__(1088);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__components_navigation_VisorSideNav__ = __webpack_require__(2675);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__components_navigation_VisorPlayer__ = __webpack_require__(2678);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__common_utils__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__components_score_GradeComponent__ = __webpack_require__(2684);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__locales_i18n__ = __webpack_require__(1061);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_typeface_ubuntu__ = __webpack_require__(2688);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_typeface_ubuntu___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_11_typeface_ubuntu__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_typeface_source_sans_pro__ = __webpack_require__(2705);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_typeface_source_sans_pro___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_12_typeface_source_sans_pro__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__trendmicro_react_toggle_switch_dist_react_toggle_switch_css__ = __webpack_require__(585);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__trendmicro_react_toggle_switch_dist_react_toggle_switch_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_13__trendmicro_react_toggle_switch_dist_react_toggle_switch_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__sass_style_scss__ = __webpack_require__(1157);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__sass_style_scss___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_14__sass_style_scss__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__core_visor_visorEntrypoint__ = __webpack_require__(2730);\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nif (global && !global._babelPolyfill) {\n  __webpack_require__(2734);\n}\n\n__webpack_require__(2053).polyfill();\n/**\n * Visor app main component\n */\n\n\nvar Visor =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Visor, _Component);\n\n  function Visor(props) {\n    var _this;\n\n    _classCallCheck(this, Visor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Visor).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"setHoverClass\", function () {\n      _this.setState({\n        mouseOnPlayer: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteHoverClass\", function () {\n      _this.setState({\n        mouseOnPlayer: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_onMouseMove\", function () {\n      if (!_this.state.mouseMoving) {\n        _this.setState({\n          mouseMoving: true\n        });\n      } else {\n        if (_this.timer) {\n          clearTimeout(_this.timer);\n        }\n\n        _this.timer = setTimeout(function () {\n          _this.setState({\n            mouseMoving: false\n          });\n        }, 2500);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onMarkClicked\", function (id, value, stateElement) {\n      var richElementState = _this.state.richElementState;\n\n      var marks = _this.getAllMarks();\n\n      var triggered_event = {\n        id: id,\n        value: value,\n        stateElement: stateElement\n      };\n\n      var triggered_marks = _this.getTriggeredMarks(marks, triggered_event); // clearMark | If actual Triggered Mark have passed e.detail.value and actual value is different or actual element doesn't need to clear the value\n\n\n      triggered_marks = _this.clearTriggeredValues(triggered_event, triggered_marks); // Just try to trigger if mark exists\n\n      if (_this.containsMarkValue(marks, triggered_event.value)) {\n        // And is triggereable (not pending)\n        var isTriggerable = _this.isTriggereableMark(triggered_event, triggered_marks);\n\n        if (isTriggerable) {\n          triggered_marks = _this.putMarksOnHold(triggered_marks, triggered_event); // If mark is storable (if make any sense to store to render something different like a video) do it, else don't\n\n          if (triggered_event.stateElement) {\n            if (_this.isNotInStateElement(triggered_event, _this.state.richElementState)) {\n              var new_mark = {};\n              new_mark[triggered_event.id] = triggered_event.value;\n\n              _this.setState({\n                triggeredMarks: triggered_marks,\n                richElementState: Object.assign({}, richElementState, new_mark)\n              });\n            }\n          } else {\n            triggered_marks.forEach(function (mark, index) {\n              if (mark.id === isTriggerable.id) {\n                triggered_marks[index] = isTriggerable;\n              }\n            });\n\n            _this.setState({\n              triggeredMarks: triggered_marks\n            });\n          }\n        }\n      } else if (triggered_event.stateElement) {\n        var backupElementStates = _this.state.backupElementStates;\n        var _new_mark = {};\n        _new_mark[triggered_event.id] = triggered_event.value;\n\n        _this.setState({\n          backupElementStates: Object.assign({}, backupElementStates, _new_mark)\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"removeLastView\", function () {\n      var newViews = _this.state.currentView.slice(0, -1);\n\n      if (newViews.length > 0) {\n        var lastView = newViews[newViews.length - 1];\n\n        if (lastView.indexOf(\"cv-\") === -1) {\n          _this.setState({\n            containedViewSelected: 0\n          });\n        }\n      }\n\n      _this.setState({\n        currentView: newViews,\n        triggeredMarks: _this.unTriggerLastMark(_this.state.triggeredMarks),\n        richElementState: _this.getActualBoxesStates(_this.state.backupElementStates, _this.state.richElementState)\n      });\n    });\n\n    var initialView = _this.getCurrentView(Ediphy.State.navItemSelected, Ediphy.State.containedViewSelected);\n\n    if (!Ediphy.State.preview) {\n      var remainingViews = Ediphy.State.navItemsIds.filter(function (n) {\n        var nav = Ediphy.State.navItemsById[n];\n        var returnIt = Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"J\" /* isSection */])(nav.id) ? Ediphy.Config.sections_have_content : true;\n        returnIt = returnIt && !nav.hidden;\n        return returnIt ? nav.id : null;\n      });\n\n      if (remainingViews.length > 0) {\n        initialView = remainingViews[0];\n      }\n    }\n\n    _this.timer = false;\n    _this.state = {\n      currentView: [initialView],\n\n      /* This is the actual view rendering*/\n      triggeredMarks: [],\n      showpop: false,\n      richElementState: {},\n      backupElementStates: {},\n      toggledSidebar: false,\n      // Ediphy.State.globalConfig.visorNav.sidebar ? Ediphy.State.globalConfig.visorNav.sidebar : (Ediphy.State.globalConfig.visorNav.sidebar === undefined),\n      fromScorm: Ediphy.State.fromScorm,\n      scoreInfo: {\n        userName: \"Anonymous\",\n        totalScore: 0,\n        totalWeight: 0,\n        completionProgress: 0\n      },\n      mouseMoving: false,\n      mouseOnPlayer: false,\n      backwards: false\n    };\n\n    if (!Ediphy.State[\"export\"]) {\n      window[\"export\"] = function () {\n        var format = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'HTML';\n\n        switch (format) {\n          case 'SCORM12':\n            _this.exportToScorm(false, function () {\n              return true;\n            }, false);\n\n            return true;\n\n          case 'SCORM2004':\n            _this.exportToScorm(true, function () {\n              return true;\n            }, false);\n\n            return true;\n\n          case 'HTML':\n            _this.exportToScorm('HTML', function () {\n              return true;\n            }, false);\n\n            return true;\n\n          default:\n            return false;\n        }\n      };\n    }\n\n    fetch(Ediphy.Config.theme_css_url) // Webpack output CSS\n    .then(function (res) {\n      if (!res.ok) {\n        throw new Error('Error');\n      }\n\n      return res.text();\n    }).then(function (data) {\n      window.theme_css = data;\n    })[\"catch\"](function () {\n      return '';\n    });\n    return _this;\n  }\n\n  _createClass(Visor, [{\n    key: \"UNSAFE_componentWillUpdate\",\n    value: function UNSAFE_componentWillUpdate(nextProps, nextState) {\n      var _this2 = this;\n\n      // reset marks when navigating between main sections\n      if (this.state.currentView.length !== nextState.currentView.length && Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"P\" /* isView */])(nextState.currentView[nextState.currentView.length - 1])) {\n        this.setState({\n          triggeredMarks: []\n        });\n      }\n\n      if (this.state.currentView.length > 1 && this.state.currentView.filter(function (i) {\n        return i.indexOf(\"pa-\") !== -1;\n      }).length > 1) {\n        this.setState({\n          currentView: [this.state.currentView[this.state.currentView.length - 1]]\n        });\n      } // Mark triggering mechanism\n\n\n      if (nextState.triggeredMarks.length !== 0 && this.returnTriggereableMark(nextState.triggeredMarks)) {\n        var newMark = this.returnTriggereableMark(nextState.triggeredMarks);\n        nextState.triggeredMarks.forEach(function (mark) {\n          if (newMark.id === mark.id) {\n            mark.currentState = 'TRIGGERED';\n            mark.viewOrigin = _this2.state.currentView[_this2.state.currentView.length - 1];\n          }\n\n          return mark;\n        }); // New or existing mark\n\n        if (newMark.connectMode === 'new' || newMark.connectMode === \"existing\") {\n          var array_trigger_mark = this.santinizeViewsArray(nextState.triggeredMarks, nextState.currentView.concat([newMark.connection]));\n          var newcv = array_trigger_mark.length > 0 && array_trigger_mark[array_trigger_mark.length - 1] && Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(array_trigger_mark[array_trigger_mark.length - 1]) ? array_trigger_mark[array_trigger_mark.length - 1] : 0;\n          this.setState({\n            containedViewSelected: newcv,\n            currentView: array_trigger_mark,\n            triggeredMarks: nextState.triggeredMarks\n          }); // External target\n        } else if (newMark.connectMode === \"external\") {\n          var win = window.open(newMark.connection, '_blank');\n          win.focus();\n          var shiftExternal = nextState.triggeredMarks;\n          shiftExternal.shift();\n          this.setState({\n            triggeredMarks: shiftExternal\n          });\n        } else if (newMark.connectMode === \"popup\") {\n          var shiftPop = nextState.triggeredMarks;\n          shiftPop.shift();\n          var markpop = document.getElementById('mark-' + newMark.id);\n\n          if (markpop) {\n            markpop.click();\n          }\n\n          this.setState({\n            showpop: !this.state.showpop,\n            triggeredMarks: shiftPop\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      /*\n      * Add Key bindings to app\n      * */\n      if (Ediphy.State.globalConfig.visorNav.keyBindings) {\n        // First get window focus so arrows work right away\n        window.focus();\n\n        window.onkeyup = function (e) {\n          var key = e.keyCode ? e.keyCode : e.which;\n          var navItemsIds = Ediphy.State.navItemsIds;\n          var navItems = Ediphy.State.navItemsById;\n\n          if (!Ediphy.Config.sections_have_content) {\n            navItemsIds = navItemsIds.filter(function (element) {\n              return element.indexOf(\"se\") === -1;\n            });\n          }\n\n          navItemsIds = navItemsIds.filter(function (nav) {\n            return !navItems[nav].hidden;\n          });\n          var navItemSelected = this.state.currentView.reduce(function (element) {\n            if (Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"I\" /* isPage */])(element)) {\n              return element;\n            }\n\n            return null;\n          });\n          var index = navItemsIds.indexOf(navItemSelected);\n          var maxIndex = navItemsIds.length;\n          var focusElement = document.activeElement.tagName.toLowerCase();\n\n          if (focusElement !== 'input' && focusElement !== 'textarea') {\n            if (key === 37 || key === 33) {\n              this.changeCurrentView(navItemsIds[Math.max(index - 1, 0)], true);\n            } else if (key === 39 || key === 34) {\n              this.changeCurrentView(navItemsIds[Math.min(index + 1, maxIndex - 1)]);\n            }\n          }\n        }.bind(this);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (window.State) {\n        Ediphy.State = Object(__WEBPACK_IMPORTED_MODULE_0__reducers_serializer__[\"c\" /* serialize */])({\n          \"present\": _objectSpread({}, window.State)\n        }).present;\n      }\n\n      var _Ediphy$State = Ediphy.State,\n          navItemsIds = _Ediphy$State.navItemsIds,\n          globalConfig = _Ediphy$State.globalConfig,\n          _Ediphy$State$styleCo = _Ediphy$State.styleConfig,\n          styleConfig = _Ediphy$State$styleCo === void 0 ? {} : _Ediphy$State$styleCo,\n          containedViewsById = _Ediphy$State.containedViewsById,\n          boxesById = _Ediphy$State.boxesById,\n          marksById = _Ediphy$State.marksById,\n          navItemsById = _Ediphy$State.navItemsById,\n          viewToolbarsById = _Ediphy$State.viewToolbarsById,\n          pluginToolbarsById = _Ediphy$State.pluginToolbarsById;\n      var ediphy_document_id = Ediphy.State.id;\n      var ediphy_platform = Ediphy.State.platform;\n      var exercises = {};\n      Object.keys(Ediphy.State.exercises).map(function (exercise) {\n        if (containedViewsById[exercise] || navItemsById[exercise] && !navItemsById[exercise].hidden) {\n          exercises[exercise] = Ediphy.State.exercises[exercise];\n        }\n      });\n      var title = globalConfig.title;\n      var ratio = globalConfig.canvasRatio;\n      var visorNav = globalConfig.visorNav;\n      var wrapperClasses = this.state.toggledSidebar ? \"visorwrapper toggled\" : \"visorwrapper\";\n      var toggleIcon = this.state.toggledSidebar ? \"keyboard_arrow_left\" : \"keyboard_arrow_right\";\n      var toggleColor = this.state.toggledSidebar ? \"toggleColor\" : \"\";\n      var isCV = Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(this.state.currentView);\n      var isSlide = isCV && containedViewsById[this.getLastCurrentViewElement()] === \"slide\" || !isCV && navItemsById[this.getLastCurrentViewElement()] === \"slide\" ? \"pcw_slide\" : \"pcw_doc\";\n      var vishPlayer = globalConfig.visorNav && globalConfig.visorNav.fixedPlayer !== undefined ? globalConfig.visorNav.fixedPlayer : true;\n      var currentView = this.getLastCurrentViewElement();\n      var canvasProps = {\n        boxes: boxesById,\n        changeCurrentView: function changeCurrentView(element) {\n          _this3.changeCurrentView(element);\n        },\n        canvasRatio: ratio,\n        containedViews: containedViewsById,\n        currentView: currentView,\n        fromScorm: this.state.fromScorm,\n        navItems: navItemsById,\n        navItemsIds: navItemsIds,\n        removeLastView: this.removeLastView,\n        richElementState: this.state.richElementState,\n        title: title,\n        marks: marksById,\n        viewToolbars: viewToolbarsById,\n        pluginToolbars: pluginToolbarsById,\n        onMarkClicked: this.onMarkClicked,\n        triggeredMarks: this.state.triggeredMarks,\n        viewsArray: this.state.currentView,\n        exportModalOpen: false,\n        ediphy_document_id: ediphy_document_id,\n        ediphy_platform: ediphy_platform,\n        exercises: exercises,\n        styleConfig: styleConfig\n      };\n      var navItemComponents = Object.keys(navItemsById).filter(function (nav) {\n        return Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"I\" /* isPage */])(nav);\n      }).map(function (nav, i) {\n        return __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_4__components_canvas_VisorCanvas__[\"a\" /* default */], _extends({\n          key: i\n        }, canvasProps, {\n          selectedView: currentView,\n          backwards: _this3.state.backwards,\n          currentView: nav,\n          show: nav === currentView,\n          z: i + 10,\n          showCanvas: nav.indexOf(\"cv-\") === -1\n        }));\n      });\n      var cvComponents = Object.keys(containedViewsById).map(function (nav, i) {\n        return __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_5__components_canvas_VisorContainedCanvas__[\"a\" /* default */], _extends({\n          key: i\n        }, canvasProps, {\n          currentView: nav,\n          show: nav === currentView,\n          z: i + navItemComponents.length,\n          showCanvas: nav.indexOf(\"cv-\") !== -1\n        }));\n      });\n      var content = [].concat(_toConsumableArray(navItemComponents), [cvComponents]);\n      var empty = __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        className: \"emptyPresentation\"\n      }, __WEBPACK_IMPORTED_MODULE_10__locales_i18n__[\"a\" /* default */].t(\"EmptyPresentation\"));\n      var visorNavButtonClass = 'hoverPlayerSelector';\n      visorNavButtonClass = this.state.mouseMoving ? visorNavButtonClass + ' appearButton' : visorNavButtonClass + ' fadeButton';\n      visorNavButtonClass = this.state.mouseOnPlayer ? visorNavButtonClass + ' hoverPlayerOn' : visorNavButtonClass;\n      return __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        id: \"app\",\n        ref: 'app',\n        className: wrapperClasses,\n        onMouseMove: this._onMouseMove\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_6__components_navigation_VisorSideNav__[\"a\" /* default */], {\n        changeCurrentView: function changeCurrentView(page) {\n          _this3.changeCurrentView(page);\n        },\n        courseTitle: title,\n        show: visorNav.sidebar,\n        showScore: !globalConfig.hideGlobalScore,\n        currentViews: this.state.currentView,\n        navItemsById: navItemsById,\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        }),\n        viewToolbars: viewToolbarsById,\n        scoreInfo: this.state.scoreInfo,\n        exercises: exercises,\n        toggled: this.state.toggledSidebar\n      }), __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        id: \"page-content-wrapper\",\n        className: isSlide + \" page-content-wrapper\",\n        style: {\n          height: '100%'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"l\" /* Grid */], {\n        fluid: true,\n        id: \"visorAppContent\",\n        style: {\n          height: '100%'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"y\" /* Row */], {\n        style: {\n          height: vishPlayer ? 'calc(100% - 38px)' : '100%'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"e\" /* Col */], {\n        lg: 12,\n        style: {\n          height: '100%',\n          paddingLeft: '0px',\n          paddingRight: '0px'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_9__components_score_GradeComponent__[\"a\" /* default */], {\n        fadePlayerClass: visorNavButtonClass,\n        setHover: this.setHoverClass,\n        deleteHover: this.deleteHoverClass,\n        updateScore: function updateScore(scoreInfo) {\n          _this3.setState({\n            scoreInfo: scoreInfo\n          });\n        },\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        }),\n        containedViews: containedViewsById,\n        currentView: currentView,\n        navItemsById: navItemsById,\n        globalConfig: globalConfig,\n        styleConfig: styleConfig,\n        exercises: exercises,\n        pluginToolbars: pluginToolbarsById,\n        fromScorm: this.state.fromScorm,\n        changeCurrentView: function changeCurrentView(el) {\n          _this3.changeCurrentView(el);\n        }\n      }, currentView ? content : empty), !vishPlayer ? __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7__components_navigation_VisorPlayer__[\"a\" /* default */], {\n        fadePlayerClass: visorNavButtonClass,\n        setHover: this.setHoverClass,\n        deleteHover: this.deleteHoverClass,\n        show: visorNav.player,\n        changeCurrentView: function changeCurrentView(page, backwards) {\n          _this3.changeCurrentView(page, backwards);\n        },\n        currentViews: this.state.currentView,\n        navItemsById: navItemsById,\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        })\n      }) : null, visorNav.sidebar ? __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"div\", {\n        className: \"visorNavButtonDiv\",\n        onMouseEnter: function onMouseEnter() {\n          return _this3.setHoverClass();\n        },\n        onMouseLeave: function onMouseLeave() {\n          return _this3.deleteHoverClass();\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"c\" /* Button */], {\n        id: \"visorNavButton\",\n        className: toggleColor + visorNavButtonClass,\n        bsStyle: \"primary\",\n        onClick: function onClick() {\n          _this3.setState({\n            toggledSidebar: !_this3.state.toggledSidebar\n          });\n\n          document.activeElement.blur();\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(\"i\", {\n        className: \"material-icons\"\n      }, toggleIcon))) : null)), __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"y\" /* Row */], {\n        style: {\n          height: '38px',\n          display: vishPlayer ? 'block' : 'none'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_bootstrap__[\"e\" /* Col */], {\n        lg: 12,\n        style: {\n          height: '100%',\n          paddingLeft: '0px',\n          paddingRight: '0px'\n        }\n      }, __WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7__components_navigation_VisorPlayer__[\"a\" /* default */], {\n        fadePlayerClass: \"appearButton\",\n        setHover: this.setHoverClass,\n        deleteHover: this.deleteHoverClass,\n        show: visorNav.player,\n        changeCurrentView: function changeCurrentView(page, backwards) {\n          _this3.changeCurrentView(page, backwards);\n        },\n        currentViews: this.state.currentView,\n        navItemsById: navItemsById,\n        navItemsIds: navItemsIds.filter(function (nav) {\n          return !navItemsById[nav].hidden;\n        })\n      }))))));\n    }\n    /**\n     * Export to HTML or PDF\n     * @param format\n     * @param callback\n     * @param options\n     */\n\n  }, {\n    key: \"export\",\n    value: function _export(format, callback) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (format === \"PDF\") {\n        printToPDF(Ediphy.State, callback, options);\n      } else {\n        Ediphy.Visor.exportsHTML(Ediphy.State, callback, options);\n      }\n    }\n  }, {\n    key: \"exportToScorm\",\n    value: function exportToScorm(is2004, callback) {\n      var selfContained = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      Ediphy.Visor.exportScorm(Ediphy.State, is2004, callback, selfContained);\n    }\n    /**\n     * Get actualView REFACTOR: change name\n     * @returns {String} currentView\n     */\n\n  }, {\n    key: \"getLastCurrentViewElement\",\n    value: function getLastCurrentViewElement() {\n      return this.state.currentView[this.state.currentView.length - 1];\n    }\n    /**\n     * Navigation main method\n     * @param {string} element - current Element to go\n     */\n\n  }, {\n    key: \"changeCurrentView\",\n    value: function changeCurrentView(element) {\n      var backwards = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(element)) {\n        this.setState({\n          currentView: [this.getCurrentView(this.state.navItemSelected, this.state.containedViewSelected), element],\n          backwards: backwards\n        });\n      } else {\n        this.setState({\n          currentView: [element],\n          backwards: backwards\n        });\n\n        if (this.state.currentView.length > 1) {\n          this.setState({\n            triggeredMarks: this.unTriggerLastMark(this.state.triggeredMarks),\n            richElementState: this.getActualBoxesStates(this.state.backupElementStates, this.state.richElementState),\n            backwards: backwards\n          });\n        }\n      }\n    }\n    /**\n     * This is used to get initial view and make sure is either containedView or NavItem\n     * @param NIselected\n     * @param CVselected\n     */\n\n  }, {\n    key: \"getCurrentView\",\n    value: function getCurrentView(NIselected, CVselected) {\n      var navItemSelected = 0;\n\n      if (Ediphy.State.navItemsById[NIselected] && !Ediphy.State.navItemsById[NIselected].hidden) {\n        navItemSelected = NIselected;\n      }\n\n      return CVselected === 0 ? navItemSelected : CVselected;\n    }\n    /* Marks functions*/\n\n    /**\n     * Make sure if mark value exists\n     * @return {boolean} -  whether the mark exists or not in the array\n     * @param marks\n     * @param mark_value\n     */\n\n  }, {\n    key: \"containsMarkValue\",\n    value: function containsMarkValue(marks, mark_value) {\n      var exists = false;\n      marks.forEach(function (mark_element) {\n        if (mark_element.value === mark_value) {\n          exists = true;\n        }\n      });\n      return exists;\n    }\n  }, {\n    key: \"returnTriggereableMark\",\n\n    /**\n     * Returns if any is there any triggerable mark\n     * @param triggeredMarks\n     * @returns Object Marks that are triggered\n     */\n    value: function returnTriggereableMark(triggeredMarks) {\n      var isAnyTriggereableMark = false;\n      var canBeTriggered = true;\n\n      if (Array.isArray(triggeredMarks)) {\n        triggeredMarks.forEach(function (mark) {\n          if (mark.currentState === 'TRIGGERED') {\n            canBeTriggered = false;\n          }\n\n          if (canBeTriggered && mark.currentState === 'PENDING' && !isAnyTriggereableMark) {\n            isAnyTriggereableMark = mark;\n          }\n        });\n      }\n\n      return isAnyTriggereableMark;\n    }\n    /**\n     * Whether if the mark is triggereable or not\n     * @param mark\n     * @param triggerable_marks\n     * @returns {boolean}\n     */\n\n  }, {\n    key: \"isTriggereableMark\",\n    value: function isTriggereableMark(mark, triggerable_marks) {\n      var isAnyTriggereableMark = false;\n      triggerable_marks.forEach(function (triggereable_mark) {\n        if (triggereable_mark.currentState === 'PENDING' && triggereable_mark.value === mark.value && triggereable_mark.origin === mark.id) {\n          if (!isAnyTriggereableMark) {\n            isAnyTriggereableMark = triggereable_mark;\n          }\n        }\n\n        if (!mark.stateElement && triggereable_mark.value === mark.value && triggereable_mark.origin === mark.id) {\n          if (!isAnyTriggereableMark) {\n            isAnyTriggereableMark = triggereable_mark;\n            isAnyTriggereableMark.currentState = \"PENDING\";\n          }\n        }\n      });\n      return isAnyTriggereableMark;\n    }\n    /**\n     * Change state of last mark triggered to done, this is used to go back\n     * @param state\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"unTriggerLastMark\",\n    value: function unTriggerLastMark(state) {\n      var new_array = state;\n      new_array.forEach(function (mark) {\n        if (mark.currentState === 'TRIGGERED') {\n          mark.currentState = 'DONE';\n        }\n      });\n      return new_array;\n    }\n    /**\n     * Cleans Views Array\n     * @param triggeredMarks\n     * @param arrayViews\n     * @returns {*}\n     */\n\n  }, {\n    key: \"santinizeViewsArray\",\n    value: function santinizeViewsArray(triggeredMarks, arrayViews) {\n      var final_array = arrayViews;\n      triggeredMarks.forEach(function (mark) {\n        if (mark.currentState === \"DONE\" && final_array.indexOf(mark.connection) !== -1) {\n          final_array.splice(final_array.indexOf(mark.connection), 1);\n        }\n      });\n      final_array = final_array.reverse().filter(function (v, i, a) {\n        return a.indexOf(v) === i || v.indexOf(\"pa-\") === -1;\n      }).reverse();\n      return final_array;\n    }\n    /**\n     * Cleans used 'DONE' values in triggeredMarks array\n     * @param triggered_event\n     * @param triggeredMarks\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"clearTriggeredValues\",\n    value: function clearTriggeredValues(triggered_event, triggeredMarks) {\n      var clean_array = [];\n\n      if (triggeredMarks.length > 0) {\n        if (!triggered_event.stateElement) {\n          triggeredMarks.forEach(function (element) {\n            if (element.currentState !== 'DONE' || triggered_event.id !== element.origin) {\n              clean_array.push(element);\n            }\n          });\n        } else {\n          triggeredMarks.forEach(function (element) {\n            if (element.currentState !== \"DONE\" || element.value === triggered_event.value || element.origin !== triggered_event.id) {\n              clean_array.push(element);\n            }\n          });\n        }\n      }\n\n      return clean_array;\n    }\n    /**\n     * Provisional Method TODO: Verify if needed\n     * @param triggered_event\n     * @param richStateselement\n     */\n    // clearStateElements(triggered_event, richStateselement) {\n    //     if(richStateselement[triggered_event.id] !== undefined && parseFloat(triggered_event.value) > parseFloat(richStateselement[triggered_event.id]) + 1) {\n    //         let newElementState = JSON.parse(JSON.stringify(richStateselement));\n    //         newElementState[triggered_event.id] = undefined;\n    //         return newElementState;\n    //     }\n    //\n    //     return richStateselement;\n    // }\n\n    /**\n     * Get all marks triggered in the same event\n     * @param marks\n     * @param triggered_event\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getTriggeredMarks\",\n    value: function getTriggeredMarks(marks, triggered_event) {\n      var _this4 = this;\n\n      var state_marks = [];\n      var previously_triggered_marks = this.state.triggeredMarks;\n\n      if (previously_triggered_marks.length === 0) {\n        marks.forEach(function (mark_element) {\n          if (mark_element.value === triggered_event.value && mark_element.origin === triggered_event.id) {\n            state_marks.push({\n              currentState: \"PENDING\",\n              viewOrigin: _this4.state.currentView[_this4.state.currentView.length - 1],\n              id: mark_element.id,\n              value: mark_element.value,\n              connection: mark_element.connection,\n              origin: mark_element.origin,\n              connectMode: mark_element.connectMode\n            });\n          }\n        });\n      } else {\n        // return only triggered MARKS\n        state_marks = state_marks.concat(previously_triggered_marks);\n        marks.forEach(function (triggered_mark) {\n          var is_different = true;\n\n          for (var n in state_marks) {\n            if (state_marks[n].value === triggered_mark.value && state_marks[n].origin === triggered_event.id) {\n              is_different = false;\n            }\n          }\n\n          if (is_different && triggered_event.value === triggered_mark.value && triggered_event.id === triggered_mark.origin) {\n            state_marks.push({\n              currentState: \"PENDING\",\n              viewOrigin: _this4.state.currentView[_this4.state.currentView.length - 1],\n              id: triggered_mark.id,\n              value: triggered_mark.value,\n              connection: triggered_mark.connection,\n              origin: triggered_mark.origin,\n              connectMode: triggered_mark.connectMode\n            });\n          }\n        });\n      }\n\n      return state_marks;\n    }\n    /**\n     * Get all Mark of currentView\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getAllMarks\",\n    value: function getAllMarks() {\n      var currentView = this.state.currentView[this.state.currentView.length - 1];\n      var boxes = this.getAllRichDescendantBoxes(currentView);\n      var marks = [];\n      Object.keys(Ediphy.State.marksById).forEach(function (mark) {\n        boxes.includes(Ediphy.State.marksById[mark].origin);\n        marks.push(Ediphy.State.marksById[mark]);\n      });\n      return marks;\n    }\n  }, {\n    key: \"putMarksOnHold\",\n    value: function putMarksOnHold(triggered_marks) {\n      var anyTriggeredMarks = false;\n      var anyPendingMarks = false;\n      triggered_marks.forEach(function (t_mark) {\n        if (t_mark.currentState === \"PENDING\") {\n          anyPendingMarks = true;\n        }\n\n        if (t_mark.currentState === \"TRIGGERED\") {\n          anyTriggeredMarks = true;\n        }\n      });\n      var origin_marks = [];\n      var markUntriggered = false;\n\n      if (anyTriggeredMarks && anyPendingMarks) {\n        triggered_marks.forEach(function (t_mark) {\n          if (t_mark.viewOrigin !== undefined && t_mark.currentState === 'HOLD') {\n            origin_marks.push(t_mark.viewOrigin);\n          }\n\n          if (t_mark.currentState === 'TRIGGERED' && t_mark.viewOrigin !== undefined && origin_marks.indexOf(t_mark.viewOrigin) === -1) {\n            origin_marks.push(t_mark.viewOrigin);\n          }\n        });\n        triggered_marks.forEach(function (t_mark) {\n          if (t_mark.currentState === 'PENDING' && t_mark.viewOrigin !== undefined && origin_marks.indexOf(t_mark.viewOrigin) === -1) {\n            markUntriggered = true;\n          }\n        });\n\n        if (markUntriggered) {\n          var newMarksArray = [];\n          triggered_marks.forEach(function (t_mark) {\n            if (t_mark.currentState === 'TRIGGERED') {\n              t_mark.currentState = 'HOLD';\n            }\n\n            newMarksArray.push(t_mark);\n          });\n          return newMarksArray;\n        }\n\n        return triggered_marks;\n      }\n\n      return triggered_marks;\n    }\n    /**\n     * @param navItemID\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getAllRichDescendantBoxes\",\n    value: function getAllRichDescendantBoxes(navItemID) {\n      var view = Ediphy.State.navItemsById[navItemID];\n\n      if (Object(__WEBPACK_IMPORTED_MODULE_8__common_utils__[\"D\" /* isContainedView */])(navItemID)) {\n        view = Ediphy.State.containedViewsById[navItemID];\n      }\n\n      var boxes = view.boxes;\n      var newBoxes = [];\n      var richBoxes = [];\n      Object.keys(Ediphy.State.boxesById).map(function (box) {\n        if (boxes.indexOf(box) !== -1) {\n          newBoxes.push(box);\n\n          if (Object.keys(Ediphy.State.boxesById[box].children).length !== 0) {\n            Object.keys(Ediphy.State.boxesById[box].sortableContainers).map(function (second_box) {\n              newBoxes = newBoxes.concat(Ediphy.State.boxesById[box].sortableContainers[second_box].children);\n            });\n          }\n        }\n      });\n      newBoxes.forEach(function (_final) {\n        if (Ediphy.State.pluginToolbarsById[_final] && Ediphy.State.pluginToolbarsById[_final].pluginId && Ediphy.State.pluginToolbarsById[_final].pluginId !== \"sortable_container\" && Ediphy.Visor.Plugins[Ediphy.State.pluginToolbarsById[_final].pluginId].getConfig().isRich) {\n          richBoxes.push(_final);\n        }\n      });\n      return richBoxes;\n    }\n    /**\n     * Get the current state for selected box\n     * @param backup\n     * @param current\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getActualBoxesStates\",\n    value: function getActualBoxesStates(backup, current) {\n      var nextState = backup;\n      nextState[this.state.triggeredMarks[0].origin] = current[this.state.triggeredMarks[0].origin];\n      return nextState;\n    }\n    /**\n     * Detects if element is not already in state Element so its already triggered\n     * @param triggered_event\n     * @param richElementState\n     *\n     */\n\n  }, {\n    key: \"isNotInStateElement\",\n    value: function isNotInStateElement(triggered_event, richElementState) {\n      if (richElementState[triggered_event.id] === triggered_event.value) {\n        // return false\n        return true;\n      }\n\n      return true;\n    }\n    /**\n     * Remove last view from queue of views\n     */\n\n  }]);\n\n  return Visor;\n}(__WEBPACK_IMPORTED_MODULE_1_react__[\"Component\"]);\n\n\n__WEBPACK_IMPORTED_MODULE_2_react_dom___default.a.render(__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(Visor, null), document.getElementById('root'));\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(13)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY3NC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL192aXNvci9jb250YWluZXJzL1Zpc29yQXBwLmpzeD9iNTliIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNlcmlhbGl6ZSB9IGZyb20gJy4uLy4uL3JlZHVjZXJzL3NlcmlhbGl6ZXInO1xuaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHsgQnV0dG9uLCBDb2wsIEdyaWQsIFJvdyB9IGZyb20gJ3JlYWN0LWJvb3RzdHJhcCc7XG5pbXBvcnQgVmlzb3JDYW52YXMgZnJvbSAnLi4vY29tcG9uZW50cy9jYW52YXMvVmlzb3JDYW52YXMnO1xuaW1wb3J0IFZpc29yQ29udGFpbmVkQ2FudmFzIGZyb20gJy4uL2NvbXBvbmVudHMvY2FudmFzL1Zpc29yQ29udGFpbmVkQ2FudmFzJztcbmltcG9ydCBWaXNvclNpZGVOYXYgZnJvbSAnLi4vY29tcG9uZW50cy9uYXZpZ2F0aW9uL1Zpc29yU2lkZU5hdic7XG5pbXBvcnQgVmlzb3JQbGF5ZXIgZnJvbSAnLi8uLi9jb21wb25lbnRzL25hdmlnYXRpb24vVmlzb3JQbGF5ZXInO1xuXG5pbXBvcnQgeyBpc0NvbnRhaW5lZFZpZXcsIGlzUGFnZSwgaXNTZWN0aW9uLCBpc1ZpZXcgfSBmcm9tICcuLi8uLi9jb21tb24vdXRpbHMnO1xuaW1wb3J0IFNjb3JtQ29tcG9uZW50IGZyb20gJy4uL2NvbXBvbmVudHMvc2NvcmUvR3JhZGVDb21wb25lbnQnO1xuaW1wb3J0IGkxOG4gZnJvbSAnLi4vLi4vbG9jYWxlcy9pMThuJztcbmltcG9ydCAndHlwZWZhY2UtdWJ1bnR1JztcbmltcG9ydCAndHlwZWZhY2Utc291cmNlLXNhbnMtcHJvJztcbmltcG9ydCAnQHRyZW5kbWljcm8vcmVhY3QtdG9nZ2xlLXN3aXRjaC9kaXN0L3JlYWN0LXRvZ2dsZS1zd2l0Y2guY3NzJztcbmltcG9ydCAnLi8uLi8uLi9zYXNzL3N0eWxlLnNjc3MnO1xuaW1wb3J0ICcuLi8uLi9jb3JlL3Zpc29yL3Zpc29yRW50cnlwb2ludCc7XG5cbmlmIChnbG9iYWwgJiYgIWdsb2JhbC5fYmFiZWxQb2x5ZmlsbCkge1xuICAgIHJlcXVpcmUoJ2JhYmVsLXBvbHlmaWxsJyk7XG59XG5cbnJlcXVpcmUoJ2VzNi1wcm9taXNlJykucG9seWZpbGwoKTtcblxuLyoqXG4gKiBWaXNvciBhcHAgbWFpbiBjb21wb25lbnRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlzb3IgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICBsZXQgaW5pdGlhbFZpZXcgPSB0aGlzLmdldEN1cnJlbnRWaWV3KEVkaXBoeS5TdGF0ZS5uYXZJdGVtU2VsZWN0ZWQsIEVkaXBoeS5TdGF0ZS5jb250YWluZWRWaWV3U2VsZWN0ZWQpO1xuICAgICAgICBpZiAoIUVkaXBoeS5TdGF0ZS5wcmV2aWV3KSB7XG4gICAgICAgICAgICBsZXQgcmVtYWluaW5nVmlld3MgPSBFZGlwaHkuU3RhdGUubmF2SXRlbXNJZHMuZmlsdGVyKG49PntcbiAgICAgICAgICAgICAgICBsZXQgbmF2ID0gRWRpcGh5LlN0YXRlLm5hdkl0ZW1zQnlJZFtuXTtcbiAgICAgICAgICAgICAgICBsZXQgcmV0dXJuSXQgPSBpc1NlY3Rpb24obmF2LmlkKSA/IEVkaXBoeS5Db25maWcuc2VjdGlvbnNfaGF2ZV9jb250ZW50IDogdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm5JdCA9IHJldHVybkl0ICYmICFuYXYuaGlkZGVuO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXR1cm5JdCA/IG5hdi5pZCA6IG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZW1haW5pbmdWaWV3cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaW5pdGlhbFZpZXcgPSByZW1haW5pbmdWaWV3c1swXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudGltZXIgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgY3VycmVudFZpZXc6IFtpbml0aWFsVmlld10sIC8qIFRoaXMgaXMgdGhlIGFjdHVhbCB2aWV3IHJlbmRlcmluZyovXG4gICAgICAgICAgICB0cmlnZ2VyZWRNYXJrczogW10sXG4gICAgICAgICAgICBzaG93cG9wOiBmYWxzZSxcbiAgICAgICAgICAgIHJpY2hFbGVtZW50U3RhdGU6IHt9LFxuICAgICAgICAgICAgYmFja3VwRWxlbWVudFN0YXRlczoge30sXG4gICAgICAgICAgICB0b2dnbGVkU2lkZWJhcjogZmFsc2UsIC8vIEVkaXBoeS5TdGF0ZS5nbG9iYWxDb25maWcudmlzb3JOYXYuc2lkZWJhciA/IEVkaXBoeS5TdGF0ZS5nbG9iYWxDb25maWcudmlzb3JOYXYuc2lkZWJhciA6IChFZGlwaHkuU3RhdGUuZ2xvYmFsQ29uZmlnLnZpc29yTmF2LnNpZGViYXIgPT09IHVuZGVmaW5lZCksXG4gICAgICAgICAgICBmcm9tU2Nvcm06IEVkaXBoeS5TdGF0ZS5mcm9tU2Nvcm0sXG4gICAgICAgICAgICBzY29yZUluZm86IHsgdXNlck5hbWU6IFwiQW5vbnltb3VzXCIsIHRvdGFsU2NvcmU6IDAsIHRvdGFsV2VpZ2h0OiAwLCBjb21wbGV0aW9uUHJvZ3Jlc3M6IDAgfSxcbiAgICAgICAgICAgIG1vdXNlTW92aW5nOiBmYWxzZSxcbiAgICAgICAgICAgIG1vdXNlT25QbGF5ZXI6IGZhbHNlLFxuICAgICAgICAgICAgYmFja3dhcmRzOiBmYWxzZSxcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoIUVkaXBoeS5TdGF0ZS5leHBvcnQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5leHBvcnQgPSAoZm9ybWF0ID0gJ0hUTUwnKSA9PiB7XG4gICAgICAgICAgICAgICAgc3dpdGNoKGZvcm1hdCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1NDT1JNMTInOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydFRvU2Nvcm0oZmFsc2UsICgpPT57cmV0dXJuIHRydWU7fSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjYXNlICdTQ09STTIwMDQnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydFRvU2Nvcm0odHJ1ZSwgKCk9PntyZXR1cm4gdHJ1ZTt9LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0hUTUwnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydFRvU2Nvcm0oJ0hUTUwnLCAoKT0+e3JldHVybiB0cnVlO30sIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZmV0Y2goRWRpcGh5LkNvbmZpZy50aGVtZV9jc3NfdXJsKSAvLyBXZWJwYWNrIG91dHB1dCBDU1NcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgaWYoIXJlcy5vaykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Vycm9yJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXMudGV4dCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgIHdpbmRvdy50aGVtZV9jc3MgPSBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoKT0+ICcnKTtcbiAgICB9XG5cbiAgICBzZXRIb3ZlckNsYXNzID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgbW91c2VPblBsYXllcjogdHJ1ZSB9KTtcbiAgICB9O1xuXG4gICAgZGVsZXRlSG92ZXJDbGFzcyA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG1vdXNlT25QbGF5ZXI6IGZhbHNlIH0pO1xuICAgIH07XG5cbiAgICBfb25Nb3VzZU1vdmUgPSAoKSA9PiB7XG4gICAgICAgIGlmKCF0aGlzLnN0YXRlLm1vdXNlTW92aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgbW91c2VNb3Zpbmc6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZih0aGlzLnRpbWVyKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBtb3VzZU1vdmluZzogZmFsc2UgfSk7XG4gICAgICAgICAgICB9LCAyNTAwKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZShuZXh0UHJvcHMsIG5leHRTdGF0ZSkge1xuICAgICAgICAvLyByZXNldCBtYXJrcyB3aGVuIG5hdmlnYXRpbmcgYmV0d2VlbiBtYWluIHNlY3Rpb25zXG4gICAgICAgIGlmKHRoaXMuc3RhdGUuY3VycmVudFZpZXcubGVuZ3RoICE9PSBuZXh0U3RhdGUuY3VycmVudFZpZXcubGVuZ3RoICYmIGlzVmlldyhuZXh0U3RhdGUuY3VycmVudFZpZXdbbmV4dFN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCAtIDFdKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRyaWdnZXJlZE1hcmtzOiBbXSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCA+IDEgJiYgdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5maWx0ZXIoKGkpID0+IGkuaW5kZXhPZihcInBhLVwiKSAhPT0gLTEpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50VmlldzogW3RoaXMuc3RhdGUuY3VycmVudFZpZXdbdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5sZW5ndGggLSAxXV0gfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNYXJrIHRyaWdnZXJpbmcgbWVjaGFuaXNtXG4gICAgICAgIGlmKG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcy5sZW5ndGggIT09IDAgJiYgdGhpcy5yZXR1cm5UcmlnZ2VyZWFibGVNYXJrKG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcykpIHtcbiAgICAgICAgICAgIGxldCBuZXdNYXJrID0gdGhpcy5yZXR1cm5UcmlnZ2VyZWFibGVNYXJrKG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcyk7XG5cbiAgICAgICAgICAgIG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcy5mb3JFYWNoKG1hcms9PntcbiAgICAgICAgICAgICAgICBpZihuZXdNYXJrLmlkID09PSBtYXJrLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmsuY3VycmVudFN0YXRlID0gJ1RSSUdHRVJFRCc7XG4gICAgICAgICAgICAgICAgICAgIG1hcmsudmlld09yaWdpbiA9IHRoaXMuc3RhdGUuY3VycmVudFZpZXdbdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcms7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTmV3IG9yIGV4aXN0aW5nIG1hcmtcbiAgICAgICAgICAgIGlmKG5ld01hcmsuY29ubmVjdE1vZGUgPT09ICduZXcnIHx8IG5ld01hcmsuY29ubmVjdE1vZGUgPT09IFwiZXhpc3RpbmdcIikge1xuXG4gICAgICAgICAgICAgICAgbGV0IGFycmF5X3RyaWdnZXJfbWFyayA9IHRoaXMuc2FudGluaXplVmlld3NBcnJheShuZXh0U3RhdGUudHJpZ2dlcmVkTWFya3MsIG5leHRTdGF0ZS5jdXJyZW50Vmlldy5jb25jYXQoW25ld01hcmsuY29ubmVjdGlvbl0pKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Y3YgPSBhcnJheV90cmlnZ2VyX21hcmsubGVuZ3RoID4gMCAmJiBhcnJheV90cmlnZ2VyX21hcmtbYXJyYXlfdHJpZ2dlcl9tYXJrLmxlbmd0aCAtIDFdICYmIGlzQ29udGFpbmVkVmlldyhhcnJheV90cmlnZ2VyX21hcmtbYXJyYXlfdHJpZ2dlcl9tYXJrLmxlbmd0aCAtIDFdKSA/IGFycmF5X3RyaWdnZXJfbWFya1thcnJheV90cmlnZ2VyX21hcmsubGVuZ3RoIC0gMV0gOiAwO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lZFZpZXdTZWxlY3RlZDogbmV3Y3YsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWaWV3OiBhcnJheV90cmlnZ2VyX21hcmssXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZE1hcmtzOiBuZXh0U3RhdGUudHJpZ2dlcmVkTWFya3MsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEV4dGVybmFsIHRhcmdldFxuICAgICAgICAgICAgfSBlbHNlIGlmKG5ld01hcmsuY29ubmVjdE1vZGUgPT09IFwiZXh0ZXJuYWxcIikge1xuICAgICAgICAgICAgICAgIGxldCB3aW4gPSB3aW5kb3cub3BlbihuZXdNYXJrLmNvbm5lY3Rpb24sICdfYmxhbmsnKTtcbiAgICAgICAgICAgICAgICB3aW4uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICBsZXQgc2hpZnRFeHRlcm5hbCA9IG5leHRTdGF0ZS50cmlnZ2VyZWRNYXJrcztcbiAgICAgICAgICAgICAgICBzaGlmdEV4dGVybmFsLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZE1hcmtzOiBzaGlmdEV4dGVybmFsLFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYobmV3TWFyay5jb25uZWN0TW9kZSA9PT0gXCJwb3B1cFwiKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNoaWZ0UG9wID0gbmV4dFN0YXRlLnRyaWdnZXJlZE1hcmtzO1xuICAgICAgICAgICAgICAgIHNoaWZ0UG9wLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgbGV0IG1hcmtwb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFyay0nICsgbmV3TWFyay5pZCk7XG4gICAgICAgICAgICAgICAgaWYgKG1hcmtwb3ApIHsgbWFya3BvcC5jbGljaygpO31cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgc2hvd3BvcDogIXRoaXMuc3RhdGUuc2hvd3BvcCxcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkTWFya3M6IHNoaWZ0UG9wLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIC8qXG4gICAgICAgICogQWRkIEtleSBiaW5kaW5ncyB0byBhcHBcbiAgICAgICAgKiAqL1xuICAgICAgICBpZihFZGlwaHkuU3RhdGUuZ2xvYmFsQ29uZmlnLnZpc29yTmF2LmtleUJpbmRpbmdzKSB7XG4gICAgICAgICAgICAvLyBGaXJzdCBnZXQgd2luZG93IGZvY3VzIHNvIGFycm93cyB3b3JrIHJpZ2h0IGF3YXlcbiAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpO1xuICAgICAgICAgICAgd2luZG93Lm9ua2V5dXAgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgbGV0IGtleSA9IGUua2V5Q29kZSA/IGUua2V5Q29kZSA6IGUud2hpY2g7XG4gICAgICAgICAgICAgICAgbGV0IG5hdkl0ZW1zSWRzID0gRWRpcGh5LlN0YXRlLm5hdkl0ZW1zSWRzO1xuICAgICAgICAgICAgICAgIGxldCBuYXZJdGVtcyA9IEVkaXBoeS5TdGF0ZS5uYXZJdGVtc0J5SWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIUVkaXBoeS5Db25maWcuc2VjdGlvbnNfaGF2ZV9jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIG5hdkl0ZW1zSWRzID0gbmF2SXRlbXNJZHMuZmlsdGVyKChlbGVtZW50KT0+KGVsZW1lbnQuaW5kZXhPZihcInNlXCIpID09PSAtMSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuYXZJdGVtc0lkcyA9IG5hdkl0ZW1zSWRzLmZpbHRlcihuYXY9PiB7cmV0dXJuICFuYXZJdGVtc1tuYXZdLmhpZGRlbjt9KTtcbiAgICAgICAgICAgICAgICBsZXQgbmF2SXRlbVNlbGVjdGVkID0gdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5yZWR1Y2UoZWxlbWVudD0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzUGFnZShlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBuYXZJdGVtc0lkcy5pbmRleE9mKG5hdkl0ZW1TZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgbGV0IG1heEluZGV4ID0gbmF2SXRlbXNJZHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGxldCBmb2N1c0VsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBpZiAoZm9jdXNFbGVtZW50ICE9PSAnaW5wdXQnICYmIGZvY3VzRWxlbWVudCAhPT0gJ3RleHRhcmVhJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAzNyB8fCBrZXkgPT09IDMzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUN1cnJlbnRWaWV3KG5hdkl0ZW1zSWRzW01hdGgubWF4KGluZGV4IC0gMSwgMCldLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGtleSA9PT0gMzkgfHwga2V5ID09PSAzNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VDdXJyZW50VmlldyhuYXZJdGVtc0lkc1tNYXRoLm1pbihpbmRleCArIDEsIG1heEluZGV4IC0gMSldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpO1xuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGlmICh3aW5kb3cuU3RhdGUpIHtcbiAgICAgICAgICAgIEVkaXBoeS5TdGF0ZSA9IHNlcmlhbGl6ZSh7IFwicHJlc2VudFwiOiB7IC4uLndpbmRvdy5TdGF0ZSB9IH0pLnByZXNlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHsgbmF2SXRlbXNJZHMsIGdsb2JhbENvbmZpZywgc3R5bGVDb25maWcgPSB7fSwgY29udGFpbmVkVmlld3NCeUlkLCBib3hlc0J5SWQsIG1hcmtzQnlJZCwgbmF2SXRlbXNCeUlkLCB2aWV3VG9vbGJhcnNCeUlkLCBwbHVnaW5Ub29sYmFyc0J5SWQgfSA9IEVkaXBoeS5TdGF0ZTtcbiAgICAgICAgbGV0IGVkaXBoeV9kb2N1bWVudF9pZCA9IEVkaXBoeS5TdGF0ZS5pZDtcbiAgICAgICAgbGV0IGVkaXBoeV9wbGF0Zm9ybSA9IEVkaXBoeS5TdGF0ZS5wbGF0Zm9ybTtcbiAgICAgICAgbGV0IGV4ZXJjaXNlcyA9IHt9O1xuICAgICAgICBPYmplY3Qua2V5cyhFZGlwaHkuU3RhdGUuZXhlcmNpc2VzKS5tYXAoZXhlcmNpc2U9PntcbiAgICAgICAgICAgIGlmIChjb250YWluZWRWaWV3c0J5SWRbZXhlcmNpc2VdIHx8IChuYXZJdGVtc0J5SWRbZXhlcmNpc2VdICYmICFuYXZJdGVtc0J5SWRbZXhlcmNpc2VdLmhpZGRlbikpIHtcbiAgICAgICAgICAgICAgICBleGVyY2lzZXNbZXhlcmNpc2VdID0gRWRpcGh5LlN0YXRlLmV4ZXJjaXNlc1tleGVyY2lzZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgdGl0bGUgPSBnbG9iYWxDb25maWcudGl0bGU7XG4gICAgICAgIGxldCByYXRpbyA9IGdsb2JhbENvbmZpZy5jYW52YXNSYXRpbztcbiAgICAgICAgbGV0IHZpc29yTmF2ID0gZ2xvYmFsQ29uZmlnLnZpc29yTmF2O1xuICAgICAgICBsZXQgd3JhcHBlckNsYXNzZXMgPSB0aGlzLnN0YXRlLnRvZ2dsZWRTaWRlYmFyID8gXCJ2aXNvcndyYXBwZXIgdG9nZ2xlZFwiIDogXCJ2aXNvcndyYXBwZXJcIjtcbiAgICAgICAgbGV0IHRvZ2dsZUljb24gPSB0aGlzLnN0YXRlLnRvZ2dsZWRTaWRlYmFyID8gXCJrZXlib2FyZF9hcnJvd19sZWZ0XCIgOiBcImtleWJvYXJkX2Fycm93X3JpZ2h0XCI7XG4gICAgICAgIGxldCB0b2dnbGVDb2xvciA9IHRoaXMuc3RhdGUudG9nZ2xlZFNpZGViYXIgPyBcInRvZ2dsZUNvbG9yXCIgOiBcIlwiO1xuICAgICAgICBsZXQgaXNDViA9IGlzQ29udGFpbmVkVmlldyh0aGlzLnN0YXRlLmN1cnJlbnRWaWV3KTtcbiAgICAgICAgbGV0IGlzU2xpZGUgPSBpc0NWICYmIGNvbnRhaW5lZFZpZXdzQnlJZFt0aGlzLmdldExhc3RDdXJyZW50Vmlld0VsZW1lbnQoKV0gPT09IFwic2xpZGVcIiB8fFxuICAgICAgICAhaXNDViAmJiBuYXZJdGVtc0J5SWRbdGhpcy5nZXRMYXN0Q3VycmVudFZpZXdFbGVtZW50KCldID09PSBcInNsaWRlXCIgP1xuICAgICAgICAgICAgXCJwY3dfc2xpZGVcIiA6IFwicGN3X2RvY1wiO1xuXG4gICAgICAgIGxldCB2aXNoUGxheWVyID0gKGdsb2JhbENvbmZpZy52aXNvck5hdiAmJiBnbG9iYWxDb25maWcudmlzb3JOYXYuZml4ZWRQbGF5ZXIgIT09IHVuZGVmaW5lZCkgPyBnbG9iYWxDb25maWcudmlzb3JOYXYuZml4ZWRQbGF5ZXIgOiB0cnVlO1xuICAgICAgICBsZXQgY3VycmVudFZpZXcgPSB0aGlzLmdldExhc3RDdXJyZW50Vmlld0VsZW1lbnQoKTtcbiAgICAgICAgbGV0IGNhbnZhc1Byb3BzID0ge1xuICAgICAgICAgICAgYm94ZXM6IGJveGVzQnlJZCxcbiAgICAgICAgICAgIGNoYW5nZUN1cnJlbnRWaWV3OiAoZWxlbWVudCkgPT4ge3RoaXMuY2hhbmdlQ3VycmVudFZpZXcoZWxlbWVudCk7fSxcbiAgICAgICAgICAgIGNhbnZhc1JhdGlvOiByYXRpbyxcbiAgICAgICAgICAgIGNvbnRhaW5lZFZpZXdzOiBjb250YWluZWRWaWV3c0J5SWQsXG4gICAgICAgICAgICBjdXJyZW50VmlldzogY3VycmVudFZpZXcsXG4gICAgICAgICAgICBmcm9tU2Nvcm06IHRoaXMuc3RhdGUuZnJvbVNjb3JtLFxuICAgICAgICAgICAgbmF2SXRlbXM6IG5hdkl0ZW1zQnlJZCxcbiAgICAgICAgICAgIG5hdkl0ZW1zSWRzLFxuICAgICAgICAgICAgcmVtb3ZlTGFzdFZpZXc6IHRoaXMucmVtb3ZlTGFzdFZpZXcsXG4gICAgICAgICAgICByaWNoRWxlbWVudHNTdGF0ZTogdGhpcy5zdGF0ZS5yaWNoRWxlbWVudFN0YXRlLFxuICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICBtYXJrczogbWFya3NCeUlkLFxuICAgICAgICAgICAgdmlld1Rvb2xiYXJzOiB2aWV3VG9vbGJhcnNCeUlkLFxuICAgICAgICAgICAgcGx1Z2luVG9vbGJhcnM6IHBsdWdpblRvb2xiYXJzQnlJZCxcbiAgICAgICAgICAgIG9uTWFya0NsaWNrZWQ6IHRoaXMub25NYXJrQ2xpY2tlZCxcbiAgICAgICAgICAgIHRyaWdnZXJlZE1hcmtzOiB0aGlzLnN0YXRlLnRyaWdnZXJlZE1hcmtzLFxuICAgICAgICAgICAgdmlld3NBcnJheTogdGhpcy5zdGF0ZS5jdXJyZW50VmlldyxcbiAgICAgICAgICAgIGV4cG9ydE1vZGFsT3BlbjogZmFsc2UsXG4gICAgICAgICAgICBlZGlwaHlfZG9jdW1lbnRfaWQsXG4gICAgICAgICAgICBlZGlwaHlfcGxhdGZvcm0sXG4gICAgICAgICAgICBleGVyY2lzZXMsXG4gICAgICAgICAgICBzdHlsZUNvbmZpZyxcbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgbmF2SXRlbUNvbXBvbmVudHMgPSBPYmplY3Qua2V5cyhuYXZJdGVtc0J5SWQpLmZpbHRlcihuYXY9PmlzUGFnZShuYXYpKS5tYXAoKG5hdiwgaSk9PntcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPFZpc29yQ2FudmFzIGtleT17aX0gey4uLmNhbnZhc1Byb3BzfSBzZWxlY3RlZFZpZXc9e2N1cnJlbnRWaWV3fSBiYWNrd2FyZHMgPSB7dGhpcy5zdGF0ZS5iYWNrd2FyZHN9IGN1cnJlbnRWaWV3PXtuYXZ9IHNob3c9e25hdiA9PT0gY3VycmVudFZpZXd9IHo9eyBpICsgMTB9IHNob3dDYW52YXM9e25hdi5pbmRleE9mKFwiY3YtXCIpID09PSAtMX0gLz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgY3ZDb21wb25lbnRzID0gT2JqZWN0LmtleXMoY29udGFpbmVkVmlld3NCeUlkKS5tYXAoKG5hdiwgaSk9PntcbiAgICAgICAgICAgIHJldHVybiA8Vmlzb3JDb250YWluZWRDYW52YXMga2V5PXtpfSB7Li4uY2FudmFzUHJvcHN9IGN1cnJlbnRWaWV3PXtuYXZ9IHNob3c9e25hdiA9PT0gY3VycmVudFZpZXd9IHo9eyBpICsgbmF2SXRlbUNvbXBvbmVudHMubGVuZ3RoIH0gc2hvd0NhbnZhcz17bmF2LmluZGV4T2YoXCJjdi1cIikgIT09IC0xfSAvPjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGNvbnRlbnQgPSBbLi4ubmF2SXRlbUNvbXBvbmVudHMsIGN2Q29tcG9uZW50c107XG4gICAgICAgIGxldCBlbXB0eSA9IDxkaXYgY2xhc3NOYW1lPVwiZW1wdHlQcmVzZW50YXRpb25cIj57aTE4bi50KFwiRW1wdHlQcmVzZW50YXRpb25cIil9PC9kaXY+O1xuICAgICAgICBsZXQgdmlzb3JOYXZCdXR0b25DbGFzcyA9ICdob3ZlclBsYXllclNlbGVjdG9yJztcbiAgICAgICAgdmlzb3JOYXZCdXR0b25DbGFzcyA9IHRoaXMuc3RhdGUubW91c2VNb3ZpbmcgPyB2aXNvck5hdkJ1dHRvbkNsYXNzICsgJyBhcHBlYXJCdXR0b24nIDogdmlzb3JOYXZCdXR0b25DbGFzcyArICcgZmFkZUJ1dHRvbic7XG4gICAgICAgIHZpc29yTmF2QnV0dG9uQ2xhc3MgPSB0aGlzLnN0YXRlLm1vdXNlT25QbGF5ZXIgPyB2aXNvck5hdkJ1dHRvbkNsYXNzICsgJyBob3ZlclBsYXllck9uJyA6IHZpc29yTmF2QnV0dG9uQ2xhc3M7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGlkPVwiYXBwXCIgcmVmPXsnYXBwJ31cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3dyYXBwZXJDbGFzc2VzfVxuICAgICAgICAgICAgICAgIG9uTW91c2VNb3ZlPXt0aGlzLl9vbk1vdXNlTW92ZX0+XG4gICAgICAgICAgICAgICAgPFZpc29yU2lkZU5hdlxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDdXJyZW50Vmlldz17KHBhZ2UpPT4ge3RoaXMuY2hhbmdlQ3VycmVudFZpZXcocGFnZSk7fX1cbiAgICAgICAgICAgICAgICAgICAgY291cnNlVGl0bGU9e3RpdGxlfVxuICAgICAgICAgICAgICAgICAgICBzaG93PXt2aXNvck5hdi5zaWRlYmFyfVxuICAgICAgICAgICAgICAgICAgICBzaG93U2NvcmU9eyFnbG9iYWxDb25maWcuaGlkZUdsb2JhbFNjb3JlfVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Vmlld3M9e3RoaXMuc3RhdGUuY3VycmVudFZpZXd9XG4gICAgICAgICAgICAgICAgICAgIG5hdkl0ZW1zQnlJZD17bmF2SXRlbXNCeUlkfVxuICAgICAgICAgICAgICAgICAgICBuYXZJdGVtc0lkcz17bmF2SXRlbXNJZHMuZmlsdGVyKG5hdj0+IHtyZXR1cm4gIW5hdkl0ZW1zQnlJZFtuYXZdLmhpZGRlbjt9KX1cbiAgICAgICAgICAgICAgICAgICAgdmlld1Rvb2xiYXJzPXt2aWV3VG9vbGJhcnNCeUlkfVxuICAgICAgICAgICAgICAgICAgICBzY29yZUluZm89e3RoaXMuc3RhdGUuc2NvcmVJbmZvfVxuICAgICAgICAgICAgICAgICAgICBleGVyY2lzZXM9e2V4ZXJjaXNlc31cbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlZD17dGhpcy5zdGF0ZS50b2dnbGVkU2lkZWJhcn0vPlxuICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJwYWdlLWNvbnRlbnQtd3JhcHBlclwiXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17aXNTbGlkZSArIFwiIHBhZ2UtY29udGVudC13cmFwcGVyXCJ9XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGhlaWdodDogJzEwMCUnIH19PlxuICAgICAgICAgICAgICAgICAgICA8R3JpZCBmbHVpZCBpZD1cInZpc29yQXBwQ29udGVudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBoZWlnaHQ6ICcxMDAlJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxSb3cgc3R5bGU9e3sgaGVpZ2h0OiB2aXNoUGxheWVyID8gJ2NhbGMoMTAwJSAtIDM4cHgpJyA6ICcxMDAlJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q29sIGxnPXsxMn0gc3R5bGU9e3sgaGVpZ2h0OiAnMTAwJScsIHBhZGRpbmdMZWZ0OiAnMHB4JywgcGFkZGluZ1JpZ2h0OiAnMHB4JyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFNjb3JtQ29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWRlUGxheWVyQ2xhc3M9e3Zpc29yTmF2QnV0dG9uQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRIb3Zlcj17dGhpcy5zZXRIb3ZlckNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlSG92ZXIgPSB7dGhpcy5kZWxldGVIb3ZlckNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlU2NvcmU9eyhzY29yZUluZm8pPT57dGhpcy5zZXRTdGF0ZSh7IHNjb3JlSW5mbyB9KTt9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF2SXRlbXNJZHM9e25hdkl0ZW1zSWRzLmZpbHRlcihuYXY9PiB7cmV0dXJuICFuYXZJdGVtc0J5SWRbbmF2XS5oaWRkZW47fSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZWRWaWV3cz17Y29udGFpbmVkVmlld3NCeUlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZpZXc9e2N1cnJlbnRWaWV3fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF2SXRlbXNCeUlkPXtuYXZJdGVtc0J5SWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxDb25maWc9e2dsb2JhbENvbmZpZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlQ29uZmlnPXtzdHlsZUNvbmZpZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZXJjaXNlcz17ZXhlcmNpc2VzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luVG9vbGJhcnM9e3BsdWdpblRvb2xiYXJzQnlJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21TY29ybT17dGhpcy5zdGF0ZS5mcm9tU2Nvcm19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDdXJyZW50Vmlldz17KGVsKT0+e3RoaXMuY2hhbmdlQ3VycmVudFZpZXcoZWwpO319PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2N1cnJlbnRWaWV3ID8gY29udGVudCA6IGVtcHR5fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1Njb3JtQ29tcG9uZW50PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ICF2aXNoUGxheWVyID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFZpc29yUGxheWVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFkZVBsYXllckNsYXNzPXt2aXNvck5hdkJ1dHRvbkNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEhvdmVyPXt0aGlzLnNldEhvdmVyQ2xhc3N9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlSG92ZXIgPSB7dGhpcy5kZWxldGVIb3ZlckNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c9e3Zpc29yTmF2LnBsYXllcn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VDdXJyZW50Vmlldz17KHBhZ2UsIGJhY2t3YXJkcyk9PiB7dGhpcy5jaGFuZ2VDdXJyZW50VmlldyhwYWdlLCBiYWNrd2FyZHMpO319XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZpZXdzPXt0aGlzLnN0YXRlLmN1cnJlbnRWaWV3fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdkl0ZW1zQnlJZD17bmF2SXRlbXNCeUlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdkl0ZW1zSWRzPXtuYXZJdGVtc0lkcy5maWx0ZXIobmF2PT4ge3JldHVybiAhbmF2SXRlbXNCeUlkW25hdl0uaGlkZGVuO30pfS8+KSA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt2aXNvck5hdi5zaWRlYmFyID8gKDxkaXYgY2xhc3NOYW1lPXtcInZpc29yTmF2QnV0dG9uRGl2XCJ9IG9uTW91c2VFbnRlcj17KCk9PiB0aGlzLnNldEhvdmVyQ2xhc3MoKX0gb25Nb3VzZUxlYXZlPXsoKT0+dGhpcy5kZWxldGVIb3ZlckNsYXNzKCl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBpZD1cInZpc29yTmF2QnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3RvZ2dsZUNvbG9yICsgdmlzb3JOYXZCdXR0b25DbGFzc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBic1N0eWxlPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgdG9nZ2xlZFNpZGViYXI6ICF0aGlzLnN0YXRlLnRvZ2dsZWRTaWRlYmFyIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJtYXRlcmlhbC1pY29uc1wiPnt0b2dnbGVJY29ufTwvaT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPjwvZGl2PikgOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Sb3c+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Um93IHN0eWxlPXt7IGhlaWdodDogJzM4cHgnLCBkaXNwbGF5OiB2aXNoUGxheWVyID8gJ2Jsb2NrJyA6ICdub25lJyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q29sIGxnPXsxMn0gc3R5bGU9e3sgaGVpZ2h0OiAnMTAwJScsIHBhZGRpbmdMZWZ0OiAnMHB4JywgcGFkZGluZ1JpZ2h0OiAnMHB4JyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFZpc29yUGxheWVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWRlUGxheWVyQ2xhc3M9e1wiYXBwZWFyQnV0dG9uXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRIb3Zlcj17dGhpcy5zZXRIb3ZlckNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlSG92ZXIgPSB7dGhpcy5kZWxldGVIb3ZlckNsYXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdz17dmlzb3JOYXYucGxheWVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ3VycmVudFZpZXc9eyhwYWdlLCBiYWNrd2FyZHMpPT4ge3RoaXMuY2hhbmdlQ3VycmVudFZpZXcocGFnZSwgYmFja3dhcmRzKTt9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZpZXdzPXt0aGlzLnN0YXRlLmN1cnJlbnRWaWV3fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF2SXRlbXNCeUlkPXtuYXZJdGVtc0J5SWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXZJdGVtc0lkcz17bmF2SXRlbXNJZHMuZmlsdGVyKG5hdj0+IHtyZXR1cm4gIW5hdkl0ZW1zQnlJZFtuYXZdLmhpZGRlbjt9KX0vPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQ29sPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Sb3c+XG4gICAgICAgICAgICAgICAgICAgIDwvR3JpZD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2Pik7XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgdG8gSFRNTCBvciBQREZcbiAgICAgKiBAcGFyYW0gZm9ybWF0XG4gICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBleHBvcnQoZm9ybWF0LCBjYWxsYmFjaywgb3B0aW9ucyA9IGZhbHNlKSB7XG4gICAgICAgIGlmKGZvcm1hdCA9PT0gXCJQREZcIikge1xuICAgICAgICAgICAgcHJpbnRUb1BERihFZGlwaHkuU3RhdGUsIGNhbGxiYWNrLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIEVkaXBoeS5WaXNvci5leHBvcnRzSFRNTChFZGlwaHkuU3RhdGUsIGNhbGxiYWNrLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGV4cG9ydFRvU2Nvcm0oaXMyMDA0LCBjYWxsYmFjaywgc2VsZkNvbnRhaW5lZCA9IGZhbHNlKSB7XG4gICAgICAgIEVkaXBoeS5WaXNvci5leHBvcnRTY29ybShFZGlwaHkuU3RhdGUsIGlzMjAwNCwgY2FsbGJhY2ssIHNlbGZDb250YWluZWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhY3R1YWxWaWV3IFJFRkFDVE9SOiBjaGFuZ2UgbmFtZVxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IGN1cnJlbnRWaWV3XG4gICAgICovXG4gICAgZ2V0TGFzdEN1cnJlbnRWaWV3RWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUuY3VycmVudFZpZXdbdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5sZW5ndGggLSAxXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBOYXZpZ2F0aW9uIG1haW4gbWV0aG9kXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVsZW1lbnQgLSBjdXJyZW50IEVsZW1lbnQgdG8gZ29cbiAgICAgKi9cbiAgICBjaGFuZ2VDdXJyZW50VmlldyhlbGVtZW50LCBiYWNrd2FyZHMgPSBmYWxzZSkge1xuICAgICAgICBpZiAoaXNDb250YWluZWRWaWV3KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgY3VycmVudFZpZXc6IFt0aGlzLmdldEN1cnJlbnRWaWV3KHRoaXMuc3RhdGUubmF2SXRlbVNlbGVjdGVkLCB0aGlzLnN0YXRlLmNvbnRhaW5lZFZpZXdTZWxlY3RlZCksIGVsZW1lbnRdLCBiYWNrd2FyZHM6IGJhY2t3YXJkcyB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjdXJyZW50VmlldzogW2VsZW1lbnRdLCBiYWNrd2FyZHM6IGJhY2t3YXJkcyB9KTtcbiAgICAgICAgICAgIGlmKHRoaXMuc3RhdGUuY3VycmVudFZpZXcubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0cmlnZ2VyZWRNYXJrczogdGhpcy51blRyaWdnZXJMYXN0TWFyayh0aGlzLnN0YXRlLnRyaWdnZXJlZE1hcmtzKSxcbiAgICAgICAgICAgICAgICAgICAgcmljaEVsZW1lbnRTdGF0ZTogdGhpcy5nZXRBY3R1YWxCb3hlc1N0YXRlcyh0aGlzLnN0YXRlLmJhY2t1cEVsZW1lbnRTdGF0ZXMsIHRoaXMuc3RhdGUucmljaEVsZW1lbnRTdGF0ZSksIGJhY2t3YXJkczogYmFja3dhcmRzIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIHVzZWQgdG8gZ2V0IGluaXRpYWwgdmlldyBhbmQgbWFrZSBzdXJlIGlzIGVpdGhlciBjb250YWluZWRWaWV3IG9yIE5hdkl0ZW1cbiAgICAgKiBAcGFyYW0gTklzZWxlY3RlZFxuICAgICAqIEBwYXJhbSBDVnNlbGVjdGVkXG4gICAgICovXG4gICAgZ2V0Q3VycmVudFZpZXcoTklzZWxlY3RlZCwgQ1ZzZWxlY3RlZCkge1xuICAgICAgICBsZXQgbmF2SXRlbVNlbGVjdGVkID0gMDtcbiAgICAgICAgaWYgKEVkaXBoeS5TdGF0ZS5uYXZJdGVtc0J5SWRbTklzZWxlY3RlZF0gJiYgIUVkaXBoeS5TdGF0ZS5uYXZJdGVtc0J5SWRbTklzZWxlY3RlZF0uaGlkZGVuKSB7XG4gICAgICAgICAgICBuYXZJdGVtU2VsZWN0ZWQgPSBOSXNlbGVjdGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoQ1ZzZWxlY3RlZCA9PT0gMCkgPyBuYXZJdGVtU2VsZWN0ZWQgOiBDVnNlbGVjdGVkO1xuICAgIH1cblxuICAgIC8qIE1hcmtzIGZ1bmN0aW9ucyovXG5cbiAgICAvKipcbiAgICAgKiBNYWtlIHN1cmUgaWYgbWFyayB2YWx1ZSBleGlzdHNcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSAtICB3aGV0aGVyIHRoZSBtYXJrIGV4aXN0cyBvciBub3QgaW4gdGhlIGFycmF5XG4gICAgICogQHBhcmFtIG1hcmtzXG4gICAgICogQHBhcmFtIG1hcmtfdmFsdWVcbiAgICAgKi9cbiAgICBjb250YWluc01hcmtWYWx1ZShtYXJrcywgbWFya192YWx1ZSkge1xuICAgICAgICBsZXQgZXhpc3RzID0gZmFsc2U7XG4gICAgICAgIG1hcmtzLmZvckVhY2gobWFya19lbGVtZW50PT57XG4gICAgICAgICAgICBpZihtYXJrX2VsZW1lbnQudmFsdWUgPT09IG1hcmtfdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBleGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGV4aXN0cztcbiAgICB9XG5cbiAgICBvbk1hcmtDbGlja2VkID0gKGlkLCB2YWx1ZSwgc3RhdGVFbGVtZW50KSA9PiB7XG4gICAgICAgIGxldCByaWNoRWxlbWVudHNTdGF0ZSA9IHRoaXMuc3RhdGUucmljaEVsZW1lbnRTdGF0ZTtcbiAgICAgICAgbGV0IG1hcmtzID0gdGhpcy5nZXRBbGxNYXJrcygpO1xuICAgICAgICBsZXQgdHJpZ2dlcmVkX2V2ZW50ID0geyBpZCwgdmFsdWUsIHN0YXRlRWxlbWVudCB9O1xuICAgICAgICBsZXQgdHJpZ2dlcmVkX21hcmtzID0gdGhpcy5nZXRUcmlnZ2VyZWRNYXJrcyhtYXJrcywgdHJpZ2dlcmVkX2V2ZW50KTtcbiAgICAgICAgLy8gY2xlYXJNYXJrIHwgSWYgYWN0dWFsIFRyaWdnZXJlZCBNYXJrIGhhdmUgcGFzc2VkIGUuZGV0YWlsLnZhbHVlIGFuZCBhY3R1YWwgdmFsdWUgaXMgZGlmZmVyZW50IG9yIGFjdHVhbCBlbGVtZW50IGRvZXNuJ3QgbmVlZCB0byBjbGVhciB0aGUgdmFsdWVcbiAgICAgICAgdHJpZ2dlcmVkX21hcmtzID0gdGhpcy5jbGVhclRyaWdnZXJlZFZhbHVlcyh0cmlnZ2VyZWRfZXZlbnQsIHRyaWdnZXJlZF9tYXJrcyk7XG5cbiAgICAgICAgLy8gSnVzdCB0cnkgdG8gdHJpZ2dlciBpZiBtYXJrIGV4aXN0c1xuICAgICAgICBpZih0aGlzLmNvbnRhaW5zTWFya1ZhbHVlKG1hcmtzLCB0cmlnZ2VyZWRfZXZlbnQudmFsdWUpKSB7XG4gICAgICAgIC8vIEFuZCBpcyB0cmlnZ2VyZWFibGUgKG5vdCBwZW5kaW5nKVxuICAgICAgICAgICAgbGV0IGlzVHJpZ2dlcmFibGUgPSB0aGlzLmlzVHJpZ2dlcmVhYmxlTWFyayh0cmlnZ2VyZWRfZXZlbnQsIHRyaWdnZXJlZF9tYXJrcyk7XG4gICAgICAgICAgICBpZihpc1RyaWdnZXJhYmxlKSB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlcmVkX21hcmtzID0gdGhpcy5wdXRNYXJrc09uSG9sZCh0cmlnZ2VyZWRfbWFya3MsIHRyaWdnZXJlZF9ldmVudCk7XG4gICAgICAgICAgICAgICAgLy8gSWYgbWFyayBpcyBzdG9yYWJsZSAoaWYgbWFrZSBhbnkgc2Vuc2UgdG8gc3RvcmUgdG8gcmVuZGVyIHNvbWV0aGluZyBkaWZmZXJlbnQgbGlrZSBhIHZpZGVvKSBkbyBpdCwgZWxzZSBkb24ndFxuICAgICAgICAgICAgICAgIGlmKHRyaWdnZXJlZF9ldmVudC5zdGF0ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5pc05vdEluU3RhdGVFbGVtZW50KHRyaWdnZXJlZF9ldmVudCwgdGhpcy5zdGF0ZS5yaWNoRWxlbWVudFN0YXRlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5ld19tYXJrID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfbWFya1t0cmlnZ2VyZWRfZXZlbnQuaWRdID0gdHJpZ2dlcmVkX2V2ZW50LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkTWFya3M6IHRyaWdnZXJlZF9tYXJrcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWNoRWxlbWVudFN0YXRlOiBPYmplY3QuYXNzaWduKHt9LCByaWNoRWxlbWVudHNTdGF0ZSwgbmV3X21hcmspLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkX21hcmtzLmZvckVhY2goKG1hcmssIGluZGV4KT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFyay5pZCA9PT0gaXNUcmlnZ2VyYWJsZS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZF9tYXJrc1tpbmRleF0gPSBpc1RyaWdnZXJhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRyaWdnZXJlZE1hcmtzOiB0cmlnZ2VyZWRfbWFya3MgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYodHJpZ2dlcmVkX2V2ZW50LnN0YXRlRWxlbWVudCkge1xuICAgICAgICAgICAgbGV0IGJhY2t1cEVsZW1lbnRTdGF0ZXMgPSB0aGlzLnN0YXRlLmJhY2t1cEVsZW1lbnRTdGF0ZXM7XG4gICAgICAgICAgICBsZXQgbmV3X21hcmsgPSB7fTtcbiAgICAgICAgICAgIG5ld19tYXJrW3RyaWdnZXJlZF9ldmVudC5pZF0gPSB0cmlnZ2VyZWRfZXZlbnQudmFsdWU7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBiYWNrdXBFbGVtZW50U3RhdGVzOiBPYmplY3QuYXNzaWduKHt9LCBiYWNrdXBFbGVtZW50U3RhdGVzLCBuZXdfbWFyayksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGlmIGFueSBpcyB0aGVyZSBhbnkgdHJpZ2dlcmFibGUgbWFya1xuICAgICAqIEBwYXJhbSB0cmlnZ2VyZWRNYXJrc1xuICAgICAqIEByZXR1cm5zIE9iamVjdCBNYXJrcyB0aGF0IGFyZSB0cmlnZ2VyZWRcbiAgICAgKi9cbiAgICByZXR1cm5UcmlnZ2VyZWFibGVNYXJrKHRyaWdnZXJlZE1hcmtzKSB7XG4gICAgICAgIGxldCBpc0FueVRyaWdnZXJlYWJsZU1hcmsgPSBmYWxzZTtcbiAgICAgICAgbGV0IGNhbkJlVHJpZ2dlcmVkID0gdHJ1ZTtcbiAgICAgICAgaWYoQXJyYXkuaXNBcnJheSh0cmlnZ2VyZWRNYXJrcykpIHtcbiAgICAgICAgICAgIHRyaWdnZXJlZE1hcmtzLmZvckVhY2gobWFyaz0+e1xuICAgICAgICAgICAgICAgIGlmIChtYXJrLmN1cnJlbnRTdGF0ZSA9PT0gJ1RSSUdHRVJFRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FuQmVUcmlnZ2VyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoY2FuQmVUcmlnZ2VyZWQgJiYgbWFyay5jdXJyZW50U3RhdGUgPT09ICdQRU5ESU5HJyAmJiAhaXNBbnlUcmlnZ2VyZWFibGVNYXJrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzQW55VHJpZ2dlcmVhYmxlTWFyayA9IG1hcms7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzQW55VHJpZ2dlcmVhYmxlTWFyaztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIGlmIHRoZSBtYXJrIGlzIHRyaWdnZXJlYWJsZSBvciBub3RcbiAgICAgKiBAcGFyYW0gbWFya1xuICAgICAqIEBwYXJhbSB0cmlnZ2VyYWJsZV9tYXJrc1xuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIGlzVHJpZ2dlcmVhYmxlTWFyayhtYXJrLCB0cmlnZ2VyYWJsZV9tYXJrcykge1xuICAgICAgICBsZXQgaXNBbnlUcmlnZ2VyZWFibGVNYXJrID0gZmFsc2U7XG4gICAgICAgIHRyaWdnZXJhYmxlX21hcmtzLmZvckVhY2godHJpZ2dlcmVhYmxlX21hcms9PiB7XG4gICAgICAgICAgICBpZiAodHJpZ2dlcmVhYmxlX21hcmsuY3VycmVudFN0YXRlID09PSAnUEVORElORycgJiYgdHJpZ2dlcmVhYmxlX21hcmsudmFsdWUgPT09IG1hcmsudmFsdWUgJiYgdHJpZ2dlcmVhYmxlX21hcmsub3JpZ2luID09PSBtYXJrLmlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0FueVRyaWdnZXJlYWJsZU1hcmspIHtcbiAgICAgICAgICAgICAgICAgICAgaXNBbnlUcmlnZ2VyZWFibGVNYXJrID0gdHJpZ2dlcmVhYmxlX21hcms7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIW1hcmsuc3RhdGVFbGVtZW50ICYmIHRyaWdnZXJlYWJsZV9tYXJrLnZhbHVlID09PSBtYXJrLnZhbHVlICYmIHRyaWdnZXJlYWJsZV9tYXJrLm9yaWdpbiA9PT0gbWFyay5pZCkge1xuICAgICAgICAgICAgICAgIGlmICghaXNBbnlUcmlnZ2VyZWFibGVNYXJrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzQW55VHJpZ2dlcmVhYmxlTWFyayA9IHRyaWdnZXJlYWJsZV9tYXJrO1xuICAgICAgICAgICAgICAgICAgICBpc0FueVRyaWdnZXJlYWJsZU1hcmsuY3VycmVudFN0YXRlID0gXCJQRU5ESU5HXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlzQW55VHJpZ2dlcmVhYmxlTWFyaztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2Ugc3RhdGUgb2YgbGFzdCBtYXJrIHRyaWdnZXJlZCB0byBkb25lLCB0aGlzIGlzIHVzZWQgdG8gZ28gYmFja1xuICAgICAqIEBwYXJhbSBzdGF0ZVxuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKi9cbiAgICB1blRyaWdnZXJMYXN0TWFyayhzdGF0ZSkge1xuICAgICAgICBsZXQgbmV3X2FycmF5ID0gc3RhdGU7XG4gICAgICAgIG5ld19hcnJheS5mb3JFYWNoKG1hcms9PntcbiAgICAgICAgICAgIGlmKG1hcmsuY3VycmVudFN0YXRlID09PSAnVFJJR0dFUkVEJykge1xuICAgICAgICAgICAgICAgIG1hcmsuY3VycmVudFN0YXRlID0gJ0RPTkUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5ld19hcnJheTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbnMgVmlld3MgQXJyYXlcbiAgICAgKiBAcGFyYW0gdHJpZ2dlcmVkTWFya3NcbiAgICAgKiBAcGFyYW0gYXJyYXlWaWV3c1xuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIHNhbnRpbml6ZVZpZXdzQXJyYXkodHJpZ2dlcmVkTWFya3MsIGFycmF5Vmlld3MpIHtcbiAgICAgICAgbGV0IGZpbmFsX2FycmF5ID0gYXJyYXlWaWV3cztcblxuICAgICAgICB0cmlnZ2VyZWRNYXJrcy5mb3JFYWNoKG1hcms9PntcbiAgICAgICAgICAgIGlmKG1hcmsuY3VycmVudFN0YXRlID09PSBcIkRPTkVcIiAmJiBmaW5hbF9hcnJheS5pbmRleE9mKG1hcmsuY29ubmVjdGlvbikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgZmluYWxfYXJyYXkuc3BsaWNlKGZpbmFsX2FycmF5LmluZGV4T2YobWFyay5jb25uZWN0aW9uKSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZpbmFsX2FycmF5ID0gZmluYWxfYXJyYXkucmV2ZXJzZSgpLmZpbHRlcigodiwgaSwgYSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGEuaW5kZXhPZih2KSA9PT0gaSB8fCB2LmluZGV4T2YoXCJwYS1cIikgPT09IC0xO1xuICAgICAgICB9KS5yZXZlcnNlKCk7XG5cbiAgICAgICAgcmV0dXJuIGZpbmFsX2FycmF5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFucyB1c2VkICdET05FJyB2YWx1ZXMgaW4gdHJpZ2dlcmVkTWFya3MgYXJyYXlcbiAgICAgKiBAcGFyYW0gdHJpZ2dlcmVkX2V2ZW50XG4gICAgICogQHBhcmFtIHRyaWdnZXJlZE1hcmtzXG4gICAgICogQHJldHVybnMge0FycmF5fVxuICAgICAqL1xuICAgIGNsZWFyVHJpZ2dlcmVkVmFsdWVzKHRyaWdnZXJlZF9ldmVudCwgdHJpZ2dlcmVkTWFya3MpIHtcbiAgICAgICAgbGV0IGNsZWFuX2FycmF5ID0gW107XG5cbiAgICAgICAgaWYodHJpZ2dlcmVkTWFya3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYoIXRyaWdnZXJlZF9ldmVudC5zdGF0ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyZWRNYXJrcy5mb3JFYWNoKGVsZW1lbnQ9PntcbiAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudC5jdXJyZW50U3RhdGUgIT09ICdET05FJyB8fCB0cmlnZ2VyZWRfZXZlbnQuaWQgIT09IGVsZW1lbnQub3JpZ2luKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhbl9hcnJheS5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlcmVkTWFya3MuZm9yRWFjaChlbGVtZW50ID0+e1xuICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LmN1cnJlbnRTdGF0ZSAhPT0gXCJET05FXCIgfHwgZWxlbWVudC52YWx1ZSA9PT0gdHJpZ2dlcmVkX2V2ZW50LnZhbHVlIHx8IGVsZW1lbnQub3JpZ2luICE9PSB0cmlnZ2VyZWRfZXZlbnQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuX2FycmF5LnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2xlYW5fYXJyYXk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvdmlzaW9uYWwgTWV0aG9kIFRPRE86IFZlcmlmeSBpZiBuZWVkZWRcbiAgICAgKiBAcGFyYW0gdHJpZ2dlcmVkX2V2ZW50XG4gICAgICogQHBhcmFtIHJpY2hTdGF0ZXNlbGVtZW50XG4gICAgICovXG4gICAgLy8gY2xlYXJTdGF0ZUVsZW1lbnRzKHRyaWdnZXJlZF9ldmVudCwgcmljaFN0YXRlc2VsZW1lbnQpIHtcbiAgICAvLyAgICAgaWYocmljaFN0YXRlc2VsZW1lbnRbdHJpZ2dlcmVkX2V2ZW50LmlkXSAhPT0gdW5kZWZpbmVkICYmIHBhcnNlRmxvYXQodHJpZ2dlcmVkX2V2ZW50LnZhbHVlKSA+IHBhcnNlRmxvYXQocmljaFN0YXRlc2VsZW1lbnRbdHJpZ2dlcmVkX2V2ZW50LmlkXSkgKyAxKSB7XG4gICAgLy8gICAgICAgICBsZXQgbmV3RWxlbWVudFN0YXRlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyaWNoU3RhdGVzZWxlbWVudCkpO1xuICAgIC8vICAgICAgICAgbmV3RWxlbWVudFN0YXRlW3RyaWdnZXJlZF9ldmVudC5pZF0gPSB1bmRlZmluZWQ7XG4gICAgLy8gICAgICAgICByZXR1cm4gbmV3RWxlbWVudFN0YXRlO1xuICAgIC8vICAgICB9XG4gICAgLy9cbiAgICAvLyAgICAgcmV0dXJuIHJpY2hTdGF0ZXNlbGVtZW50O1xuICAgIC8vIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgbWFya3MgdHJpZ2dlcmVkIGluIHRoZSBzYW1lIGV2ZW50XG4gICAgICogQHBhcmFtIG1hcmtzXG4gICAgICogQHBhcmFtIHRyaWdnZXJlZF9ldmVudFxuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKi9cbiAgICBnZXRUcmlnZ2VyZWRNYXJrcyhtYXJrcywgdHJpZ2dlcmVkX2V2ZW50KSB7XG4gICAgICAgIGxldCBzdGF0ZV9tYXJrcyA9IFtdO1xuICAgICAgICBsZXQgcHJldmlvdXNseV90cmlnZ2VyZWRfbWFya3MgPSB0aGlzLnN0YXRlLnRyaWdnZXJlZE1hcmtzO1xuICAgICAgICBpZihwcmV2aW91c2x5X3RyaWdnZXJlZF9tYXJrcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIG1hcmtzLmZvckVhY2gobWFya19lbGVtZW50PT57XG4gICAgICAgICAgICAgICAgaWYobWFya19lbGVtZW50LnZhbHVlID09PSB0cmlnZ2VyZWRfZXZlbnQudmFsdWUgJiYgbWFya19lbGVtZW50Lm9yaWdpbiA9PT0gdHJpZ2dlcmVkX2V2ZW50LmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlX21hcmtzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlOiBcIlBFTkRJTkdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdPcmlnaW46IHRoaXMuc3RhdGUuY3VycmVudFZpZXdbdGhpcy5zdGF0ZS5jdXJyZW50Vmlldy5sZW5ndGggLSAxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBtYXJrX2VsZW1lbnQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbWFya19lbGVtZW50LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbjogbWFya19lbGVtZW50LmNvbm5lY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IG1hcmtfZWxlbWVudC5vcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0TW9kZTogbWFya19lbGVtZW50LmNvbm5lY3RNb2RlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAvLyByZXR1cm4gb25seSB0cmlnZ2VyZWQgTUFSS1NcbiAgICAgICAgICAgIHN0YXRlX21hcmtzID0gc3RhdGVfbWFya3MuY29uY2F0KHByZXZpb3VzbHlfdHJpZ2dlcmVkX21hcmtzKTtcblxuICAgICAgICAgICAgbWFya3MuZm9yRWFjaCh0cmlnZ2VyZWRfbWFyaz0+e1xuICAgICAgICAgICAgICAgIGxldCBpc19kaWZmZXJlbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZvcihsZXQgbiBpbiBzdGF0ZV9tYXJrcykge1xuICAgICAgICAgICAgICAgICAgICBpZihzdGF0ZV9tYXJrc1tuXS52YWx1ZSA9PT0gdHJpZ2dlcmVkX21hcmsudmFsdWUgJiYgc3RhdGVfbWFya3Nbbl0ub3JpZ2luID09PSB0cmlnZ2VyZWRfZXZlbnQuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2RpZmZlcmVudCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoaXNfZGlmZmVyZW50ICYmIHRyaWdnZXJlZF9ldmVudC52YWx1ZSA9PT0gdHJpZ2dlcmVkX21hcmsudmFsdWUgJiYgdHJpZ2dlcmVkX2V2ZW50LmlkID09PSB0cmlnZ2VyZWRfbWFyay5vcmlnaW4pIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVfbWFya3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGU6IFwiUEVORElOR1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld09yaWdpbjogdGhpcy5zdGF0ZS5jdXJyZW50Vmlld1t0aGlzLnN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCAtIDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRyaWdnZXJlZF9tYXJrLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRyaWdnZXJlZF9tYXJrLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbjogdHJpZ2dlcmVkX21hcmsuY29ubmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbjogdHJpZ2dlcmVkX21hcmsub3JpZ2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdE1vZGU6IHRyaWdnZXJlZF9tYXJrLmNvbm5lY3RNb2RlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN0YXRlX21hcmtzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgTWFyayBvZiBjdXJyZW50Vmlld1xuICAgICAqIEByZXR1cm5zIHtBcnJheX1cbiAgICAgKi9cbiAgICBnZXRBbGxNYXJrcygpIHtcbiAgICAgICAgbGV0IGN1cnJlbnRWaWV3ID0gdGhpcy5zdGF0ZS5jdXJyZW50Vmlld1t0aGlzLnN0YXRlLmN1cnJlbnRWaWV3Lmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGxldCBib3hlcyA9IHRoaXMuZ2V0QWxsUmljaERlc2NlbmRhbnRCb3hlcyhjdXJyZW50Vmlldyk7XG4gICAgICAgIGxldCBtYXJrcyA9IFtdO1xuICAgICAgICBPYmplY3Qua2V5cyhFZGlwaHkuU3RhdGUubWFya3NCeUlkKS5mb3JFYWNoKG1hcms9PntcbiAgICAgICAgICAgIGJveGVzLmluY2x1ZGVzKEVkaXBoeS5TdGF0ZS5tYXJrc0J5SWRbbWFya10ub3JpZ2luKTtcbiAgICAgICAgICAgIG1hcmtzLnB1c2goRWRpcGh5LlN0YXRlLm1hcmtzQnlJZFttYXJrXSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbWFya3M7XG4gICAgfVxuXG4gICAgcHV0TWFya3NPbkhvbGQodHJpZ2dlcmVkX21hcmtzKSB7XG4gICAgICAgIGxldCBhbnlUcmlnZ2VyZWRNYXJrcyA9IGZhbHNlO1xuICAgICAgICBsZXQgYW55UGVuZGluZ01hcmtzID0gZmFsc2U7XG5cbiAgICAgICAgdHJpZ2dlcmVkX21hcmtzLmZvckVhY2godF9tYXJrPT57XG4gICAgICAgICAgICBpZih0X21hcmsuY3VycmVudFN0YXRlID09PSBcIlBFTkRJTkdcIikge1xuICAgICAgICAgICAgICAgIGFueVBlbmRpbmdNYXJrcyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih0X21hcmsuY3VycmVudFN0YXRlID09PSBcIlRSSUdHRVJFRFwiKSB7XG4gICAgICAgICAgICAgICAgYW55VHJpZ2dlcmVkTWFya3MgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgb3JpZ2luX21hcmtzID0gW107XG4gICAgICAgIGxldCBtYXJrVW50cmlnZ2VyZWQgPSBmYWxzZTtcbiAgICAgICAgaWYoYW55VHJpZ2dlcmVkTWFya3MgJiYgYW55UGVuZGluZ01hcmtzKSB7XG4gICAgICAgICAgICB0cmlnZ2VyZWRfbWFya3MuZm9yRWFjaCh0X21hcmsgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0X21hcmsudmlld09yaWdpbiAhPT0gdW5kZWZpbmVkICYmIHRfbWFyay5jdXJyZW50U3RhdGUgPT09ICdIT0xEJykge1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW5fbWFya3MucHVzaCh0X21hcmsudmlld09yaWdpbik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRfbWFyay5jdXJyZW50U3RhdGUgPT09ICdUUklHR0VSRUQnICYmIHRfbWFyay52aWV3T3JpZ2luICE9PSB1bmRlZmluZWQgJiYgb3JpZ2luX21hcmtzLmluZGV4T2YodF9tYXJrLnZpZXdPcmlnaW4pID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW5fbWFya3MucHVzaCh0X21hcmsudmlld09yaWdpbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRyaWdnZXJlZF9tYXJrcy5mb3JFYWNoKHRfbWFyaz0+e1xuICAgICAgICAgICAgICAgIGlmICh0X21hcmsuY3VycmVudFN0YXRlID09PSAnUEVORElORycgJiYgdF9tYXJrLnZpZXdPcmlnaW4gIT09IHVuZGVmaW5lZCAmJiBvcmlnaW5fbWFya3MuaW5kZXhPZih0X21hcmsudmlld09yaWdpbikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtVbnRyaWdnZXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmKG1hcmtVbnRyaWdnZXJlZCkge1xuICAgICAgICAgICAgICAgIGxldCBuZXdNYXJrc0FycmF5ID0gW107XG4gICAgICAgICAgICAgICAgdHJpZ2dlcmVkX21hcmtzLmZvckVhY2godF9tYXJrPT57XG4gICAgICAgICAgICAgICAgICAgIGlmKHRfbWFyay5jdXJyZW50U3RhdGUgPT09ICdUUklHR0VSRUQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0X21hcmsuY3VycmVudFN0YXRlID0gJ0hPTEQnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG5ld01hcmtzQXJyYXkucHVzaCh0X21hcmspO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXdNYXJrc0FycmF5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRyaWdnZXJlZF9tYXJrcztcblxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRyaWdnZXJlZF9tYXJrcztcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBuYXZJdGVtSURcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAgICovXG4gICAgZ2V0QWxsUmljaERlc2NlbmRhbnRCb3hlcyhuYXZJdGVtSUQpIHtcbiAgICAgICAgbGV0IHZpZXcgPSBFZGlwaHkuU3RhdGUubmF2SXRlbXNCeUlkW25hdkl0ZW1JRF07XG4gICAgICAgIGlmIChpc0NvbnRhaW5lZFZpZXcobmF2SXRlbUlEKSkge1xuICAgICAgICAgICAgdmlldyA9IEVkaXBoeS5TdGF0ZS5jb250YWluZWRWaWV3c0J5SWRbbmF2SXRlbUlEXTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgYm94ZXMgPSB2aWV3LmJveGVzO1xuICAgICAgICBsZXQgbmV3Qm94ZXMgPSBbXTtcblxuICAgICAgICBsZXQgcmljaEJveGVzID0gW107XG4gICAgICAgIE9iamVjdC5rZXlzKEVkaXBoeS5TdGF0ZS5ib3hlc0J5SWQpLm1hcChib3g9PntcblxuICAgICAgICAgICAgaWYoYm94ZXMuaW5kZXhPZihib3gpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIG5ld0JveGVzLnB1c2goYm94KTtcblxuICAgICAgICAgICAgICAgIGlmKE9iamVjdC5rZXlzKEVkaXBoeS5TdGF0ZS5ib3hlc0J5SWRbYm94XS5jaGlsZHJlbikubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKEVkaXBoeS5TdGF0ZS5ib3hlc0J5SWRbYm94XS5zb3J0YWJsZUNvbnRhaW5lcnMpLm1hcChzZWNvbmRfYm94PT57XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdCb3hlcyA9IG5ld0JveGVzLmNvbmNhdChFZGlwaHkuU3RhdGUuYm94ZXNCeUlkW2JveF0uc29ydGFibGVDb250YWluZXJzW3NlY29uZF9ib3hdLmNoaWxkcmVuKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBuZXdCb3hlcy5mb3JFYWNoKGZpbmFsPT57XG4gICAgICAgICAgICBpZiAoRWRpcGh5LlN0YXRlLnBsdWdpblRvb2xiYXJzQnlJZFtmaW5hbF1cbiAgICAgICAgICAgICAgICAmJiBFZGlwaHkuU3RhdGUucGx1Z2luVG9vbGJhcnNCeUlkW2ZpbmFsXS5wbHVnaW5JZFxuICAgICAgICAgICAgICAgICYmIEVkaXBoeS5TdGF0ZS5wbHVnaW5Ub29sYmFyc0J5SWRbZmluYWxdLnBsdWdpbklkICE9PSBcInNvcnRhYmxlX2NvbnRhaW5lclwiXG4gICAgICAgICAgICAgICAgJiYgRWRpcGh5LlZpc29yLlBsdWdpbnNbRWRpcGh5LlN0YXRlLnBsdWdpblRvb2xiYXJzQnlJZFtmaW5hbF0ucGx1Z2luSWRdLmdldENvbmZpZygpLmlzUmljaCkge1xuICAgICAgICAgICAgICAgIHJpY2hCb3hlcy5wdXNoKGZpbmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByaWNoQm94ZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IHN0YXRlIGZvciBzZWxlY3RlZCBib3hcbiAgICAgKiBAcGFyYW0gYmFja3VwXG4gICAgICogQHBhcmFtIGN1cnJlbnRcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBnZXRBY3R1YWxCb3hlc1N0YXRlcyhiYWNrdXAsIGN1cnJlbnQpIHtcbiAgICAgICAgbGV0IG5leHRTdGF0ZSA9IGJhY2t1cDtcbiAgICAgICAgbmV4dFN0YXRlW3RoaXMuc3RhdGUudHJpZ2dlcmVkTWFya3NbMF0ub3JpZ2luXSA9IGN1cnJlbnRbdGhpcy5zdGF0ZS50cmlnZ2VyZWRNYXJrc1swXS5vcmlnaW5dO1xuICAgICAgICByZXR1cm4gbmV4dFN0YXRlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdHMgaWYgZWxlbWVudCBpcyBub3QgYWxyZWFkeSBpbiBzdGF0ZSBFbGVtZW50IHNvIGl0cyBhbHJlYWR5IHRyaWdnZXJlZFxuICAgICAqIEBwYXJhbSB0cmlnZ2VyZWRfZXZlbnRcbiAgICAgKiBAcGFyYW0gcmljaEVsZW1lbnRzU3RhdGVcbiAgICAgKlxuICAgICAqL1xuICAgIGlzTm90SW5TdGF0ZUVsZW1lbnQodHJpZ2dlcmVkX2V2ZW50LCByaWNoRWxlbWVudHNTdGF0ZSkge1xuICAgICAgICBpZihyaWNoRWxlbWVudHNTdGF0ZVt0cmlnZ2VyZWRfZXZlbnQuaWRdID09PSB0cmlnZ2VyZWRfZXZlbnQudmFsdWUpIHtcbiAgICAgICAgICAgIC8vIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGxhc3QgdmlldyBmcm9tIHF1ZXVlIG9mIHZpZXdzXG4gICAgICovXG4gICAgcmVtb3ZlTGFzdFZpZXcgPSAoKSA9PiB7XG4gICAgICAgIGxldCBuZXdWaWV3cyA9IHRoaXMuc3RhdGUuY3VycmVudFZpZXcuc2xpY2UoMCwgLTEpO1xuICAgICAgICBpZiAobmV3Vmlld3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGV0IGxhc3RWaWV3ID0gbmV3Vmlld3NbbmV3Vmlld3MubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBpZiAobGFzdFZpZXcuaW5kZXhPZihcImN2LVwiKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgY29udGFpbmVkVmlld1NlbGVjdGVkOiAwIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgY3VycmVudFZpZXc6IG5ld1ZpZXdzLFxuICAgICAgICAgICAgdHJpZ2dlcmVkTWFya3M6IHRoaXMudW5UcmlnZ2VyTGFzdE1hcmsodGhpcy5zdGF0ZS50cmlnZ2VyZWRNYXJrcyksXG4gICAgICAgICAgICByaWNoRWxlbWVudFN0YXRlOiB0aGlzLmdldEFjdHVhbEJveGVzU3RhdGVzKHRoaXMuc3RhdGUuYmFja3VwRWxlbWVudFN0YXRlcywgdGhpcy5zdGF0ZS5yaWNoRWxlbWVudFN0YXRlKSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG59XG5cblJlYWN0RE9NLnJlbmRlcigoPFZpc29yIC8+KSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb3QnKSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9fdmlzb3IvY29udGFpbmVycy9WaXNvckFwcC5qc3giXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUdBOzs7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBRkE7QUErREE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQWpFQTtBQW1FQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBckVBO0FBdUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFuRkE7QUFpWkE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUExYkE7QUFtdkJBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBN3ZCQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQUNBO0FBYUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFYQTtBQWFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQTNEQTtBQTREQTtBQUNBOzs7QUF1QkE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0QkE7QUF5QkE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQVlBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFGQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFEQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQWRBO0FBbUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQVJBO0FBU0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBTkE7QUFPQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBUkE7QUFlQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBREE7QUFFQTtBQUNBO0FBRUE7QUFFQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQTZDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBOzs7Ozs7O0FBaHZCQTtBQUNBO0FBREE7QUFvd0JBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2674\n");

/***/ })

})